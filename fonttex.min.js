"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(i="Object"===i&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,t=function(){};return{s:t,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,n=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,s=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw s}}}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}window.fontTeX=function(){var x="data-fonttex";function Fe(){var e=window.crypto||window.msCrypto,e=e&&e.getRandomValues?e.getRandomValues(new Uint8Array(16)):new Uint8Array(16).map(function(){return Math.floor(256*Math.random())});return Array.from(e).map(function(e){return(256+e).toString(16).substring(1)}).join("")}function k(e){return'"'==e[0]&&'"'==e[e.length-1]||"'"==e[0]&&"'"==e[e.length-1]?e.substring(1,e.length-1):e}var we={ESCAPE:0,OPEN:1,CLOSE:2,MATHSHIFT:3,ALIGN:4,ENDOFLINE:5,PARAMETER:6,SUPERSCRIPT:7,SUBSCRIPT:8,IGNORE:9,WHITESPACE:10,LETTER:11,OTHER:12,ACTIVE:13,COMMENT:14,INVALID:15},ze={ORD:0,OP:1,BIN:2,REL:3,OPEN:4,CLOSE:5,PUNCT:6,VARIABLE:7,ACTIVE:8,INNER:"inner",OVER:"over",UNDER:"under",VCENT:"vcent",RAD:"rad",ACC:"acc"},We=Math.SQRT2,Ue=Math.SQRT1_2,_e="".concat(Ue,"em"),S={version:"0.5.1",config:function(e,t){var i=Object.keys(je);if("string"==typeof e)return e=e.toLowerCase(),i.includes(e)?(1<arguments.length&&("number"!=typeof(t=je[e][1](t))||isFinite(t)||(t=0),je[e][0]=t),je[e][0]):null;for(var a={},s=i.length-1;0<=s;s--){var r,n=i[s];e&&n in e&&("number"!=typeof(r=je[n][1](e[n]))||isFinite(r)||(r=0),je[n][0]=r),a[n]=je[n][0]}return a}},je={autoupdate:[!1,Boolean],parsehtml:[!0,Boolean],"invalid.color":["red",String],"radical.build":[!0,Boolean],"radical.w":[.5,Number],"radical.t":[.15,Number],"radical.h":[1.25,Number],"radical.verticalthreshold":[2.75,Number],"operator.growamount":[1.75,Number],"operator.growchars":["⅀∏∐∑∫∮⋀⋁⋂⋃⨀⨁⨂⨃⨄⨅⨆⨉⫿",String]};function E(e){return"string"==typeof e?E(document.querySelectorAll(e)):e instanceof Element?[e]:e instanceof NodeList||e instanceof HTMLCollection?E(Array.prototype.slice.call(e)):Array.isArray(e)?e.filter(function(e){return e instanceof Element}):[]}function n(e){if("string"==typeof e)return n(document.querySelectorAll(e));if(e instanceof HTMLCollection||e instanceof NodeList)return n(Array.prototype.slice.call(e));if(e instanceof Element)return n([e]);if(e instanceof S.ParsedFontTeX)return[e];if(Array.isArray(e)){for(var t,i=[],a=C.map(function(e){return e.elem}),s=0,r=e.length;s<r;s++)e[s]instanceof S.ParsedFontTeX?i.push(e[s]):e[s]instanceof Element&&(~(t=a.indexOf(e[s]))&&i.push(C[t].parsedTeXInstance));return i}return C.map(function(e){return e.parsedTeXInstance})}var C=[];S.rerender=function(e){for(var t=n(e),i=(t=C.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=i;i--)t[i].parsedTeXInstance.renderIn(t[i].elem)},S.updateStyles=function(e){for(var t=n(e),i=0,a=(t=C.filter(function(e){return t.includes(e.parsedTeXInstance)})).length-1;0<=a;a--)t[a].oldFontFamily==t[a].styles.fontFamily&&t[a].oldFontSize==t[a].styles.fontSize&&t[a].oldColor==t[a].styles.color||(t[a].oldFontFamily=t[a].styles.fontFamily,t[a].oldFontSize=t[a].styles.fontSize,t[a].oldColor=t[a].styles.color,t[a].parsedTeXInstance.renderIn(t[a].elem),i++);return i},new MutationObserver(function(){je.autoupdate[0]&&S.updateStyles()}).observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]});var h=console.log.bind(console);function e(){var e,t=_createForOfIteratorHelper(document.getElementsByTagName("font-tex"));try{for(t.s();!(e=t.n()).done;){var i=e.value;"true"!=i.getAttribute("".concat(x,"-is-parsed"))&&(S.render(i),i.setAttribute("".concat(x,"-is-parsed"),"true"))}}catch(e){t.e(e)}finally{t.f()}}function t(){new MutationObserver(e).observe(document.body,{childList:!0,subtree:!0}),e()}function y(e,G,t){var s=[],r=e,ae=[],X={global:!(ae.last=function(){return ae[ae.length-1]})},$=[];Object.defineProperty($,"last",{get:function(){return this[this.length-1]}});function se(i,a){function ie(t,e){if(e=e||this,!t||"command"!=t.type&&("character"!=t.type||t.cat!=we.ACTIVE))return[t];if(t.invalid){var i=(i=("command"==t.type?t.escapeChar+t.name:t.char).split("")).map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.codePointAt(0),invalid:!0,recognized:t.recognized}});return[{type:"character",cat:we.OPEN,char:"{",code:"{".codePointAt(0),invalid:!0}].concat(i).concat({type:"character",cat:we.CLOSE,char:"}",code:"}".codePointAt(0),invalid:!0})}if(t.ignore)return[{type:"ignored command",token:t}];i=ae[ae.length-1];if("command"==t.type){if(t.name in i.defs.macros){var a=i.defs.macros[t.name];if("primitive"==(a=a.proxy?a.original:a).type){var s=a.function.call(t,{mouth:e,tokens:i.tokens,toggles:X,catOf:re,mathCodeOf:K,scopes:ae,lastScope:ae[ae.length-1],openGroups:Q,contexts:$,lastContext:$[$.length-1]||{},Scope:Y,style:G});return t.recognized=!0,Array.isArray(s)?s:[]}t.recognized=!0;var r=Symbol();e.saveState(r);for(var n=[],l=0,o=a.parameters.length;l<o;l++){var c=a.parameters[l];if(c.cat==we.PARAMETER)if(a.parameters[l+1]&&a.parameters[l+1].cat!=we.PARAMETER){var h=a.parameters.map(function(e){return e.cat==we.PARAMETER}).indexOf(!0,l+1),d=a.parameters.slice(l+1,~h?h:1/0);n.push([]);for(var p=0;;){var m=e.eat("argument");if(!m)return t.invalid=!0,e.loadState(r),[t];if(1==m.length){var u=m,f=Symbol(),v=!1;e.saveState(f);for(var g=0;g<d.length&&(u&&(1==u.length||d[g].cat==we.OPEN&&g==d.length-1)&&u[0].type==d[g].type&&u[0].cat==d[g].cat&&u[0].code==d[g].code&&u[0].name==d[g].name);g++){if(g==d.length-1){v=!0;break}u=e.eat("argument")}if(e.loadState(f),v){e.revert();break}}n[n.length-1]=n[n.length-1].concat(m),p++}1==p&&n[n.length-1][0].cat==we.OPEN&&n[n.length-1][n[n.length-1].length-1].cat==we.CLOSE&&(n[n.length-1].shift(),n[n.length-1].pop())}else{var y=e.eat("argument");if(!y)return t.invalid=!0,e.loadState(r),[t];2<y.length&&(y.shift(),y.pop()),n.push(y)}else{y=e.eat();if(!c||!y||c.type!=y.type||c.cat!=y.cat||c.code!=y.code||c.name!=y.name)return t.invalid=!0,e.loadState(r),[t]}}for(var b,w=[],x=0,k=a.replacement.length;x<k;x++)if(a.replacement[x].cat==we.PARAMETER)a.replacement[x+1].cat==we.PARAMETER?(w.push(a.replacement[x+1]),x++):(b=a.replacement[x+1].char-1)>n.length?w=w.concat({type:"character",cat:we.OTHER,char:a.replacement[x].char,code:macros.replacement[x].code,invalid:!0}):(w=w.concat(n[b]),x++);else{var S,E={};for(S in a.replacement[x])E[S]=a.replacement[x][S];w.push(E)}return w}if(t.name in i.defs.primitive){s=i.defs.primitive[t.name].function.call(t,{mouth:e,tokens:i.tokens,toggles:X,catOf:re,scopes:ae,lastScope:ae[ae.length-1],openGroups:Q,contexts:$,lastContext:$[$.length-1]||{},Scope:Y,style:G});return t.recognized=!0,Array.isArray(s)?s:[]}return t.name in i.registers.named?[i.registers.named[t.name]]:(t.invalid=!0,[t])}if("character"==t.type){if(t.char in i.defs.active){var C=i.defs.active[t.char];if("primitive"==(C=C.proxy?C.original:C).type){i=C.function.call(t,{mouth:e,tokens:i.tokens,toggles:X,catOf:re,scopes:ae,lastScope:ae[ae.length-1],openGroups:Q,contexts:$,lastContext:$[$.length-1]||{},Scope:Y,style:G});return t.recognized=!0,Array.isArray(i)?i:[]}t.recognized=!0;var A=Symbol();e.saveState(A);for(var T=[],O=0,I=C.parameters.length;O<I;O++){var L=C.parameters[O];if(L.cat==we.PARAMETER)if(C.parameters[O+1]&&C.parameters[O+1].cat!=we.PARAMETER){var D=C.parameters.map(function(e){return e.cat==we.PARAMETER}).indexOf(!0,O+1),R=C.parameters.slice(O+1,~D?D:1/0);T.push([]);for(var H=0;;){var M=e.eat("argument");if(!M)return t.invalid=!0,e.loadState(A),[t];if(1==M.length){var P=M,q=Symbol(),N=!1;e.saveState(q);for(var V=0;V<R.length&&(P&&(1==P.length||R[V].cat==we.OPEN&&V==R.length-1)&&P[0].type==R[V].type&&P[0].cat==R[V].cat&&P[0].code==R[V].code&&P[0].name==R[V].name);V++){if(V==R.length-1){N=!0;break}P=e.eat("argument")}if(e.loadState(q),N){e.revert();break}}T[T.length-1]=T[T.length-1].concat(M),H++}1==H&&T[T.length-1][0].cat==we.OPEN&&T[T.length-1][T[T.length-1].length-1].cat==we.CLOSE&&(T[T.length-1].shift(),T[T.length-1].pop())}else{var B=e.eat("argument");if(!B)return t.invalid=!0,e.loadState(A),[t];2<B.length&&(B.shift(),B.pop()),T.push(B)}else{B=e.eat();if(!L||!B||L.type!=B.type||L.cat!=B.cat||L.code!=B.code||L.name!=B.name)return t.invalid=!0,e.loadState(A),[t]}}for(var F,z=[],W=0,U=C.replacement.length;W<U;W++)if(C.replacement[W].cat==we.PARAMETER)C.replacement[W+1].cat==we.PARAMETER?(z.push(C.replacement[W+1]),W++):(F=C.replacement[W+1].char-1)>T.length?z=z.concat({type:"character",cat:we.OTHER,char:C.replacement[W].char,code:macros.replacement[W].code,invalid:!0}):(z=z.concat(T[F]),W++);else{var _,j={};for(_ in C.replacement[W])j[_]=C.replacement[W][_];z.push(j)}return z}return t.invalid=!0,[t]}}_classCallCheck(this,se),this.queue=(a||s).slice(),this.string="string"==typeof i?i:r,this.history=[],this.savedStates={},this.eat=function(e){var t,i,a,s,r,n,l,o,c,h,d,p,m,u,f,v,g,y,b,w,x;switch(e){case void 0:case"pre space":default:if(this.queue.length)return this.queue[0].cat==we.WHITESPACE&&"pre space"!=e?(this.queue.shift(),this.eat(e)):(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.queue.shift());if(0==this.string.length)return null;if(re(this.string[0])==we.ESCAPE){if(!this.string[1]||"\n"==this.string[1])return this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),this.string=this.string.substring(2),{type:"command",escapeChar:this.string[0],name:"",nameType:"command"};if(this.string[1]==this.string[2]&&re(this.string[1])==we.SUPERSCRIPT&&this.string[4]&&"0123456789abcdef".includes(this.string[3])&&"0123456789abcdef".includes(this.string[4])?this.string=this.string[0]+String.fromCodePoint(parseInt(this.string.substring(3,5),16))+this.string.substring(5):this.string[1]==this.string[2]&&re(this.string[1])==we.SUPERSCRIPT&&this.string.codePointAt(3)<128&&(this.string=this.string[0]+String.fromCharCode((this.string.codePointAt(3)+64)%128)+this.string.substring(4)),re(this.string[1])==we.LETTER){for(var k="",S=1;;S++)if(re(this.string[S])==we.LETTER)k+=this.string[S];else if(this.string[S]==this.string[S+1]&&re(this.string[S])==we.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[S+2])&&"0123456789abcdef".includes(this.string[S+3]))this.string=this.string.substring(0,S)+String.fromCodePoint(parseInt(this.string.substring(S+2,S+4),16))+this.string.substring(S+4),S--;else{if(!(this.string[S]==this.string[S+1]&&re(this.string[S])==we.SUPERSCRIPT&&this.string.codePointAt(S+2)<128))break;this.string=this.string.substring(0,S)+String.fromCodePoint((this.string.codePointAt(S+2)+64)%128)+this.string.substring(S+3),S--}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var E={type:"command",escapeChar:this.string[0],name:k,nameType:"command"};return this.string=this.string.substring(1+k.length),E}this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});E={type:"command",escapeChar:this.string[0],name:this.string[1],nameType:"symbol"};return this.string=this.string.substring(2),E}if(this.string[0]==this.string[1]&&re(this.string[0])==we.SUPERSCRIPT&&"0123456789abcdef".includes(this.string[2])&&"0123456789abcdef".includes(this.string[3]))return this.string=String.fromCodePoint(parseInt(this.string.substring(2,4),16))+this.string.substring(4),this.eat(e);if(this.string[0]==this.string[1]&&re(this.string[0])==we.SUPERSCRIPT&&this.string.codePointAt(2)<128)return this.string=String.fromCodePoint((this.string.codePointAt(2)+64)%128)+this.string.substring(3),this.eat(e);if([we.OPEN,we.CLOSE,we.MATHSHIFT,we.ALIGN,we.PARAMETER,we.SUPERSCRIPT,we.SUBSCRIPT,we.LETTER,we.OTHER,we.ACTIVE].includes(re(this.string[0]))){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});E=this.string[0];return this.string=this.string.substring(1),{type:"character",char:E,code:E.codePointAt(0),cat:re(E)}}if(re(this.string[0])==we.ENDOFLINE){var C=this.string.indexOf("\n");for(this.string=this.string.substring(~C?C+1:this.string.length);re(this.string[0])==we.WHITESPACE;)this.string=this.string.substring(1);return"pre space"==e&&this.queue.unshift({type:"character",char:" ",code:" ".codePointAt(0),cat:we.WHITESPACE}),this.eat(e)}if(re(this.string[0])==we.COMMENT){C=this.string.indexOf("\n");return this.string=this.string.substring(~C?C+1:this.string.length),this.eat(e)}if(re(this.string[0])==we.WHITESPACE&&"pre space"!=e||re(this.string[0])==we.IGNORE)return this.string=this.string.substring(1),this.eat(e);if(re(this.string[0])==we.WHITESPACE&&"pre space"==e){this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});var A=this.string[0];return this.string=this.string.substring(1),{type:"character",char:A,code:A.codePointAt(0),cat:we.WHITESPACE}}if(re(this.string[0])!=we.INVALID)break;this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()});A=this.string[0];return this.string=this.string.substring(1),{type:"character",char:A,code:A.codePointAt(0),cat:we.OTHER,invalid:!0};case"argument":t=new se(this.string,this.queue),i=0,a=[];do{var T=t.eat()}while(T&&(T.cat==we.OPEN?i++:T.cat==we.CLOSE&&i--,a.push(T),0<i));return 0<i||0==a.length?null:(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,a);case"integer":for(t=new se(this.string,this.queue),r="start",n=0,l=!(s=1),W="pre space";;){var O=t.eat(W);if(!O)break;if("start"==r&&("command"==O.type||"character"==O.type&&O.cat==we.ACTIVE)){var I="command"==O.type?ae[ae.length-1].defs.primitive[O.name]||ae[ae.length-1].defs.macros[O.name]||ae[ae.length-1].registers.named[O.name]:ae[ae.length-1].defs.active[O.char];if(!(I=I&&I.proxy?I.original:I)||!I.register&&!Ae.includes(I)){if(I===Ce.defs.primitive.relax)break;t.revert();break}I=ie(O,t);if(1==I.length&&I[0]===O&&O.invalid){t.revert();break}t.queue.unshift.apply(t.queue,I)}else if("start"!=r||O.cat!=we.WHITESPACE)if("start"==r&&O.cat==we.OTHER&&"-"==O.char)s*=-1;else if("start"!=r||O.cat!=we.OTHER||"+"!=O.char){if("start"==r&&O.register){"integer"==O.type?(n=O.value,W="pre space"):"dimension"==O.type?n=O.sp.value+12*O.em.value:"mu dimension"==O.type?n=12*O.mu.value/18:"glue"==O.type?n=O.start.sp.value+12*O.start.em.value:"mu glue"==O.type&&(n=12*O.start.mu.value/18),l=!0;break}if("start"!=r){t.revert();break}W="unsigned int",t.revert()}}return l?(n*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new xe(n)):null;case"dimension":for(t=new se(this.string,this.queue),r="start",s=1,c=o=!(n=" "),d=h=d=h=0,m=!(W="pre space");!c;){var L=t.eat(W);if(!L)break;if("start"==r&&("command"==L.type||"character"==L.type&&L.cat==we.ACTIVE)){var D="command"==L.type?ae[ae.length-1].defs.primitive[L.name]||ae[ae.length-1].defs.macros[L.name]||ae[ae.length-1].registers.named[L.name]:ae[ae.length-1].defs.active[L.char];if(D&&D.proxy&&(D.original=D),!D||!D.register&&!Ae.includes(D)){if(D===Ce.defs.primitive.relax)break;t.revert();break}var R=ie(L,t);if(1==R.length&&R[0]===L&&L.invalid){t.revert();break}t.queue.unshift.apply(t.queue,R)}else if("start"!=r||L.cat!=we.WHITESPACE)if("start"==r&&L.cat==we.OTHER&&"-"==L.char)s*=-1;else if("start"!=r||L.cat!=we.OTHER||"+"!=L.char)if("start"!=r||o||!L.register)if(o&&"unit start"==r&&L.cat==we.WHITESPACE)r="unit start";else{if(o&&L.register){n=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),"integer"==L.type?h=n*L.value:"dimension"==L.type?(h=n*L.sp.value,d=n*L.em.value):"mu dimension"==L.type?d=n*L.mu.value/18:"glue"==L.type?(h=n*L.start.sp.value,d=n*L.start.em.value):"mu glue"==L.type&&(d=n*L.start.mu.value),c=!0;break}if(o&&!m&&("t"==L.char||"T"==L.char)){D=t.eat("pre space");if(!D||"r"!=D.char&&"R"!=D.char||D.cat==we.ACTIVE)t.revert(2);else{R=t.eat("pre space");if(!R||"u"!=R.char&&"U"!=D.char||R.cat==we.ACTIVE)t.revert(3);else{R=t.eat("pre space");if(R&&("e"==R.char||"E"==R.char)&&R.cat!=we.ACTIVE){m=!0,r="unit start";continue}t.revert(4)}}break}if(!o||m||"e"!=L.char&&"E"!=L.char)if(!o||"p"!=L.char&&"P"!=L.char)if(!o||"i"!=L.char&&"I"!=L.char)if(!o||"b"!=L.char&&"B"!=L.char)if(!o||"c"!=L.char&&"C"!=L.char)if(!o||"m"!=L.char&&"M"!=L.char)if(!o||"d"!=L.char&&"D"!=L.char)if(!o||"s"!=L.char&&"S"!=L.char){if("start"!=r||o){t.revert();break}W="factor",t.revert()}else{var H=t.eat("pre space");if(!H||"p"!=H.char&&"P"!=H.char||H.cat==we.ACTIVE){t.revert(2);break}h=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),c=!0}else{H=t.eat("pre space");if(!H||"d"!=H.char&&"D"!=H.char||H.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*1238/1157,c=!0}else{var M=t.eat("pre space");if(!M||"m"!=M.char&&"M"!=M.char||M.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72/2.54/10,c=!0}else{M=t.eat("pre space");if(!M||"m"!=M.char&&"M"!=M.char||M.cat==we.ACTIVE){if(!M||"c"!=M.char&&"C"!=M.char||M.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*1238/1157*12,c=!0}else h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72/2.54,c=!0}else{var P=t.eat("pre space");if(!P||"p"!=P.char&&"P"!=P.char||P.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),c=!0}else{P=t.eat("pre space");if(!P||"n"!=P.char&&"N"!=P.char||P.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*72,c=!0}else{var q=t.eat("pre space");if(!q||"t"!=q.char&&"T"!=q.char||q.cat==we.ACTIVE)if(!q||"c"!=q.char&&"C"!=q.char||q.cat==we.ACTIVE){if(!q||"x"!=q.char&&"X"!=q.char||q.cat==we.ACTIVE){t.revert(2);break}h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*12/16,c=!0}else h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")*12,c=!0;else h=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),c=!0}else{q=t.eat("pre space");if(!q||"m"!=q.char&&"M"!=q.char||q.cat==we.ACTIVE){if(!q||"x"!=q.char&&"X"!=q.char||q.cat==we.ACTIVE){t.revert(2);break}d=9107*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0")/19200*65536}else d=65536*parseFloat((n+" ").replace(" .",".").replace(". ","")||"0");c=!0}}else if("integer"==L.type?(n=L.value,"decimal"==L.message&&(n/=65536),n=" "+n,W="pre space",r="unit start"):"dimension"==L.type?(h=L.sp.value,d=L.em.value,c=!0):"mu dimension"==L.type?(d=L.mu.value/18,c=!0):"glue"==L.type?(h=L.start.sp.value,d=L.start.em.value,c=!0):"mu glue"==L.type&&(d=L.start.mu.value/18,c=!0),o=!0,c)break}return o&&c?(h*=s,d*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,m?new Ge(1e3*h/ae[ae.length-1].registers.named.mag.value,1e3*d/ae[ae.length-1].registers.named.mag.value):new Ge(h,d)):null;case"mu dimension":for(t=new se(this.string,this.queue),r="start",s=1,c=o=!(n=" "),p=0,m=!(W="pre space");!c;){var N=t.eat(W);if(!N)break;if("start"==r&&("command"==N.type||"character"==N.type&&N.cat==we.ACTIVE)){var V="command"==N.type?ae[ae.length-1].defs.primitive[N.name]||ae[ae.legnth-1].defs.macros[N.name]||ae[ae.length-1].registers.named[N.name]:ae[ae.length-1].defs.active[N.char];if(!(V=V&&V.proxy?V.original:V)||!V.register&&!Ae.includes(V)){if(V===Ce.defs.primitive.relax)break;t.revert();break}V=ie(N,t);if(1==V.length&&V[0]===N&&N.invalid){t.revert();break}t.queue.unshift.apply(t.queue,V)}else if("start"!=r||N.cat!=we.WHITESPACE)if("start"==r&&N.cat==we.OTHER&&"-"==N.char)s*=-1;else if("start"!=r||N.cat!=we.OTHER||"+"!=N.char)if("start"!=r||o||!N.register)if(o&&"unit start"==r&&N.cat==we.WHITESPACE)r="unit start";else{if(o&&N.register&&"mu glue"==N.type){p=(n=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"))*N.start.mu.value/65536,c=!0;break}if(!o||"m"!=N.char&&"M"!=N.char){if("start"!=r||o){t.revert();break}W="factor",t.revert()}else{V=t.eat("pre space");if(!V||"u"!=V.char&&"U"!=V.char||V.cat==we.ACTIVE){t.revert(2);break}p=parseFloat((n+" ").replace(" .",".").replace(". ","")||"0"),c=!0}}else if("integer"==N.type?(n=N.value,"decimal"==N.message&&(n/=65536),n=" "+n,W="pre space",r="unit start"):"dimension"==N.type?(p=N.em.value/65536*18,c=!0):"mu dimension"==N.type?(p=N.mu.value/65536,c=!0):"glue"==N.type?(p=N.start.em.value/65536*18,c=!0):"mu glue"==N.type&&(p=N.start.mu.value/65536,c=!0),o=!0,c)break}return o&&c?(p*=s,this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new ke(65536*p)):null;case"glue":for(t=new se(this.string,this.queue),r="start",W="pre space",g=v=!(f=u=s=1);;){var B=t.eat(W);if(!B&&("post start"!=r&&"stretch signs"!=r||"dimension"!=W)&&("post stretch"!=r&&"shrink signs"!=r||"dimension"!=W)){y&&t.loadState(y);break}if(B||"dimension"!=W)if("start"!=r&&"signs"!=r&&"post start"!=r&&"stretch signs"!=r&&"post stretch"!=r&&"shrink signs"!=r||"command"!=B.type&&("character"!=B.type||B.cat!=we.ACTIVE)){if("start"!=r&&"signs"!=r&&"post start"!=r&&"post stretch"!=r&&"stretch signs"!=r&&"shrink signs"!=r||B.cat!=we.WHITESPACE)if("start"!=r&&"signs"!=r||B.cat!=we.OTHER||"-"!=B.char)if("start"!=r&&"signs"!=r||B.cat!=we.OTHER||"+"!=B.char){if(("start"==r||"signs"==r)&&B.register&&"glue"==B.type){b=new Ge(B.start.sp.value*s,B.start.em.value*s),w=new Ge(B.stretch.sp.value*s,B.stretch.em.value*s),x=new Ge(B.shrink.sp.value*s,B.shrink.em.value*s),g=v=!0;break}if("start"!=r&&"signs"!=r||!B.register||"dimension"!=B.type)if("start"==r||"signs"==r)W="dimension",t.revert();else{if("post start"==r&&b&&!g&&!v&&"p"==B.char){var F=t.eat("pre space");if(F&&("l"==F.char||"L"==F.char)&&F.cat!=we.ACTIVE){F=t.eat("pre space");if(F&&("u"==F.char||"U"==F.char)&&F.cat!=we.ACTIVE){var z=t.eat("pre space");if(z&&("s"==z.char||"S"==z.char)&&z.cat!=we.ACTIVE){g=!0;continue}}}t.loadState(y);break}if("post start"==r&&g&&B.cat==we.OTHER&&"-"==B.char)u*=-1,r="stretch signs";else if("post start"==r&&g&&B.cat==we.OTHER&&"+"==B.char)r="stretch signs";else if(("post start"==r||"stretch signs"==r)&&g&&B.register&&"dimension"==B.type)w=new Ge(B.sp.value*u,B.em.value*f),r="post stretch",W="pre space",t.saveState(y=Symbol());else{if(("post start"==r||"stretch signs"==r)&&g&&B.register&&"integer"==B.type){var W="pre space",z=t.eat();if(z&&("f"==z.char||"F"==z.char)&&z.cat!=we.ACTIVE){z=t.eat("pre space");if(z&&("i"==z.char||"I"==z.char)&&z.cat!=we.ACTIVE){var U=t.eat("pre space");if(U&&("l"==U.char||"L"==U.char)&&U.cat!=we.ACTIVE){w=!(U=t.eat("pre space"))||"l"!=U.char&&"L"!=U.char||U.cat==we.ACTIVE?(U&&t.revert(),new Ee(B.value*u,1)):!(U=t.eat("pre space"))||"l"!=U.char&&"L"!=U.char||U.cat==we.ACTIVE?(U&&t.revert(),new Ee(B.value*u,2)):new Ee(B.value*u,3),r="post stretch",t.saveState(y=Symbol());continue}}}t.loadState(y);break}if("post start"!=r&&"stretch signs"!=r||!g){if(("post start"==r&&!g||"post stretch"==r)&&!v&&"m"==B.char){U=t.eat("pre space");if(U&&("i"==U.char||"I"==U.char)&&U.cat!=we.ACTIVE){U=t.eat("pre space");if(U&&("n"==U.char||"N"==U.char)&&U.cat!=we.ACTIVE){U=t.eat("pre space");if(U&&("u"==U.char||"U"==U.char)&&U.cat!=we.ACTIVE){var _=t.eat("pre space");if(_&&("s"==_.char||"S"==_.char)&&_.cat!=we.ACTIVE){v=!0;continue}}}}t.loadState(y);break}if("post stretch"==r&&v&&B.cat==we.OTHER&&"-"==B.char)f*=-1,r="shrink signs";else if("post stretch"==r&&v&&B.cat==we.OTHER&&"+"==B.char)r="shrink signs";else{if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&v&&B.register&&"dimension"==B.type){x=new Ge(B.sp.value*f,B.em.value*f);break}if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&v&&B.register&&"integer"==B.type){_=t.eat();if(_&&("f"==_.char||"F"==_.char)&&_.cat!=we.ACTIVE){_=t.eat("pre space");if(_&&("i"==_.char||"I"==_.char)&&_.cat!=we.ACTIVE){var j=t.eat("pre space");if(j&&("l"==j.char||"L"==j.char)&&j.cat!=we.ACTIVE){x=!(j=t.eat("pre space"))||"l"!=j.char&&"L"!=j.char||j.cat==we.ACTIVE?(j&&t.revert(),new Ee(B.value*f,1)):!(j=t.eat("pre space"))||"l"!=j.char&&"L"!=j.char||j.cat==we.ACTIVE?(j&&t.revert(),new Ee(B.value*f,2)):new Ee(B.value*f,3);break}}}t.loadState(y);break}if("post stretch"!=r&&"shrink signs"!=r&&"post start"!=r||!v){y?t.loadState(y):t.revert();break}W="dimension",t.revert()}}else W="dimension",t.revert()}}else b=new Ge(B.sp.value*s,B.em.value*s),r="post start",W="pre space",t.saveState(y=Symbol())}else r="signs";else s*=-1,r="signs"}else{j="command"==B.type?ae[ae.length-1].defs.primitive[B.name]||ae[ae.length-1].defs.macros[B.name]||ae[ae.length-1].registers.named[B.name]:ae[ae.length-1].defs.active[B.char];if(!(j=j&&j.proxy?j.original:j)||!j.register&&!Ae.includes(j)){if(j===Ce.defs.primitive.relax)break;t.revert();break}j=ie(B,t);if(1==j.length&&j[0]===B&&B.invalid){t.revert();break}t.queue.unshift.apply(t.queue,j)}else W="factor"}return b?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Xe(b,w,x)):null;case"mu glue":for(t=new se(this.string,this.queue),r="start",W="pre space",g=v=!(f=u=s=1);;){var G=t.eat(W);if(!G&&("post start"!=r&&"stretch signs"!=r||"mu dimension"!=W)&&("post stretch"!=r&&"shrink signs"!=r||"mu dimension"!=W)){y&&t.loadState(y);break}if(G||"mu dimension"!=W)if("start"!=r&&"signs"!=r&&"post start"!=r&&"stretch signs"!=r&&"post stretch"!=r&&"shrink signs"!=r||"command"!=G.type&&("character"!=G.type||G.cat!=we.ACTIVE)){if("start"!=r&&"signs"!=r&&"post start"!=r&&"post stretch"!=r&&"stretch signs"!=r&&"shrink signs"!=r||G.cat!=we.WHITESPACE)if("start"!=r&&"signs"!=r||G.cat!=we.OTHER||"-"!=G.char)if("start"!=r&&"signs"!=r||G.cat!=we.OTHER||"+"!=G.char){if(("start"==r||"signs"==r)&&G.register&&"mu glue"==G.type){b=new ke(G.start.mu.value*s),w=new ke(G.stretch.mu.value*s),x=new ke(G.shrink.mu.value*s),g=v=!0;break}if("start"!=r&&"signs"!=r||!G.register||"mu dimension"!=G.type)if("start"==r||"signs"==r)W="mu dimension",t.revert();else{if("post start"==r&&b&&!g&&!v&&"p"==G.char){var X=t.eat("pre space");if(X&&("l"==X.char||"L"==X.char)&&X.cat!=we.ACTIVE){X=t.eat("pre space");if(X&&("u"==X.char||"U"==X.char)&&X.cat!=we.ACTIVE){var $=t.eat("pre space");if($&&("s"==$.char||"S"==$.char)&&$.cat!=we.ACTIVE){g=!0;continue}}}t.loadState(y);break}if("post start"==r&&g&&G.cat==we.OTHER&&"-"==G.char)u*=-1,r="stretch signs";else if("post start"==r&&g&&G.cat==we.OTHER&&"+"==G.char)r="stretch signs";else if(("post start"==r||"stretch signs"==r)&&g&&G.register&&"mu dimension"==G.type)w=new ke(G.mu.value*u),r="post stretch",W="pre space",t.saveState(y=Symbol());else{if(("post start"==r||"stretch signs"==r)&&g&&G.register&&"integer"==G.type){W="pre space";$=t.eat();if($&&("f"==$.char||"F"==$.char)&&$.cat!=we.ACTIVE){$=t.eat("pre space");if($&&("i"==$.char||"I"==$.char)&&$.cat!=we.ACTIVE){var Y=t.eat("pre space");if(Y&&("l"==Y.char||"L"==Y.char)&&Y.cat!=we.ACTIVE){w=!(Y=t.eat("pre space"))||"l"!=Y.char&&"L"!=Y.char||Y.cat==we.ACTIVE?(t.revert(),new Ee(G.value*u,1)):!(Y=t.eat("pre space"))||"l"!=Y.char&&"L"!=Y.char||Y.cat==we.ACTIVE?(t.revert(),new Ee(G.value*u,2)):new Ee(G.value*u,3),r="post stretch",t.saveState(y=Symbol());continue}}}t.loadState(y);break}if("post start"!=r&&"stretch signs"!=r||!g){if(("post start"==r&&!g||"post stretch"==r)&&!v&&"m"==G.char){Y=t.eat("pre space");if(Y&&("i"==Y.char||"I"==Y.char)&&Y.cat!=we.ACTIVE){Y=t.eat("pre space");if(Y&&("n"==Y.char||"N"==Y.char)&&Y.cat!=we.ACTIVE){Y=t.eat("pre space");if(Y&&("u"==Y.char||"U"==Y.char)&&Y.cat!=we.ACTIVE){var K=t.eat("pre space");if(K&&("s"==K.char||"S"==K.char)&&K.cat!=we.ACTIVE){v=!0;continue}}}}t.loadState(y);break}if("post stretch"==r&&v&&G.cat==we.OTHER&&"-"==G.char)f*=-1,r="shrink signs";else if("post stretch"==r&&v&&G.cat==we.OTHER&&"+"==G.char)r="shrink signs";else{if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&v&&G.register&&"mu dimension"==G.type){x=new ke(G.mu.value*f);break}if(("post stretch"==r||"shrink signs"==r||"post start"==r)&&v&&G.register&&"integer"==G.type){K=t.eat();if(K&&("f"==K.char||"F"==K.char)&&K.cat!=we.ACTIVE){K=t.eat("pre space");if(K&&("i"==K.char||"I"==K.char)&&K.cat!=we.ACTIVE){var Q=t.eat("pre space");if(Q&&("l"==Q.char||"L"==Q.char)&&Q.cat!=we.ACTIVE){x=!(Q=t.eat("pre space"))||"l"!=Q.char&&"L"!=Q.char||Q.cat==we.ACTIVE?new Ee(G.value*f,1):!(Q=t.eat("pre space"))||"l"!=Q.char&&"L"!=Q.char||Q.cat==we.ACTIVE?new Ee(G.value*f,2):new Ee(G.value*f,3);break}}}t.loadState(y);break}if("post stretch"!=r&&"shrink signs"!=r&&"post start"!=r||!v){y?t.loadState(y):t.revert();break}W="mu dimension",t.revert()}}else W="mu dimension",t.revert()}}else b=new ke(G.mu.value*s),r="post start",W="pre space",t.saveState(y=Symbol())}else r="signs";else s*=-1,r="signs"}else{Q="command"==G.type?ae[ae.length-1].defs.primitive[G.name]||ae[ae.length-1].defs.macros[G.name]||ae[ae.length-1].registers.named[G.name]:ae[ae.length-1].defs.active[G.char];if(!(Q=Q&&Q.proxy?Q.original:Q)||!Q.register&&!Ae.includes(Q)){if(Q===Ce.defs.primitive.relax)break;t.revert();break}Q=ie(G,t);if(1==Q.length&&Q[0]===G&&G.invalid){t.revert();break}t.queue.unshift.apply(t.queue,Q)}else W="factor"}return b?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new Se(b,w,x)):null;case"unsigned int":for(t=new se(this.string,this.queue),n=0,l=!(r="start");;){var Z=t.eat("pre space");if(!Z)break;if("grave"==r){if("command"==Z.type&&1==Z.name.length)n=Z.name.codePointAt(0);else{if("character"!=Z.type)return null;n=Z.char.codePointAt(0)}l=!0;break}if("start"==r&&("command"==Z.type||"character"==Z.type&&Z.cat==we.ACTIVE)){var J="command"==Z.type?ae[ae.length-1].defs.primitive[Z.name]||ae[ae.length-1].defs.macros[Z.name]||ae[ae.length-1].registers.named[Z.name]:ae[ae.length-1].defs.active[Z.char];if(!(J=J&&J.proxy?J.original:J)||!J.register&&!Ae.includes(J)){if(J===Ce.defs.primitive.relax)break;t.revert();break}J=ie(Z,t);if(1==J.length&&J[0]===Z&&Z.invalid){t.revert();break}t.queue.unshift.apply(t.queue,J)}else if("start"!=r||Z.cat!=we.WHITESPACE){if("start"==r&&Z.register&&"integer"==Z.type){n=Z.value,l=!0;break}if(("decimal"==r||"start"==r)&&Z.cat==we.OTHER&&47<Z.code&&Z.code<58)n=10*n+parseInt(Z.char,10),r="decimal",l=!0;else if("start"==r&&Z.cat==we.OTHER&&"'"==Z.char)r="octal";else if("start"==r&&Z.cat==we.OTHER&&'"'==Z.char)r="hexadecimal";else if("start"==r&&Z.cat==we.OTHER&&"`"==Z.char)r="grave";else if("octal"==r&&Z.cat==we.OTHER&&47<Z.code&&Z.code<56)n=8*n+parseInt(Z.char,8),l=!0;else{if("hexadecimal"!=r||!(Z.cat==we.OTHER&&47<Z.code&&Z.code<58||(Z.cat==we.OTHER||Z.cat==we.LETTER)&&64<Z.code&&Z.code<71)){t.revert();break}n=16*n+parseInt(Z.char,16),l=!0}}}return l?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new xe(n)):null;case"factor":for(t=new se(this.string,this.queue),n="",l=!(r="start"),W="pre space";;){var ee=t.eat(W);if(!ee)break;if("start"==r&&("command"==ee.type||"character"==ee.type&&ee.cat==we.ACTIVE)){var te="command"==ee.type?ae[ae.length-1].defs.primitive[ee.name]||ae[ae.length-1].defs.macros[ee.name]||ae[ae.length-1].registers.named[ee.name]:ae[ae.length-1].defs.active[ee.char];if(!(te=te&&te.proxy?te.original:te)||!te.register&&!Ae.includes(te)){if(te===Ce.defs.primitive.relax)break;t.revert();break}te=ie(ee,t);if(1==te.length&&te[0]===ee&&ee.invalid){t.revert();break}t.queue.unshift.apply(t.queue,te)}else if("start"!=r||ee.cat!=we.WHITESPACE){if("start"==r&&ee.register&&"integer"==ee.type){n=ee.value.toString(),l=!0;break}if(("pre decimal"==r||"start"==r)&&ee.cat==we.OTHER&&47<ee.code&&ee.code<58)n+=ee.char,r="pre decimal",l=!0;else if("pre decimal"!=r&&"start"!=r||ee.cat!=we.OTHER||"."!=ee.char&&","!=ee.char)if("post decimal"==r&&ee.cat==we.OTHER&&47<ee.code&&ee.code<58)n+=ee.char;else{if("start"!=r){t.revert();break}W="unsigned int",t.revert()}else n+=".",r="post decimal",l=!0}}return l?(this.history.push({queue:this.queue.slice(),string:this.string,history:this.history.slice()}),t.finalize(),this.string=t.string,new xe(65536*n,null,null,"decimal")):null}},this.preview=function(e){e=this.eat(e);return e&&this.revert(),e},this.revert=function(e){for(e="number"==typeof e?e:1;0<e;e--){if(0==this.history.length)return;this.string=this.history[this.history.length-1].string;for(var t=0,i=this.history[this.history.length-1].queue.length;t<i;t++)this.queue[t]=this.history[this.history.length-1].queue[t];this.queue.length=this.history[this.history.length-1].queue.length,this.history=this.history[this.history.length-1].history}},this.finalize=function(){for(var e=0,t=this.queue.length;e<t;e++)(a||s)[e]=this.queue[e];(a||s).length=this.queue.length,"string"!=typeof i&&(r=this.string)},this.saveState=function(e){this.savedStates[e]={queue:this.queue.slice(),string:this.string,history:this.history.slice()}},this.loadState=function(e){this.string=this.savedStates[e].string,this.history=this.savedStates[e].history;for(var t=0,i=this.savedStates[e].queue.length;t<i;t++)this.queue[t]=this.savedStates[e].queue[t];this.queue.length=this.savedStates[e].queue.length},this.expand=ie}var Y=function e(){_classCallCheck(this,e),_defineProperty(this,"split",!1);var t,i,a,s,r,n,l,o,c,h,d,p,m,u=ae[ae.length-1]||Ce;for(t in this.parentScope=u,this.defs={primitive:{},macros:{},active:{}},this.registers={count:{},dimen:{},skip:{},muskip:{},named:{}},this.cats={},this.mathcodes={},this.lc={},this.uc={},this.font={},u.defs.primitive)this.defs.primitive[t]=u.defs.primitive[t];for(i in u.defs.macros)this.defs.macros[i]=u.defs.macros[i];for(a in u.defs.active)this.defs.active[a]=u.defs.active[a];for(s in u.lc)this.lc[s]=new xe(u.lc[s]);for(r in u.uc)this.uc[r]=new xe(u.uc[r]);for(n in u.font)this.font[n]=u.font[n];for(l in u.cats)isNaN(l)||(this.cats[l]=new xe(u.cats[l]));for(o in u.mathcodes)isNaN(o)||(this.mathcodes[o]=new xe(u.mathcodes[o]));for(c in u.registers.count)this.registers.count[c]=new xe(u.registers.count[c]);for(h in u.registers.dimen)this.registers.dimen[h]=new Ge(u.registers.dimen[h]);for(d in u.registers.skip)this.registers.skip[d]=new Xe(u.registers.skip[d]);for(p in u.registers.muskip)this.registers.muskip[p]=new Se(u.registers.muskip[p]);for(m in u.registers.named){var f=u.registers.named[m],v="integer"==f.type?"count":"dimension"==f.type?"dimen":"glue"==f.type?"skip":"muskip";if(Object.values(u.registers[v]).includes(f))for(var g in u.registers[v])u.registers.named[m]===u.registers[v][g]&&(this.registers.named[m]=this.registers[v][g]);else this.registers.named[m]=new("integer"==f.type?xe:"dimension"==f.type?Ge:"glue"==f.type?Xe:Se)(f)}this.tokens=[],ae.push(this)};function re(e){return e?(e=e.codePointAt(0))in ae[ae.length-1].cats?ae[ae.length-1].cats[e].value:we.OTHER:null}function K(e){return e?(e=e.codePointAt(0))in ae[ae.length-1].mathcodes?ae[ae.length-1].mathcodes[e].value:ze.ORD:null}var i=new se;new Y;for(var Q=[];;){var a=i.eat();if(null===a){if("standalone"==G)break;return[[],e,!1]}var n=$[$.length-1]||{},l=ae[ae.length-1];if("command"==a.type||"character"==a.type&&a.cat==we.ACTIVE){"mathchoice"==n.type&&n.failed();var o=i.expand(a,i);i.queue.unshift.apply(i.queue,o)}else{if("character"==a.type&&a.cat==we.PARAMETER)"mathchoice"==n.type&&n.failed(),i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});else if("character"==a.type&&a.cat==we.MATHSHIFT)if("mathchoice"==n.type&&n.failed(),"display"==G){for(var c=new se(i.string,i.queue),h=!1;;){var d=c.eat();if(!d)break;if("command"!=d.type&&("character"!=d.type||d.cat!=we.ACTIVE)){if("character"!=d.type||d.cat!=we.MATHSHIFT)break;h=!0,c.finalize(),i.string=c.string;break}d=c.expand(d,c);c.queue.unshift.apply(c.queue,d)}if(h)break;i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0})}else{if("inline"==G)break;i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0})}else if("character"==a.type&&a.cat==we.SUPERSCRIPT){"mathchoice"==n.type&&n.failed();for(var p=null,m=l.tokens.length-1;0<=m;m--)if("atom"==l.tokens[m].type&&!l.tokens[m].ignore){p=l.tokens[m];break}p||(p={type:"atom",atomType:ze.ORD,nucleus:null,superscript:null,subscript:null},l.tokens.push(p)),p.superscript?l.tokens.push({type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}):"superscript"==n.type||"subscript"==n.type?(p[n]=[{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}],$.pop()):(o={type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0},l.tokens.push(o),$.push({toString:function(){return"superscript"},type:"superscript",token:o}))}else if("character"==a.type&&a.cat==we.SUBSCRIPT){"mathchoice"==n.type&&n.failed();for(var u=null,f=l.tokens.length-1;0<=f;f--)if("atom"==l.tokens[f].type&&!l.tokens[f].ignore){u=ae.last().tokens[f];break}u||(u={type:"atom",atomType:ze.ORD,nucleus:null,superscript:null,subscript:null},l.tokens.push(u)),u.subscript?l.tokens.push({type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}):"superscript"==n.type||"subscript"==n.type?(u[n]=[{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code,invalid:!0},superscript:null,subscript:null}],$.pop()):(k={type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0},l.tokens.push(k),$.push({toString:function(){return"subscript"},type:"subscript",token:k}))}else if("character"==a.type&&a.cat==we.OPEN){var v={type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:a.char,code:a.code},superscript:null,subscript:null,ignore:!0};Q.push(v),$.push({toString:function(){return"scope"},type:"scope"}),new Y,ae[ae.length-1].tokens.push(v)}else if("character"==a.type&&a.cat==we.CLOSE)if(1==ae.length||!Q.length||l.delimited||l.semisimple||l.isHalign||l.isHalignCell||"scope"!=n)i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});else{Q.pop(),$.pop();var n=$[$.length-1]||{},g=void 0,g=l.isFrac?[{type:"atom",atomType:ze.INNER,nucleus:[{type:"fraction",numerator:l.fracNumerator,denominator:l.tokens,barWidth:l.barWidth,delims:[l.fracLeftDelim,l.fracRightDelim],nullDelimiterSpace:new Ge(l.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]:l.tokens;if(l.root&&(l.root.invalid=!0),ae[ae.length-2]&&ae[ae.length-2].noAligned)ae[ae.length-3].noAligns.push({type:"atom",atomType:ze.ORD,nucleus:g,superscript:null,subscript:null}),ae.pop();else if("superscript"==n.type){ae.pop();for(var y=(l=ae[ae.length-1]).tokens.length-1;0<=y;y--)if("atom"==l.tokens[y].type&&!l.tokens[y].ignore){l.tokens[y].superscript=g;break}$.pop()}else if("subscript"==n.type){ae.pop();for(var b=(l=ae[ae.length-1]).tokens.length-1;0<=b;b--)if("atom"==l.tokens[b].type&&!l.tokens[b].ignore){l.tokens[b].subscript=g;break}$.pop()}else l.isFrac?(ae.pop(),ae[ae.length-1].tokens.push(g[0])):(ae.pop(),ae[ae.length-1].tokens.push({type:"atom",atomType:ze.ORD,nucleus:g,superscript:null,subscript:null})),"mathchoice"==n.type&&4==++n.current&&n.succeeded()}else if("character"==a.type&&a.cat==we.ALIGN){"mathchoice"==n.type&&n.failed();for(var w=!1,x=ae.length-1;0<=x;x--)if(ae[x].isHalignCell){w=ae[x];break}if(!w){i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});continue}var k=w.parentScope,S=k.cellData[k.cellData.length-1];if(S[S.length-1].omit&&(a.postPreamble=!0),a.postPreamble&&!l.isHalignCell||"scope"!=n){i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});continue}if(!a.postPreamble){for(var E=-1,C=0,A=S.length;C<A;C++)E+=S[C].span;var T=void 0;if(k.preamble[E])T=k.preamble[E][1];else{if(!~k.repeatPreambleAt){i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});continue}v=k.preamble.slice(k.repeatPreambleAt,k.preamble.length),T=v[(E-k.repeatPreambleAt)%v.length][1]}if(!k.preamble[++E]&&!~k.repeatPreambleAt){i.queue.unshift({type:"character",cat:we.OTHER,char:a.char,code:a.code,invalid:!0});continue}for(var O=[],I=0,L=T.length;I<L;I++){var D,R={};for(D in T[I])R[D]=T[I][D];O.push(R)}i.queue.unshift.apply(i.queue,O.concat(a)),a.postPreamble=!0;continue}l.root&&(l.root.invalid=!0),$.pop(),n=$[$.length-1]||{};var H=l.tokens;l.isFrac?(S[S.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:l.fracNumerator,denominator:H,barWidth:l.barWidth,delims:[l.fracLeftDelim,l.fracRightDelim],nullDelimiterSpace:new Ge(l.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),ae.pop()):(ae.pop(),S[S.length-1].content=S[S.length-1].content.concat(H)),l=ae[ae.length-1];var M=Symbol();for(i.saveState(M),S.push({type:"cell",content:[],omit:!1,span:1});;){var P=i.eat();if(!P){i.loadState(M);break}if("character"==P.type&&P.cat!=we.ACTIVE){i.loadState(M);break}if("command"==P.type||"character"==P.type&&P.cat==we.ACTIVE){if(P.name in l.registers.named){i.loadState(M);break}var q="command"==P.type?l.defs.primitive[P.name]||l.defs.macros[P.name]:l.defs.active[P.char];if(!q){i.loadState(M);break}if(q.proxy&&(q=q.original),Te.includes(q)){var N=i.expand(P,i);if(1==N.length&&N[0]===P&&P.invalid){i.loadState(M);break}i.queue.unshift.apply(i.queue,N)}else{if(q===Ce.defs.primitive.omit){S[S.length-1].omit=!0;break}if("primitive"==q.type){i.loadState(M);break}q=i.expand(P,i);if(1==q.length&&q[0]==-P&&P.invalid){i.loadState(M);break}i.queue.unshift.apply(i.queue,q)}}}if($.push({toString:function(){return"scope"},type:"scope"}),new Y,ae[ae.length-1].isHalignCell=!0,!S[S.length-1].omit){for(var V=-1,B=0,F=S.length;B<F;B++)V+=S[B].span;k.preamble[V]?H=k.preamble[V][0]:~k.repeatPreambleAt&&(H=(ie=k.preamble.slice(k.repeatPreambleAt,k.preamble.length))[(V-k.repeatPreambleAt)%ie.length][0]);for(var z=[],W=0,U=H.length;W<U;W++){var _,j={};for(_ in H[W])j[_]=H[W][_];z.push(j)}i.queue.unshift.apply(i.queue,z)}}else if("character"==a.type){"mathchoice"==n.type&&n.failed();var Z={type:"symbol",char:a.char,code:a.code,invalid:a.invalid},J=a.forcedMathCode+1?a.forcedMathCode:K(Z.char);if((J=a.invalid&&a.recognized?0:J)==we.ACTIVE){if(l.defs.active[a.char]){i.queue.unshift.apply(i.queue,(l.defs.active[a.char].replacement||l.defs.active[a.char].original.replacement).slice());continue}a.invalid=Z.invalid=!0,J=0}if("superscript"==n.type){for(var ee=l.tokens.length-1;0<=ee;ee--)if("atom"==l.tokens[ee].type&&!l.tokens[ee].ignore){l.tokens[ee].superscript=[{type:"atom",atomType:J,nucleus:Z,superscript:null,subscript:null}];break}$.pop()}else if("subscript"==n.type){for(var te=l.tokens.length-1;0<=te;te--)if("atom"==l.tokens[te].type&&!l.tokens[te].ignore){l.tokens[te].subscript=[{type:"atom",atomType:J,nucleus:Z,superscript:null,subscript:null}];break}$.pop()}else l.tokens.push({type:"atom",atomType:J,nucleus:Z,superscript:null,subscript:null})}else if(a.register){"mathchoice"==n.type&&n.failed();var ie=Symbol();i.saveState(ie);n=i.eat();if(!n||"character"==n.type&&"="==n.char&&n.cat==we.OTHER||i.revert(),"integer"==a.type){var ne=i.eat("integer");if(ne){if(ne.value<a.min||a.max<ne.value){i.loadState(ie);continue}var le=a;if(X.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).value=ne.value;le.value=ne.value,X.global=!1}else i.loadState(ie)}else if("dimension"==a.type){var oe=i.eat("dimension");if(oe){if(a.sp.value=oe.sp.value,a.em.value=oe.em.value,X.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).sp.value=oe.sp.value,a.em.value=oe.em.value;X.global=!1}else i.loadState(ie)}else if("mu dimension"==a.type){le=i.eat("mu dimension");if(le){if(a.mu.value=le.mu.value,X.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).mu.value=integer.mu.value;X.global=!1}else i.loadState(ie)}else if("glue"==a.type){var ce=i.eat("glue");if(ce){if(a.start.sp.value=ce.start.sp.value,a.start.em.value=ce.start.em.value,"infinite dimension"==ce.stretch.type?a.stretch=new Ee(ce.stretch.number.value,ce.stretch.magnitude.value):a.stretch=new Ge(ce.stretch.sp.value,ce.stretch.em.value),"infinite dimension"==ce.shrink.type?a.shrink=new Ee(ce.shrink.number.value,ce.shrink.magnitude.value):a.shrink=new Ge(ce.shrink.sp.value,ce.shrink.em.value),X.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).start.sp.value=ce.start.sp.value,a.start.em.value=ce.start.em.value,"infinite dimension"==ce.stretch.type?a.stretch=new Ee(ce.stretch.number.value,ce.stretch.magnitude.value):a.stretch=new Ge(ce.stretch.sp.value,ce.stretch.em.value),"infinite dimension"==ce.shrink.type?a.shrink=new Ee(ce.shrink.number.value,ce.shrink.magnitude.value):a.shrink=new Ge(ce.shrink.sp.value,ce.shrink.em.value);X.global=!1}else i.loadState(ie)}else if("mu glue"==a.type){var he=i.eat("mu glue");if(he){if(a.start.mu.value=he.start.mu.value,"infinite dimension"==he.stretch.type?a.stretch=new Ee(he.stretch.number.value,he.stretch.magnitude.value):a.stretch=new ke(he.stretch.mu.value),"infinite dimension"==he.shrink.type?a.shrink=new Ee(he.shrink.number.value,he.shrink.magnitude.value):a.shrink=new ke(he.shrink.mu.value),X.global&&0<=l.registers.named.globaldefs.value||0<l.registers.named.globaldefs.value)for(;a.parent;)(a=a.parent).start.mu.value=he.start.mu.value,"infinite dimension"==he.stretch.type?a.stretch=new Ee(he.stretch.number.value,he.stretch.magnitude.value):a.stretch=new ke(he.stretch.mu.value),"infinite dimension"==he.shrink.type?a.shrink=new Ee(he.shrink.number.value,he.shrink.magnitude.value):a.shrink=new ke(he.shrink.mu.value);X.global=!1}else i.loadState(ie)}}else if("ignored command"==a.type){l.tokens.push(a.token);continue}for(var de in X)X[de]&&(X[de].invalid=!0,X[de]=!1)}}var pe=$[$.length-1]||{};for("superscript"!=pe&&"subscript"!=pe||(pe.token.invalid=!0,pe.token.ignore=!1);1<ae.length;){$.pop();var me=$[$.length-1]||{},ue=(fe=ae[ae.length-1]).tokens;if(fe.root&&(fe.root.invalid=!0),"superscript"==me.type){ae.pop();for(var fe,ve=(fe=ae[ae.length-1]).tokens.length-1;0<=ve;ve--)if("atom"==fe.tokens[ve].type&&!fe.tokens[ve].ignore){fe.tokens[ve].superscript=ue;break}$.pop(),me=$[$.length-1]||{}}else if("subscript"==me.type){ae.pop();for(var ge=(fe=ae[ae.length-1]).tokens.length-1;0<=ge;ge--)if("atom"==fe.tokens[ge].type&&!fe.tokens[ge].ignore){fe.tokens[ge].subscript=ue;break}$.pop(),me=$[$.length-1]||{}}else fe.isFrac?(ae[ae.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:fe.fracNumerator,denominator:ue,barWidth:fe.barWidth,delims:[fe.fracLeftDelim,fe.fracRightDelim],nullDelimiterSpace:new Ge(fe.registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),ae.pop(),fe=ae[ae.length-1]):(ae.pop(),(fe=ae[ae.length-1]).tokens.push({type:"atom",atomType:ze.ORD,nucleus:ue,superscript:null,subscript:null}))}ae[0].isFrac&&(pe=ae[0].tokens,ae[0].tokens=[{type:"atom",atomType:ze.INNER,nucleus:[{type:"fraction",numerator:ae[0].fracNumerator,denominator:pe,barWidth:ae[0].barWidth,delims:[ae[0].fracLeftDelim,ae[0].fracRightDelim],nullDelimiterSpace:new Ge(ae[0].registers.named.nulldelimiterspace)}],superscript:null,subscript:null}]);for(var ye=0,be=Q.length;ye<be;ye++)Q[ye].invalid=!0;return function l(o){for(var c=0,h=o.length;c<h;c++)!function(t,e){var i;if(o[t]&&o[t].ignore&&"command"==o[t].type)o[t].invalid?(i=(o[t].escapeChar+o[t].name).split("").map(function(e){return{type:"atom",atomType:o[t].recognized?ze.ORD:ze.VARIABLE,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),o.splice(t,1,{type:"atom",atomType:ze.ORD,nucleus:i,superscript:null,subscript:null})):o.splice(t,1),e=o.length,t--;else if(o[t]&&o[t].ignore&&!o[t].invalid)o.splice(t,1),e=o.length,t--;else if(o[t]&&"fraction"==o[t].type)l(o[t].numerator),l(o[t].denominator);else if(o[t]&&"table"==o[t].type){l(o[t].noAligns);for(var a=0,s=o[t].cellData.length;a<s;a++)for(var r=0,n=o[t].cellData[a].length;r<n;r++)l(o[t].cellData[a][r].content)}else o[t]&&"atom"==o[t].type?(Array.isArray(o[t].nucleus)&&l(o[t].nucleus),Array.isArray(o[t].superscript)&&l(o[t].superscript),Array.isArray(o[t].subscript)&&l(o[t].subscript)):o[t]&&"mathchoice"==o[t].type?l(o[t].groups):o[t]&&"box"==o[t].type?l([o[t].content]):o[t]&&"family modifier"==o[t].type&&"rad"==o[t].value&&l(o[t].index);c=t,h=e}(c,h)}(ae[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"family modifier"==t[a].type)t[a+1]&&"atom"==t[a+1].type?("phantom"==t[a].value?(t.splice(a,1),t[a].phantom=!0):(t.splice(a,2,{type:"atom",atomType:t[a].value,nucleus:[t[a+1]],superscript:t[a+1].superscript,subscript:t[a+1].subscript,invalid:t[a+1].invalid,index:t[a].index,phantom:t[a+1].phantom}),t[a].nucleus[0].superscript=null,t[a].nucleus[0].subscript=null,a--),s=t.length):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:ze.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(ae[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"accent modifier"==t[a].type)t[a+1]&&"atom"==t[a+1].type?(t.splice(a,2,{type:"atom",atomType:ze.ACC,nucleus:[t[a+1]],superscript:t[a+1].superscript,subscript:t[a+1].subscript,accChar:t[a].char,accCode:t[a].code,invalid:t[a+1].invalid,phantom:t[a+1].phantom}),t[a].nucleus[0].superscript=null,t[a].nucleus[0].subscript=null,s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:ze.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(ae[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"limit modifier"==t[a].type)t[a-1]&&"atom"==t[a-1].type&&t[a-1].atomType==ze.OP?(t[a-1].limits=t[a].value,t.splice(a,1),s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:ze.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(t[a].atomType==ze.OP&&(t[a].limits="display"),Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(ae[0].tokens),function e(t){for(var i,a=0,s=t.length;a<s;a++)if(t[a]&&"box wrapper"==t[a].type)t[a+1]&&"atom"==t[a+1].type?(t.splice(a,2,{type:"box",boxType:t[a].value,to:t[a].to,spread:t[a].spread,content:t[a+1],superscript:null,subscript:null}),s=t.length,a--):(i=("command"==t[a].token.type?t[a].token.escapeChar+t[a].token.name:t[a].token.char).split("").map(function(e){return{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0),invalid:!0},superscript:null,subscript:null}}),t[a]={type:"atom",atomType:ze.ORD,nucleus:i,superscript:null,subscript:null});else if(t[a]&&"fraction"==t[a].type)e(t[a].numerator),e(t[a].denominator);else if(t[a]&&"table"==t[a].type){e(t[a].noAligns);for(var r=0,n=t[a].cellData.length;r<n;r++)for(var l=0,o=t[a].cellData[r].length;l<o;l++)e(t[a].cellData[r][l].content)}else t[a]&&"atom"==t[a].type?(Array.isArray(t[a].nucleus)&&e(t[a].nucleus),Array.isArray(t[a].superscript)&&e(t[a].superscript),Array.isArray(t[a].subscript)&&e(t[a].subscript),Array.isArray(t[a].index)&&e(t[a].index)):t[a]&&"mathchoice"==t[a].type?e(t[a].groups):t[a]&&"box"==t[a].type&&e([t[a].content])}(ae[0].tokens),function e(t){for(var i=0,a=t.length;i<a;i++)if(t[i]&&"atom"==t[i].type)Array.isArray(t[i].nucleus)&&e(t[i].nucleus),Array.isArray(t[i].superscript)&&e(t[i].superscript),Array.isArray(t[i].subscript)&&e(t[i].subscript),Array.isArray(t[i].index)&&e(t[i].index),Array.isArray(t[i].nucleus)&&1==t[i].nucleus.length&&!t[i].nucleus[0].delimited&&([ze.ORD,ze.BIN,ze.REL,ze.OPEN,ze.CLOSE,ze.PUNCT,ze.INNER].includes(t[i].nucleus[0].atomType)&&![ze.OVER,ze.UNDER,ze.RAD].includes(t[i].atomType)?t[i].nucleus[0].superscript||t[i].nucleus[0].subscript?t[i].superscript||t[i].subscript||(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,i--):(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,i--):t[i].nucleus[0].atomType==ze.VARIABLE&&t[i].atomType==ze.ORD?t[i].nucleus[0].superscript||t[i].nucleus[0].subscript?t[i].superscript||t[i].subscript||(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].superscript=t[i].nucleus[0].superscript,t[i].subscript=t[i].nucleus[0].subscript,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=ze.VARIABLE,i--):(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus,t[i].atomType=ze.VARIABLE,i--):t[i].nucleus[0].atomType!=ze.VARIABLE&&[ze.OVER,ze.UNDER,ze.RAD,ze.ACC].includes(t[i].atomType)&&(t[i].nucleus[0].superscript||t[i].nucleus[0].subscript||(t[i].phantom=t[i].phantom||t[i].nucleus[0].phantom,t[i].nucleus=t[i].nucleus[0].nucleus)));else if(t[i]&&"fraction"==t[i].type)t[i].numerator&&Array.isArray(t[i].numerator)&&1==t[i].numerator.length&&!t[i].numerator.subscript&&!t[i].numerator.superscript&&Array.isArray(t[i].numerator[0].nucleus)&&(t[i].numerator=t[i].numerator[0].nucleus),t[i].denominator&&Array.isArray(t[i].denominator)&&1==t[i].denominator.length&&!t[i].denominator.subscript&&!t[i].denominator.superscript&&Array.isArray(t[i].denominator[0].nucleus)&&(t[i].denominator=t[i].denominator[0].nucleus),e(t[i].numerator),e(t[i].denominator);else if(t[i]&&"table"==t[i].type){e(t[i].noAligns);for(var s=0,r=t[i].cellData.length;s<r;s++)for(var n=0,l=t[i].cellData[s].length;n<l;n++)e(t[i].cellData[s][n].content)}else t[i]&&"mathchoice"==t[i].type?e(t[i].groups):t[i]&&"box"==t[i].type&&e(t[i].content.nucleus)}(ae[0].tokens),i.finalize(),t&&t?ae[0]:[ae[0].tokens,r,!0]}function A(Pe,e,w,qe){var t=document.createElement("div");"display"==w?t.style.textAlign="center":t.style.display="inline-block";var Ne=parseFloat(qe.fontSize),Ve=qe.fontFamily;function Be(e){var t,i=_createForOfIteratorHelper(e.children);try{for(i.s();!(t=i.n()).done;)Be(t.value)}catch(e){i.e(e)}finally{i.f()}return e.style.flexWrap&&(e.style.flexWrap="nowrap"),e}return function Ae(Te,Oe,Ie,Le,e){Te=Te.slice();if(!Te.length){var t=document.createElement("div");return t.style.display="inline-flex",t.displayedStyle=Oe,t.crampedStyle=Ie,t.renderedDepth=0,t.renderedHeight=0,e.renderedHeight=e.renderedHeight||0,e.renderedDepth=e.renderedDepth||0,e.baseline=$e.baselineHeightOf(Ve),e.baselineOffset=0,e.appendChild(t),void(t.empty=!0)}var De=null;var Re=document.createElement("div");Re.style.display="inline-flex";Re.style.flexWrap="wrap";Re.style.alignItems="baseline";Re.displayedStyle=Oe;Re.crampedStyle=Ie;Re.style.justifyContent="display"==w?"center":"initial";var i=[document.createElement("div")];i[0].style.display="inline-flex";i[0].style.flexWrap="nowrap";i[0].style.alignItems="baseline";var He=[];var Me=[];var a=0;var s=function(e){var F=Te[e],t=Te[e+1]||{};Te[e-1];if(["glue","kern","vglue","vkern"].includes(F.type))return F.italicCorrection&&(F.italicCorrection=De||""),"glue"==F.type&&F.isNonScript&&("script"==Oe||"scriptscript"==Oe)&&["glue","vglue","kern","vkern"].includes(t.type)?Te.splice(e+1,1):("glue"==F.type&&"mu glue"==F.glue.type?F.glue=new Xe(new Ge(0,F.glue.start.mu.value/18),"infinite dimension"==F.glue.stretch.type?F.glue.stretch:new Ge(0,Math.floor(F.glue.stretch.mu.value/18)),"infinite dimension"==F.glue.shrink.type?F.glue.shrink:new Ge(0,~~(F.glue.shrink.mu.value/18))):"kern"==F.type&&"mu dimension"==F.dimen.type?F.dimen=new Ge(0,Math.floor(F.dimen.mu.value/18)):"vglue"==F.type&&(F.type="vkern",F.dimen=F.glue.start,delete F.glue),He.push(F)),"continue";if("font modifier"==F.type)return["displaystyle","textstyle","scriptstyle","scriptscriptstyle"].includes(F.value)?Oe=F.value.substring(0,F.value.length-5):Le=F.value,"continue";if("mathchoice"==F.type){var i=F.groups[["display","text","script","scriptscript"].indexOf(Oe)];return Te.splice.apply(Te,[e+1,0].concat("symbol"==i.nucleus.type?[i]:i.nucleus)),"continue"}if("atom"!=F.type||F.atomType!=ze.BIN||Me.length&&![ze.OP,ze.BIN,ze.REL,ze.OPEN,ze.PUNCT].includes(Me[Me.length-1].atomType)||(F.atomType=ze.ORD),"atom"!=F.type||!Me.length||F.atomType!=ze.REL&&F.atomType!=ze.CLOSE&&F.atomType!=ze.PUNCT||Me[Me.length-1].atomType!=ze.BIN||(Me[Me.length-1].atomType=ze.ORD),"atom"==F.type&&F.atomType==ze.OP&&"display"==F.limits&&(F.limits="display"==Oe),"fraction"==F.type){var a=function(e,t,i,a){var s,r,n,l,o,c,h,d,p,m;switch(t){case".":default:He.splice(He.length-(i?1:0),0,{type:"kern",dimen:F.nullDelimiterSpace});break;case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":s=Math.max(P,$e.heightOf(t,Ve)+$e.depthOf(t,Ve)),e.style.height="".concat(s,"em"),e.style.width="".concat($e.widthOf(t,Ve),"em"),e.style.verticalAlign="middle",e.height=a,e.width=$e.widthOf(t,Ve)/($e.heightOf(t,Ve)+$e.depthOf(t,Ve))*a,(r=e.getContext("2d")).textAlign="center",r.fillStyle=qe.color,r.font="".concat(a/($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),"px ").concat(Ve),r.fillText(t,e.width/2,a-$e.depthOf(t,Ve)*a/($e.heightOf(t,Ve)+$e.depthOf(t,Ve))),F.div.insertBefore(e,i?F.div.firstElementChild:null);break;case"(":case")":if(s=Math.max(P,$e.heightOf(t,Ve)+$e.depthOf(t,Ve)),e.style.height="".concat(s,"em"),e.style.width="".concat($e.widthOf(t,Ve),"em"),e.style.verticalAlign="middle",Math.floor(Math.floor(a/2*s)-a)<=0)e.height=a,e.width=$e.widthOf(t,Ve)/($e.heightOf(t,Ve)+$e.depthOf(t,Ve))*a,(r=e.getContext("2d")).textAlign="center",r.fillStyle=qe.color,r.font="".concat(a/($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),"px ").concat(Ve),r.fillText(t,e.width/2,a-$e.depthOf(t,Ve)*a/($e.heightOf(t,Ve)+$e.depthOf(t,Ve)));else if(n=$e.heightOf(t,Ve)+$e.depthOf(t,Ve),e.height=Math.max(s,1)*a,e.width=$e.widthOf(t,Ve)/$e.heightOf(t,Ve)*a*($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=qe.color,r.font="".concat(a/n,"px ").concat(Ve),r.fillText(t,e.width/2,a/2-$e.depthOf(t,Ve)*a*n),c=r.getImageData(0,0,e.width,a/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-$e.depthOf(t,Ve)*a/n),r.clearRect(0,a/2,e.width,e.height),r.putImageData(c,0,e.height-a/2),e.height>a){l=r.createImageData(e.width,e.height-a),p=r.getImageData(0,a/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var u=0,f=l.height/2;u<f;u++)for(var v=0,g=e.width;v<g;v++){var y=u*e.width*4+4*v;l.data[y]=p[4*v+0],l.data[1+y]=p[4*v+1],l.data[2+y]=p[4*v+2],l.data[3+y]=p[4*v+3],y=~~(u+l.height/2)*e.width*4+4*v,l.data[y]=m[4*v+0],l.data[1+y]=m[4*v+1],l.data[2+y]=m[4*v+2],l.data[3+y]=m[4*v+3]}r.putImageData(l,0,a/2)}F.div.insertBefore(e,i?F.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(M=$e.heightOf("x",Ve)/2,s=Math.max(P,$e.heightOf(t,Ve)+$e.depthOf(t,Ve)),e.style.height="".concat(s,"em"),e.style.width="".concat($e.widthOf(t,Ve),"em"),e.style.verticalAlign="middle",n=$e.heightOf(t,Ve)+$e.depthOf(t,Ve),e.height=Math.max(s,1)*a,e.width=$e.widthOf(t,Ve)/$e.heightOf(t,Ve)*a*($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=qe.color,r.font="".concat(a/n,"px ").concat(Ve),r.fillText(t,e.width/2,a/2-$e.depthOf(t,Ve)*a*n),c=r.getImageData(0,0,e.width,a/2),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-$e.depthOf(t,Ve)*a/n),r.clearRect(0,a/2,e.width,e.height),r.putImageData(c,0,e.height-a/2),e.height>a){l=r.createImageData(e.width,e.height-a),p=r.getImageData(0,a/2-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var b=0,w=l.height/2;b<w;b++)for(var x=0,k=e.width;x<k;x++){var S=b*e.width*4+4*x;l.data[S]=p[4*x+0],l.data[1+S]=p[4*x+1],l.data[2+S]=p[4*x+2],l.data[3+S]=p[4*x+3],S=~~(b+l.height/2)*e.width*4+4*x,l.data[S]=m[4*x+0],l.data[1+S]=m[4*x+1],l.data[2+S]=m[4*x+2],l.data[3+S]=m[4*x+3]}r.putImageData(l,0,a/2)}F.div.insertBefore(e,i?F.div.firstElementChild:null);break;case"{":case"}":if(s=Math.max(P,$e.heightOf(t,Ve)+$e.depthOf(t,Ve)),e.style.height="".concat(s,"em"),e.style.width="".concat($e.widthOf(t,Ve),"em"),e.style.verticalAlign="middle",n=a/($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),e.height=Math.max(s,1)*a,e.width=$e.widthOf(t,Ve)/$e.heightOf(t,Ve)*a*($e.heightOf(t,Ve)+$e.depthOf(t,Ve)),(r=e.getContext("2d")).textAlign="center",r.fillStyle=qe.color,r.font="".concat(n,"px ").concat(Ve),3<=a&&(r.fillText(t,e.width/2,Math.floor(a/3)-$e.depthOf(t,Ve)*n),c=r.getImageData(0,0,e.width,Math.floor(a/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,a-$e.depthOf(t,Ve)*n),o=r.getImageData(0,0,e.width,Math.floor(a/3)),r.clearRect(0,0,e.width,e.height),r.fillText(t,e.width/2,e.height/2+a/2-$e.depthOf(t,Ve)*n),r.clearRect(0,0,e.width,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3)),r.clearRect(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3),e.width,e.height),r.putImageData(o,0,0),r.putImageData(c,0,e.height-Math.floor(a/3)),e.height>a)){h=r.createImageData(e.width,Math.ceil((e.height-a)/2)),p=o.data.slice((Math.floor(a/3)-1)*e.width*4,Math.floor(a/3)*e.width*4),m=r.getImageData(0,Math.floor(e.height/2)-Math.floor(a/2)+Math.floor(a/3),e.width,1).data;for(var E=0,C=h.height/2;E<C;E++)for(var A=0,T=e.width;A<T;A++){var O=E*e.width*4+4*A;h.data[O]=p[4*A+0],h.data[1+O]=p[4*A+1],h.data[2+O]=p[4*A+2],h.data[3+O]=p[4*A+3],O=~~(E+h.height/2)*e.width*4+4*A,h.data[O]=m[4*A+0],h.data[1+O]=m[4*A+1],h.data[2+O]=m[4*A+2],h.data[3+O]=m[4*A+3]}d=r.createImageData(e.width,Math.floor(e.height/2)-Math.floor(a/2)+1),p=r.getImageData(0,Math.ceil(e.height/2)+Math.floor(a/2)-Math.floor(a/3)-1,e.width,1).data,m=c.data.slice(0,4*e.width);for(var I=0,L=d.height/2;I<L;I++)for(var D=0,R=e.width;D<R;D++){var H=I*e.width*4+4*D;d.data[H]=p[4*D+0],d.data[1+H]=p[4*D+1],d.data[2+H]=p[4*D+2],d.data[3+H]=p[4*D+3],H=~~(I+d.height/2)*e.width*4+4*D,d.data[H]=m[4*D+0],d.data[1+H]=m[4*D+1],d.data[2+H]=m[4*D+2],d.data[3+H]=m[4*D+3]}r.putImageData(h,0,Math.floor(a/3)),r.putImageData(d,0,e.height/2+Math.floor(a/2)-Math.floor(a/3))}F.div.insertBefore(e,i?F.div.firstElementChild:null)}},s={type:"atom",atomType:ze.INNER,nucleus:null,superscript:null,subscript:null,style:Oe,div:document.createElement("div")};He.push(s),Me.push(s),F.style=Oe,F.div=s.div,F.div.style.display="inline-block",F.div.style.whiteSpace="nowrap";var M=$e.heightOf("x",Ve)/2+$e.baselineHeightOf(Ve),r=document.createElement("div"),n=document.createElement("div");r.style.display=n.style.display="inline-block",r.style.verticalAlign="text-bottom",r.style.position="relative",n.style.verticalAlign="text-bottom",n.style.position="relative";var l="display"==Oe?"text":"text"==Oe?"script":"scriptscript";Ae(F.numerator,l,Ie,Le,r),Ae(F.denominator,l,!0,Le,n),r.firstElementChild.style.justifyContent="center",n.firstElementChild.style.justifyContent="center";var o="from font"==F.barWidth?new Ge(0,65536*$e.visibleWidthOf("|",Ve)):new Ge(F.barWidth);o.em.value+=o.sp.value/12*16/Ne,o.sp.value=0;var c="text"==Oe||"script"==Oe,h=c?Ue:1,d="".concat(o.em.value/65536,"em"),p="".concat(o.em.value*h/65536,"em"),m=o.em.value*("script"==Oe||"scriptscript"==Oe?Ue:1)/65536;Pe.appendChild(n),Pe.appendChild(r);var u=r.offsetWidth+1,f=r.offsetHeight/Ne,v=u*h,g=n.offsetHeight/Ne,t=n.offsetWidth+1,e=g*h,i=t*h;Pe.removeChild(n),Pe.removeChild(r),c?(r.style.fontSize=n.style.fontSize=_e,r.style.paddingTop="calc(".concat(M/Ue,"em + ").concat(d," / 2)"),r.style.top="calc(".concat(-M/Ue,"em - ").concat(d," / 2)"),n.style.top="calc(".concat(g-M/Ue,"em + ").concat(d," / 2 - ").concat(g,"em)"),F.div.style.paddingBottom="calc(".concat(e-M,"em + ").concat(p," / 2)")):(r.style.fontSize=n.style.fontSize="",r.style.paddingTop="calc(".concat(M,"em + ").concat(p," / 2)"),r.style.top="calc(".concat(-M,"em - ").concat(p," / 2)"),n.style.top="calc(".concat(g-M,"em + ").concat(p," / 2 - ").concat(g,"em)"),F.div.style.paddingBottom="calc(".concat(g-M,"em + ").concat(p," / 2)")),n.style.height=0;var s=t<u?n:r,l=t<u?r:n,o=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div");o.style.display="inline-block",o.style.position="relative",o.style.verticalAlign="text-bottom",o.style.top="".concat(-M,"em"),o.style.width=".05em",o.style.height=0,c.style.borderTop="".concat(p," solid currentColor"),c.style.padding="0 .05em",c.style.position="relative",c.style.top="calc(".concat(p," / -2)"),c.style.display="inline-block",c.style.height=0,d.style.display="inline-block",d.style.visibility="hidden",o.style.webkitUserSelect=o.style.mozUserSelect=o.style.msUserSelect=o.style.userSelect="none",d.style.width="".concat(Math.max(v,i)/Ne,"em"),c.appendChild(d),o.appendChild(c),F.div.appendChild(o);i=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),o=s.firstElementChild;o&&(o.style.width="100%",d.appendChild(o)),i.style.position="relative",i.style.display="inline-block",c.style.display="inline-block",c.style.height="".concat(t<u?g:f,"em"),c.textContent=" ",c.style.width="".concat((Math.max(u,t)+1)/Ne,"em"),d.style.position="absolute",s.style.width=0,d.style.left="".concat(-1/Ne,"em"),d.style.right="".concat(1/Ne,"em"),d.style.top=0,i.appendChild(d),i.appendChild(c),s.appendChild(i),F.div.appendChild(s),F.div.appendChild(l);s=document.createElement("div");s.style.display="inline-block",s.style.width=".05em",F.div.appendChild(s);var l=document.createElement("canvas"),s=document.createElement("canvas"),P="display"==Oe?2.416666666:"text"==Oe?1.416666666:0;l.style.display=s.style.display="inline-block",">"==F.delims[0]&&(F.delims[0]="⟩"),">"==F.delims[1]&&(F.delims[1]="⟩"),"<"==F.delims[0]&&(F.delims[0]="⟨"),"<"==F.delims[1]&&(F.delims[1]="⟨"),a(l,F.delims[0],!0,Ne),a(s,F.delims[1],!1,Ne);var a={display:{display:1,text:1,script:Ue,scriptscript:.5},text:{display:1,text:1,script:Ue,scriptscript:.5},script:{display:We,text:We,script:1,scriptscript:Ue},scriptscript:{display:2,text:2,script:We,scriptscript:1}}[Re.displayedStyle][Oe],s=$e.heightOf("x",Ve)/2;return F.div.renderedDepth=(e-s+m/2+(n.renderedDepth-n.baseline-n.baselineOffset)*h)*a,F.div.renderedHeight=(s+m/2+(r.baseline+r.baselineOffset+r.renderedHeight)*h)*a,F.div.baseline=n.baseline*a*h,F.div.baselineOffset=(e-s+m/2-n.baseline*h)*a,De=" ","continue"}if("table"==F.type){var y={type:"atom",atomType:ze.INNER,nucleus:null,superscript:null,subscript:null,style:Oe,div:document.createElement("div")};He.push(y),Me.push(y),F.style=Oe,F.div=y.div,F.div.style.display="inline-block",F.div.style.whiteSpace="nowrap";var b=document.createElement("table");b.style.borderCollapse="collapse",b.style.verticalAlign="middle",b.style.display="inline-table";for(var w,x=0,k=F.cellData.length;x<k;x++){F.noAligns[x]&&((w=document.createElement("td")).setAttribute("colspan",F.tabSkips.length-1),w.style.padding=0,Ae([F.noAligns[x]],Oe,!1,Le,w),b.appendChild(w),w.firstElementChild.style.width="100%",w.firstElementChild.style.justifyContent="");for(var S=document.createElement("tr"),E=0,C=F.cellData[x].length;E<C;E++){var A=document.createElement("td");A.setAttribute("colspan",F.cellData[x][E].span),A.style.padding=0,A.style.paddingLeft="".concat(F.tabSkips[E].start.em.value/65536+F.tabSkips[E].start.sp.value/65536/12,"em"),E==F.tabSkips.length-2&&(A.style.paddingRight="".concat(F.tabSkips[E+1].start.em.value/65536+F.tabSkips[E+1].start.sp.value/65536/12,"em")),Ae(F.cellData[x][E].content,Oe,!1,Le,A),S.appendChild(A),A.firstElementChild.style.width="100%",A.firstElementChild.style.justifyContent=""}b.appendChild(S)}return F.div.appendChild(b),Pe.appendChild(F.div),F.div.renderedHeight=F.div.offsetHeight/Ne/2+$e.heightOf("x",Ve)/2,F.div.renderedDepth=F.div.offsetHeight/Ne/2-$e.heightOf("x",Ve)/2,Pe.removeChild(F.div),"continue"}if("atom"==F.type||"box"==F.type&&"atom"==F.content.type){m=!1;"box"==F.type&&(F=(m=F).content);var T={display:{display:1,text:1,script:Ue,scriptscript:.5},text:{display:1,text:1,script:Ue,scriptscript:.5},script:{display:We,text:We,script:1,scriptscript:Ue},scriptscript:{display:2,text:2,script:We,scriptscript:1}}[Re.displayedStyle][Oe];if(([ze.OVER,ze.UNDER,ze.RAD].includes(F.atomType)&&(F.subscript||F.superscript)||F.atomType==ze.RAD&&1!=T)&&(F.nucleus=[{type:"atom",atomType:F.atomType,nucleus:F.nucleus,superscript:null,subscript:null,index:F.index,invalid:F.invalid,phantom:F.phantom}],F.atomType=ze.ORD),He.push(F),Me.push(F),F.style=Oe,F.div=document.createElement("div"),F.div.style.display="inline-block",F.div.style.whiteSpace="nowrap",F.div.renderedHeight=0,F.div.renderedDepth=-.5,F.div.baselineOffset=0,F.invalid){if(F.nucleus)if("symbol"==F.nucleus.type)F.nucleus.invalid=!0;else for(var O=F.nucleus.length-1;0<=O;O--)F.nucleus[O].invalid=!0;F.superscript&&(F.superscript[0].invalid=!0),F.subscript&&(F.subscript[0].invalid=!0)}![ze.ORD,ze.OP,ze.BIN,ze.REL,ze.OPEN,ze.CLOSE,ze.PUNCT,ze.INNER].includes(F.atomType)||!F.nucleus||1!=F.nucleus.length||F.nucleus[0].atomType!=ze.OP||F.nucleus[0].delimited||F.nucleus[0].limits||F.superscript||F.subscript||F.nucleus[0].nucleus&&("symbol"==F.nucleus[0].nucleus.type&&je["operator.growchars"][0].includes(F.nucleus[0].nucleus.char)||1==F.nucleus[0].nucleus.length&&F.nucleus[0].nucleus[0].atomType==ze.VARIABLE&&je["operator.growchars"][0].includes(F.nucleus[0].nucleus[0].nucleus[0].char))||(F.superscript=F.nucleus[0].superscript,F.subscript=F.nucleus[0].subscript,F.nucleus=F.nucleus[0].nucleus);var I,L,D,R,H,q,N,V,B,z,W,U,_,j,G,X,$,Y,K,Q,Z,J,ee,te,ie,ae,n=0;switch(F.nucleus&&"symbol"==F.nucleus.type?(10==F.nucleus.code?(F.isLineBreak=!0,F.div.style.width="100%"):(F.div.innerHTML='<div style="white-space:pre;display:inline-block;'.concat(F.nucleus.invalid?"color:".concat(je["invalid.color"][0],";"):"").concat({nm:F.atomType==ze.VARIABLE?'font-style:italic"><div style="display:inline-block;margin:0 '.concat($e.italCorrOf(F.nucleus.char,Ve),"em 0 ").concat($e.leftOffsetOf(F.nucleus.char,Ve,"it"),"em"):"",rm:"",bf:"font-weight:bold;",it:"font-style:italic;",sl:"font-style:oblique;"}[Le],'">').concat(45==F.nucleus.code?"−":F.nucleus.char,"</div>").concat("nm"==Le&&F.atomType==ze.VARIABLE?"</div>":""),I="nm"==Le?F.atomType==ze.VARIABLE?"it":"nm":Le,F.div.renderedHeight=$e.heightOf(F.nucleus.char,Ve,I)*T,F.div.renderedDepth=$e.trueDepthOf(F.nucleus.char,Ve,I)*T,F.div.baseline=$e.baselineHeightOf(Ve)*T,n=$e.scriptOffsetOf(F.nucleus.char,Ve,"nm"==Le&&F.atomType==ze.VARIABLE?"it":Le)),De=F.nucleus.char):Array.isArray(F.nucleus)&&(De=Ae(F.nucleus,Oe,Ie||F.atomType==ze.OVER||F.atomType==ze.RAD,Le,F.div)||De,F.div.renderedHeight*=T,F.div.renderedDepth*=T,F.div.baseline*=T,F.div.baselineOffset*=T,!F.div.firstElementChild.empty||F.superscript||F.subscript||F.delimited||[ze.RAD,ze.ACC,ze.OVER,ze.UNDER].includes(F.atomType)||(F.div.empty=!0)),F.phantom&&(F.div.firstElementChild.style.visibility="hidden"),F.div.style.fontSize="".concat(T,"em"),"display"==Oe&&F.atomType==ze.OP&&F.nucleus&&("symbol"==F.nucleus.type||1==F.nucleus.length&&F.nucleus[0].nucleus&&"symbol"==F.nucleus[0].nucleus.type&&F.nucleus[0].atomType==ze.VARIABLE)&&(H=1,je["operator.growchars"][0].includes(F.nucleus.char||F.nucleus[0].nucleus.char)&&(H=je["operator.growamount"][0],F.div.renderedHeight*=H,F.div.renderedDepth*=H,F.div.firstElementChild.style.fontSize="".concat(H,"em"),n*=H),N=$e.heightOf("x",Ve)/2,L=(F.div.renderedHeight-N-F.div.renderedDepth-N)/2,F.div.firstElementChild.style.top="".concat(L/H,"em"),F.div.renderedHeight-=L,F.div.renderedDepth+=L,F.div.firstElementChild.style.position="relative",F.div.firstElementChild.style.marginTop="".concat(-L/H,"em"),F.div.firstElementChild.style.marginBottom="".concat(L/H,"em")),F.delimited&&(q=function(e,t,i){var a,s,r,n,l,o,c,h=Fe(),d=$e.heightOf("x",Ve)/2,p=$e.leftOffsetOf(e,Ve),m=$e.visibleWidthOf(e,Ve),u=$e.depthOf(e,Ve),f=$e.heightOf(e,Ve),v=$e.baselineHeightOf(Ve),g=f+u,y=window.devicePixelRatio,b=document.createElement("img"),w=document.createElementNS("http://www.w3.org/2000/svg","svg"),x=document.createElement("canvas"),k=2*Math.max(F.div.renderedHeight-d,F.div.renderedDepth+d,g/2);switch(b.style.display="inline-block",b.style.verticalAlign="middle",b.style.height="".concat(k,"em"),b.style.width="".concat(m,"em"),b.style.marginLeft="".concat(-p,"em"),b.style.marginRight="".concat($e.widthOf(e,Ve)-m+p,"em"),w.setAttribute("preserveAspectRatio","none"),b.alt=e,w.style.display="inline-block",w.style.verticalAlign="middle",w.style.height="".concat(k,"em"),w.style.width="".concat(m,"em"),w.style.marginLeft="".concat(-p,"em"),w.style.marginRight="".concat($e.widthOf(e,Ve)-m+p," em"),F.div.renderedHeight=Math.max(k/2+d,F.div.renderedHeight),F.div.renderedDepth=Math.max(k/2-d,F.div.renderedDepth),b.width=x.width=Math.ceil(m/g*i*y),e){case"|":case"/":case"\\":case"‖":case"⎪":case"⏐":case"⟨":case"⟩":default:o=i*y,c=m/g*i*y,w.setAttribute("viewBox","0 0 ".concat(c," ").concat(o)),w.innerHTML='\n                    <text\n                      fill="currentColor"\n                      y="'.concat((1-u/g)*i*y,'"\n                      x="').concat(p*i*y,'"\n                      font-size="').concat(i/g*y,'"\n                    >').concat(e,"</text>\n                  "),F.div.insertBefore(w,t?F.div.firstElementChild:null);break;case"(":case")":if(!(Math.floor(Math.floor(i/2*k)-i)<=0)){o=i*k*y,c=m/g*i*y,w.setAttribute("viewBox","0 0 ".concat(c," ").concat(o));var S=i/g*y,E=o-2*(g*S-1);w.innerHTML='\n                      <mask id="mask-'.concat(h,'-1">\n                        <rect\n                          fill="white"\n                          x="0"\n                          y="').concat(u*S-g*S,'"\n                          width="').concat(c,'"\n                          height="').concat((g*S-1)/2,'"\n                        />\n                      </mask>\n                      <mask id="mask-').concat(h,'-2">\n                        <rect\n                          fill="white"\n                          x="0"\n                          y="').concat(u*S-g*S/2+.5,'"\n                          width="').concat(c,'"\n                          height="').concat((g*S-1)/2,'"\n                        />\n                      </mask>\n                      <mask id="mask-').concat(h,'-3">\n                        <rect\n                          fill="white"\n                          x="0"\n                          y="').concat(u*S-g*i*y/2-.5,'"\n                          width="').concat(c,'"\n                          height="').concat(1,'"\n                        />\n                      </mask>\n                      \x3c!-- ').concat(g," ").concat(i,' --\x3e\n                      <text\n                        fill="currentColor"\n                        transform="matrix(1,0,0,2,0,').concat(2*f*S,')"\n                        mask="url(#mask-').concat(h,'-1)"\n                        y="0"\n                        x="').concat(p*i*y,'"\n                        font-size="').concat(S,'"\n                      >').concat(e,'</text>\n                      <text\n                        fill="currentColor"\n                        transform="matrix(1,0,0,2,0,').concat(o-2*v*S,')"\n                        mask="url(#mask-').concat(h,'-2)"\n                        y="0"\n                        x="').concat(p*i*y,'"\n                        font-size="').concat(S,'"\n                      >').concat(e,'</text>\n                      <text\n                        fill="currentColor"\n                        transform="matrix(1,0,0,').concat(E,",0,").concat(o-E*v*S,')"\n                        mask="url(#mask-').concat(h,'-3)"\n                        y="0"\n                        x="').concat(p*i*y,'"\n                        font-size="').concat(i/g*y,'"\n                      >').concat(e,"</text>\n                    "),F.div.insertBefore(w,t?F.div.firstElementChild:null);break}o=i*k*y,c=m/g*i*y,w.setAttribute("viewBox","0 0 ".concat(c," ").concat(o)),w.innerHTML='\n                    <text\n                      fill="currentColor"\n                      transform="matrix(1,0,0,'.concat(o/(g*i*y),',0,0)"\n                      mask="url(#mask-').concat(h,'-1)"\n                      y="').concat((1-u/g)*i*y,'"\n                      x="').concat(p*i*y,'"\n                      font-size="').concat(i/g*y,'"\n                    >').concat(e,"</text>\n                    "),F.div.insertBefore(w,t?F.div.firstElementChild:null);break;case"[":case"]":case"⟮":case"⟯":case"↑":case"↓":case"↕":case"⇑":case"⇓":case"⇕":case"⌈":case"⌉":case"⌊":case"⌋":case"⎰":case"⎱":if(b.height=x.height=i*k*y,(l=x.getContext("2d")).fillStyle=qe.color,l.font="".concat(i/g*y,"px ").concat(Ve),l.fillText(e,Math.round(p*i*y),(.5-u/g)*i*y),s=l.getImageData(0,0,x.width,i/2*y),l.clearRect(0,0,x.width,x.height),l.fillText(e,Math.round(p*i*y),(1-u/g)*i*y),l.clearRect(0,i/2*y,x.width,x.height),l.putImageData(s,0,x.height-i/2*y),x.height>i){a=l.createImageData(x.width,x.height-i*y),r=l.getImageData(0,i/2*y-1,x.width,1).data,n=s.data.slice(0,4*x.width);for(var C=0,A=a.height/2;C<A;C++)for(var T=0,O=x.width;T<O;T++){var I=C*x.width*4+4*T;a.data[I]=r[4*T+0],a.data[1+I]=r[4*T+1],a.data[2+I]=r[4*T+2],a.data[3+I]=r[4*T+3],I=~~(C+a.height/2)*x.width*4+4*T,a.data[I]=n[4*T+0],a.data[1+I]=n[4*T+1],a.data[2+I]=n[4*T+2],a.data[3+I]=n[4*T+3]}l.putImageData(a,0,i/2*y)}b.src=x.toDataURL("image/png",1),F.div.insertBefore(b,t?F.div.firstElementChild:null);break;case"{":case"}":if(b.height=x.height=i*k*y,(l=x.getContext("2d")).fillStyle=qe.color,l.font="".concat(i/g*y,"px ").concat(Ve),l.fillText(e,Math.round(p*i*y),(1/3-u/g)*i*y),s=l.getImageData(0,0,x.width,i/3*y),l.clearRect(0,0,x.width,x.height),l.fillText(e,Math.round(p*i*y),(1-u/g)*i*y),o=l.getImageData(0,0,x.width,i/3*y),l.clearRect(0,0,x.width,x.height),l.fillText(e,Math.round(p*i*y),(.5-u/g)*i*y+x.height/2),l.clearRect(0,0,x.width,Math.floor(x.height/2-i/6*y)),l.clearRect(0,Math.ceil(x.height/2+i/6*y),x.width,x.height),l.putImageData(o,0,0),l.putImageData(s,0,x.height-i/3*y),x.height>i){a=l.createImageData(x.width,(x.height-i*y)/2),r=o.data.slice(o.data.length-4*x.width),n=l.getImageData(0,Math.floor(x.height/2-i/6*y),x.width,1).data;for(var L=0,D=a.height/2;L<D;L++)for(var R=0,H=x.width;R<H;R++){var M=L*x.width*4+4*R;a.data[M]=r[4*R+0],a.data[1+M]=r[4*R+1],a.data[2+M]=r[4*R+2],a.data[3+M]=r[4*R+3],M=~~(L+a.height/2)*x.width*4+4*R,a.data[M]=n[4*R+0],a.data[1+M]=n[4*R+1],a.data[2+M]=n[4*R+2],a.data[3+M]=n[4*R+3]}l.putImageData(a,0,i/3*y),a=l.createImageData(x.width,(x.height-i*y)/2),r=l.getImageData(0,Math.ceil(x.height/2+i/6*y)-1,x.width,1).data,n=s.data.slice(0,4*x.width);for(var P=0,q=a.height/2;P<q;P++)for(var N=0,V=x.width;N<V;N++){var B=P*x.width*4+4*N;a.data[B]=r[4*N+0],a.data[1+B]=r[4*N+1],a.data[2+B]=r[4*N+2],a.data[3+B]=r[4*N+3],B=~~(P+a.height/2)*x.width*4+4*N,a.data[B]=n[4*N+0],a.data[1+B]=n[4*N+1],a.data[2+B]=n[4*N+2],a.data[3+B]=n[4*N+3]}l.putImageData(a,0,Math.ceil(x.height/2+i/6*y))}b.src=x.toDataURL("image/png",1),F.div.insertBefore(b,t?F.div.firstElementChild:null)}},"."==F.delims[0]?He.splice(He.length-1,0,{type:"kern",dimen:F.nullDelimiterSpace}):(">"==F.delims[0]&&(F.delims[0]="⟩"),"<"==F.delims[0]&&(F.delims[0]="⟨"),q(F.delims[0],!0,Ne)),"."==F.delims[1]?He.splice(He.length,0,{type:"kern",dimen:F.nullDelimiterSpace}):(">"==F.delims[1]&&(F.delims[1]="⟩"),"<"==F.delims[1]&&(F.delims[1]="⟨"),q(F.delims[1],!1,Ne))),(F.superscript||F.subscript)&&(F.atomType==ze.OP&&F.limits?(h=F.div.firstElementChild,Pe.appendChild(F.div),a=F.div.offsetWidth+1,Pe.removeChild(F.div),F.subscript&&!F.superscript?(F.div.renderedDepth=Math.max(F.div.renderedDepth,0),(y=document.createElement("div")).style.display="inline-block",y.style.verticalAlign="text-bottom",y.style.position="relative",(I=document.createElement("div")).innerText=" ",I.style.verticalAlign="text-top",I.style.display="inline-block",I.style.width=0,Ae(F.subscript,"display"==Oe||"text"==Oe?"script":"scriptscript",!0,Le,y),y.style.fontSize="scriptscript"==Oe?F.div.style.fontSize:"calc(".concat(F.div.style.fontSize," * ").concat(Ue,")"),Pe.appendChild(y),N=y.offsetWidth+1,y.style.fontSize="50px",L=y.offsetHeight/50,Pe.removeChild(y),"scriptscript"==Oe?(y.style.fontSize="",y.style.top="".concat(-y.baseline-y.baselineOffset-F.div.renderedDepth,"em"),I.style.paddingBottom="".concat(L-F.div.baseline+F.div.baselineOffset+F.div.renderedDepth,"em")):(y.style.fontSize=_e,y.style.top=(-F.div.baseline-F.div.baselineOffset+F.div.renderedDepth)/Ue+"em",I.style.paddingBottom=L*Ue-F.div.baseline-F.div.baselineOffset+F.div.renderedDepth+"em"),y.style.height=0,N<a?(D=y.firstElementChild,R=h,F.div.insertBefore(y,h),y.style.width=0):(D=h,R=y.firstElementChild,F.div.appendChild(y)),(H=document.createElement("div")).style.display="inline-block",H.style.position="relative",(q=document.createElement("div")).style.display="inline-block",q.style.width=0,q.style.visibility="hidden",q.style.webkitUserSelect=q.style.mozUserSelect=q.style.msUserSelect=q.style.userSelect="none",q.appendChild(Be(D.cloneNode(!0))),H.appendChild(q),(q=document.createElement("div")).style.position="absolute",q.style.left=q.style.right=0,q.style.textAlign="center",q.style.display="inline-block",q.appendChild(D),H.appendChild(q),H.style.width="".concat(Math.max(N,a)/Ne/("scriptscript"!=Oe&&R==h?Ue:1),"em"),N<a?y.appendChild(H):((N=document.createElement("div")).style.display="inline-block",N.style.width=0,N.appendChild(H),F.div.insertBefore(N,y)),F.div.insertBefore(I,F.div.firstElementChild),F.div.renderedDepth+=(L*("scriptscript"==Oe?1:Ue)-y.baseline-y.baselineOffset+y.renderedDepth)*T):F.superscript&&!F.subscript?((_=document.createElement("div")).style.display="inline-block",_.style.verticalAlign="text-bottom",Ae(F.superscript,"display"==Oe||"text"==Oe?"script":"scriptscript",Ie,Le,_),_.style.fontSize="scriptscript"==Oe?F.div.style.fontSize:"calc(".concat(F.div.style.fontSize," * ").concat(Ue,")"),Pe.appendChild(_),$=_.offsetWidth+1,_.style.fontSize="50px",_.offsetHeight,Pe.removeChild(_),"scriptscript"==Oe?(_.style.fontSize="",_.style.marginBottom="".concat(F.div.baseline+F.div.baselineOffset+F.div.renderedHeight,"em")):(_.style.fontSize=_e,_.style.marginBottom="".concat((F.div.baseline+F.div.baselineOffset+F.div.renderedHeight)/Ue,"em")),$<a?(V=_.firstElementChild,z=h,F.div.insertBefore(_,h),_.style.width=0):(V=h,z=_.firstElementChild,F.div.appendChild(_)),(W=document.createElement("div")).style.display="inline-block",W.style.position="relative",(B=document.createElement("div")).style.display="inline-block",B.style.width=0,B.style.visibility="hidden",B.style.webkitUserSelect=B.style.mozUserSelect=B.style.msUserSelect=B.style.userSelect="none",B.appendChild(Be(V.cloneNode(!0))),W.appendChild(B),(B=document.createElement("div")).style.position="absolute",B.style.left=B.style.right=0,B.style.textAlign="center",B.style.display="inline-block",B.appendChild(V),W.appendChild(B),W.style.width="".concat(Math.max($,a)/Ne/("scriptscript"!=Oe&&z==h?Ue:1),"em"),$<a?_.appendChild(W):((U=document.createElement("div")).style.display="inline-block",U.style.width=0,U.appendChild(W),F.div.insertBefore(U,_)),F.div.renderedHeight+=(_.baseline+_.baselineOffset+_.renderedHeight)*("scriptscript"==Oe?1:Ue)*T):F.superscript&&F.subscript&&(F.div.renderedDepth=Math.max(F.div.renderedDepth,0),(V=document.createElement("div")).style.display="inline-block",V.style.verticalAlign="text-bottom",V.style.position="relative",Ae(F.subscript,"display"==Oe||"text"==Oe?"script":"scriptscript",!0,Le,V),V.style.fontSize="scriptscript"==Oe?F.div.style.fontSize:"calc(".concat(F.div.style.fontSize," * ").concat(Ue,")"),Pe.appendChild(V),B=V.offsetWidth+1,V.style.fontSize="50px",z=V.offsetHeight/50,Pe.removeChild(V),(K=document.createElement("div")).style.display="inline-block",K.style.verticalAlign="text-bottom",K.style.position="relative",Ae(F.superscript,"display"==Oe||"text"==Oe?"script":"scriptscript",Ie,Le,K),K.style.fontSize="scriptscript"==Oe?F.div.style.fontSize:"calc(".concat(F.div.style.fontSize," * ").concat(Ue,")"),Pe.appendChild(K),$=K.offsetWidth+1,K.style.fontSize="50px",K.offsetHeight,Pe.removeChild(K),(W=document.createElement("div")).innerText=" ",W.style.verticalAlign="text-top",W.style.display="inline-block",W.style.width=0,"scriptscript"==Oe?(V.style.fontSize=K.style.fontSize="",V.style.top="".concat(-V.baseline-V.baselineOffset-F.div.renderedDepth,"em"),W.style.paddingBottom="".concat(height-F.div.baseline+F.div.baselineOffset+F.div.renderedDepth,"em"),K.style.marginBottom="".concat(F.div.baseline+F.div.baselineOffset+F.div.renderedHeight,"em")):(V.style.fontSize=K.style.fontSize=_e,V.style.top="".concat((-F.div.baseline-F.div.baselineOffset+F.div.renderedDepth)/Ue,"em"),W.style.paddingBottom="".concat(z*Ue-F.div.baseline+F.div.baselineOffset+F.div.renderedDepth,"em"),K.style.marginBottom="".concat((F.div.baseline+F.div.baselineOffset+F.div.renderedHeight)/Ue,"em")),V.style.height=0,B<=$&&a<=$?(F.div.insertBefore(V,h),F.div.appendChild(K),V.style.width=0,G=document.createElement("div"),j=document.createElement("div"),G.style.display=j.style.display="inline-block",G.style.position=j.style.position="relative",U=document.createElement("div"),_=document.createElement("div"),U.style.display=_.style.display="inline-block",U.style.width=_.style.width=0,U.style.visibility=_.style.visibility="hidden",U.style.webkitUserSelect=U.style.mozUserSelect=U.style.msUserSelect=U.style.userSelect=_.style.webkitUserSelect=_.style.mozUserSelect=_.style.msUserSelect=_.style.userSelect="none",U.appendChild(Be(V.firstElementChild.cloneNode(!0))),_.appendChild(Be(h.cloneNode(!0))),G.appendChild(U),j.appendChild(_),U=document.createElement("div"),_=document.createElement("div"),U.style.position=_.style.position="absolute",U.style.left=U.style.right=0,_.style.left=_.style.right=0,U.style.textAlign=_.style.textAlign="center",U.style.display=_.style.display="inline-block",U.appendChild(V.firstElementChild),_.appendChild(h),G.appendChild(U),j.appendChild(_),G.style.width="".concat($/Ne/("scriptscript"!=Oe?Ue:1),"em"),j.style.width="".concat($/Ne,"em"),V.appendChild(G),(G=document.createElement("div")).style.display="inline-block",G.style.width=0,G.appendChild(j),F.div.insertBefore(G,K)):B<=a&&$<=a?(F.div.insertBefore(V,h),F.div.insertBefore(K,h),V.style.width=K.style.width=0,Y=document.createElement("div"),X=document.createElement("div"),Y.style.display=X.style.display="inline-block",Y.style.position=X.style.position="relative",j=document.createElement("div"),G=document.createElement("div"),j.style.display=G.style.display="inline-block",j.style.width=G.style.width=0,j.style.visibility=G.style.visibility="hidden",j.style.webkitUserSelect=j.style.mozUserSelect=j.style.msUserSelect=j.style.userSelect=G.style.webkitUserSelect=G.style.mozUserSelect=G.style.msUserSelect=G.style.userSelect="none",j.appendChild(Be(V.firstElementChild.cloneNode(!0))),G.appendChild(Be(K.firstElementChild.cloneNode(!0))),Y.appendChild(j),X.appendChild(G),j=document.createElement("div"),G=document.createElement("div"),j.style.position=G.style.position="absolute",j.style.left=j.style.right=0,G.style.left=G.style.right=0,j.style.textAlign=G.style.textAlign="center",j.style.display=G.style.display="inline-block",j.appendChild(V.firstElementChild),G.appendChild(K.firstElementChild),Y.appendChild(j),X.appendChild(G),Y.style.width="".concat(a/Ne/("scriptscript"!=Oe?Ue:1),"em"),X.style.width="".concat(a/Ne/("scriptscript"!=Oe?Ue:1),"em"),V.appendChild(Y),K.appendChild(X)):a<=B&&$<=B&&(F.div.insertBefore(K,h),F.div.appendChild(V),K.style.width=0,Y=document.createElement("div"),X=document.createElement("div"),Y.style.display=X.style.display="inline-block",Y.style.position=X.style.position="relative",a=document.createElement("div"),$=document.createElement("div"),a.style.display=$.style.display="inline-block",a.style.width=$.style.width=0,a.style.visibility=$.style.visibility="hidden",a.style.webkitUserSelect=a.style.mozUserSelect=a.style.msUserSelect=a.style.userSelect=$.style.webkitUserSelect=$.style.mozUserSelect=$.style.msUserSelect=$.style.userSelect="none",a.appendChild(Be(K.firstElementChild.cloneNode(!0))),$.appendChild(Be(h.cloneNode(!0))),Y.appendChild(a),X.appendChild($),a=document.createElement("div"),$=document.createElement("div"),a.style.position=$.style.position="absolute",a.style.left=a.style.right=0,$.style.left=$.style.right=0,a.style.textAlign=$.style.textAlign="center",a.style.display=$.style.display="inline-block",a.appendChild(K.firstElementChild),$.appendChild(h),Y.appendChild(a),X.appendChild($),Y.style.width="".concat(B/Ne/("scriptscript"!=Oe?Ue:1),"em"),X.style.width="".concat(B/Ne,"em"),K.appendChild(Y),(Y=document.createElement("div")).style.display="inline-block",Y.style.width=0,Y.appendChild(X),F.div.insertBefore(Y,V)),F.div.insertBefore(W,F.div.firstElementChild),F.div.renderedDepth+=(z*("scriptscript"==Oe?1:Ue)-V.baseline-V.baselineOffset+V.renderedDepth)*T,F.div.renderedHeight+=(K.baseline+K.baselineOffset+K.renderedHeight)*("scriptscript"==Oe?1:Ue)*T)):F.subscript&&!F.superscript?((Z=document.createElement("div")).style.display="inline-block",Z.style.verticalAlign="text-bottom",Z.style.position="relative",(ee=document.createElement("div")).style.verticalAlign="text-top",ee.textContent=" ",ee.style.display="inline-block",ee.style.width=0,Ae(F.subscript,"display"==Oe||"text"==Oe?"script":"scriptscript",!0,Le,Z),Z.style.fontSize="50px",Pe.appendChild(Z),Q=Z.offsetHeight/50,Pe.removeChild(Z),"scriptscript"==Oe?(Z.style.fontSize="",Z.style.top="".concat(Math.max(Z.baseline,Z.renderedDepth)-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T+.2,Z.renderedHeight-$e.heightOf("x",Ve))-Q,"em"),ee.style.paddingBottom="".concat(Math.max(Z.baseline,Z.renderedDepth)-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T+.2,Z.renderedHeight-$e.heightOf("x",Ve))-Q,"em")):(Z.style.fontSize=_e,Z.style.top="".concat(Math.max(Z.baseline,Z.renderedDepth)-$e.baselineHeightOf(Ve)/Ue+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,Z.renderedHeight-$e.heightOf("x",Ve))-Q,"em"),ee.style.paddingBottom="".concat(Math.max(Z.baseline,Z.renderedDepth)*Ue-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,Z.renderedHeight-$e.heightOf("x",Ve))*Ue,"em"),F.div.renderedDepth=Math.max(F.div.renderedDepth,(Z.renderedDepth*Ue+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,Z.renderedHeight-$e.heightOf("x",Ve))*Ue)*T)),Z.style.height=0,F.div.appendChild(Z),F.div.insertBefore(ee,Z)):F.superscript&&!F.subscript?(J=document.createElement("div"),Ae(F.superscript,"display"==Oe||"text"==Oe?"script":"scriptscript",Ie,Le,J),J.style.display="inline-block",J.style.verticalAlign="text-bottom",J.style.position="relative","scriptscript"==Oe?(J.style.top="".concat(Math.max(J.baseline,J.renderedDepth)-$e.baselineHeightOf(Ve)-Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)),"em"),J.style.paddingTop="".concat(-Math.max(J.baseline,J.renderedDepth)+$e.baselineHeightOf(Ve)+Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)),"em"),F.div.renderedHeight=Math.max(F.div.renderedHeight,(J.renderedHeight+Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)))*T)):(J.style.fontSize=_e,J.style.top="".concat(Math.max(J.baseline,J.renderedDepth)-$e.baselineHeightOf(Ve)/Ue-Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)),"em"),J.style.paddingTop="".concat(-Math.max(J.baseline,J.renderedDepth)+$e.baselineHeightOf(Ve)/Ue+Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)),"em"),F.div.renderedHeight=Math.max(F.div.renderedHeight,(J.renderedHeight+Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-J.renderedHeight,J.renderedDepth+(Ie?.9:1)*$e.heightOf("x",Ve)))*Ue*T)),F.div.appendChild(J)):F.subscript&&F.superscript&&(K=document.createElement("div"),Q=document.createElement("div"),K.style.display="inline-block",Q.style.verticalAlign="text-top",Q.innerText=" ",Q.style.display="inline-block",Q.style.width=0,Ae(F.subscript,"display"==Oe||"text"==Oe?"script":"scriptscript",!0,Le,K),K.style.fontSize="50px",Pe.appendChild(K),ee={height:K.offsetHeight,width:K.offsetWidth+1},Pe.removeChild(K),(Z=document.createElement("div")).style.display="inline-block",Ae(F.superscript,"display"==Oe||"text"==Oe?"script":"scriptscript",Ie,Le,Z),Z.style.fontSize="50px",Pe.appendChild(Z),J={height:Z.offsetHeight,width:Z.offsetWidth+1},Pe.removeChild(Z),ie=ee.width<J.width+n*Ne?K:Z,ae=ee.width<J.width+n*Ne?Z:K,J=J.height/50,ee=ee.height/50,Z.style.marginLeft="".concat(n,"em"),ie==Z&&(Z.style.marginRight="".concat(-n,"em")),K.style.verticalAlign=Z.style.verticalAlign="text-bottom",Z.style.position=K.style.position="relative",n=$e.heightOf("x",Ve),"scriptscript"==Oe?(K.style.fontSize=Z.style.fontSize="",Z.style.top="".concat(Math.max(Z.baseline,Z.renderedDepth)-$e.baselineHeightOf(Ve)-Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n),"em"),Z.style.paddingTop="".concat(-Math.max(Z.baseline,Z.renderedDepth)+$e.baselineHeightOf(Ve)+Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n),"em"),F.div.renderedHeight=Math.max(F.div.renderedHeight,(Z.renderedHeight+Math.max(F.div.renderedHeight/T+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n))*T),K.style.top="".concat(Math.max(K.baseline,K.renderedDepth)-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T+.2,K.renderedHeight-.8*n)-ee,"em"),Q.style.paddingBottom="".concat(Math.max(K.baseline,K.renderedDepth)-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T+.2,K.renderedHeight-.8*n)-J,"em"),F.div.renderedDepth=Math.max(F.div.renderedDepth,(K.renderedDepth+Math.max(Math.max(F.div.renderedDepth,0)/T+.2,K.renderedHeight-.8*n))*T)):(K.style.fontSize=Z.style.fontSize=_e,Z.style.top="".concat(Math.max(Z.baseline,Z.renderedDepth)-$e.baselineHeightOf(Ve)/Ue-Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n),"em"),Z.style.paddingTop="".concat(-Math.max(Z.baseline,Z.renderedDepth)+$e.baselineHeightOf(Ve)/Ue+Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n),"em"),F.div.renderedHeight=Math.max(F.div.renderedHeight,(Z.renderedHeight+Math.max(F.div.renderedHeight/T/Ue+(Ie?.1:.2)-Z.renderedHeight,Z.renderedDepth+(Ie?.9:1)*n))*Ue*T),K.style.top="".concat(Math.max(K.baseline,K.renderedDepth)-$e.baselineHeightOf(Ve)/Ue+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,K.renderedHeight-.8*n)-ee,"em"),Q.style.paddingBottom="".concat(Math.max(K.baseline,K.renderedDepth)*Ue-$e.baselineHeightOf(Ve)+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,K.renderedHeight-.8*n)*Ue,"em"),F.div.renderedDepth=Math.max(F.div.renderedDepth,(K.renderedDepth*Ue+Math.max(Math.max(F.div.renderedDepth,0)/T/Ue+.2,K.renderedHeight-.8*n)*Ue)*T)),K.style.height=0,ie.style.width=0,F.div.appendChild(Q),F.div.appendChild(ie),F.div.appendChild(ae))),m&&("horizontal"==m.boxType?(m.to?((te=new Ge(m.to)).em.value+=te.sp.value/12*16/Ne,te.sp.value=0):m.spread&&((te=new Ge(m.spread)).em.value+=te.sp.value/12*16/Ne,te.sp.value=0,ie=F.div.style.fontSize,F.div.style.fontSize="50px",Pe.appendChild(F.div),ae=(F.div.offsetWidth+1)/50,Pe.removeChild(F.div),F.div.style.fontSize=ie,te.em.value+=65536*ae),te.em.value<0?(He.splice(He.length-1,0,{type:"kern",dimen:te}),F.div.firstElementChild.style.width="0.0001px"):0==te.em.value?F.div.firstElementChild.style.width="0.0001px":F.div.firstElementChild.style.width="".concat(te.em.value/65536,"em"),F.div.firstElementChild.style.flexWrap=""):"vertical"==m.boxType&&(m.to?((Ee=new Ge(m.to)).em.value+=Ee.sp.value/12*16/Ne,Ee.sp.value=0):m.spread&&((Ee=new Ge(m.spread)).em.value+=Ee.sp.value/12*16/Ne,Ee.sp.value=0,ke=F.div.style.fontSize,F.div.style.fontSize="50px",Pe.appendChild(F.div),Se=F.div.offsetHeight/50,Pe.removeChild(F.div),F.div.style.fontSize=ke,Ee.em.value+=65536*Se),Ee.em.value<0?(F.div.firstElementChild.style.height=0,F.div.firstElementChild.style.verticalAlign="text-bottom",F.div.firstElementChild.style.position="relative",F.div.firstElementChild.style.top="".concat(-Ee.em.value/65536,"em"),F.div.renderedHeight=0,F.div.renderedDepth=0):(F.div.firstElementChild.style.height="".concat(Ee.em.value/65536,"em"),F.div.firstElementChild.style.verticalAlign="text-bottom",Ce=$e.baselineHeightOf(Ve),F.div.renderedDepth=Math.min(Ce,Ee.em.value/65536),F.div.renderedHeight=Math.max(Ee.em.value/65536-Ce,0)),F.div.firstElementChild.style.flexWrap=""),F.div.firstElementChild.style.justifyContent="initial"),F.atomType){case ze.OVER:F.div.renderedHeight=Math.max(F.div.renderedHeight||0,$e.heightOf("x",Ve)/2),fe=$e.visibleWidthOf("|",Ve),(ue=document.createElement("div")).style.display="inline-block",ue.style.width=ue.style.height=0,ue.style.position="relative",ue.style.top="".concat(-$e.baselineHeightOf(Ve)-F.div.renderedHeight/T-fe-.12,"em"),ue.style.verticalAlign="text-bottom",ue.style.pointerEvents="none",(ce=document.createElement("div")).style.display="inline-block",ce.style.webkitUserSelect=ce.style.mozUserSelect=ce.style.msUserSelect=ce.style.userSelect="none",ce.style.position="relative",(pe=document.createElement("div")).style.position="absolute",pe.style.left=pe.style.right=0,pe.style.borderTop="".concat(fe,"em solid currentColor"),ce.appendChild(pe),(ve=Be(F.div.cloneNode(!0))).style.visibility="hidden",ve.style.fontSize="",ce.appendChild(ve),ue.appendChild(ce),F.div.insertBefore(ue,F.div.firstElementChild),(ye=document.createElement("div")).style.height="".concat(F.div.renderedHeight/T+fe+.16,"em"),ye.style.display="inline-block",ye.style.width=0,F.div.insertBefore(ye,ue),F.div.renderedHeight+=fe+.16;break;case ze.UNDER:F.div.renderedDepth=Math.max(F.div.renderedDepth||0,0),fe=$e.visibleWidthOf("|",Ve),(ue=document.createElement("div")).style.display="inline-block",ue.style.width=ue.style.height=0,ue.style.position="relative",ue.style.top="".concat(-$e.baselineHeightOf(Ve)+F.div.renderedDepth/T+.12,"em"),ue.style.verticalAlign="text-bottom",ue.style.pointerEvents="none",(ce=document.createElement("div")).style.display="inline-block",ce.style.webkitUserSelect=ce.style.mozUserSelect=ce.style.msUserSelect=ce.style.userSelect="none",ce.style.position="relative",(oe=document.createElement("div")).style.position="absolute",oe.style.left=oe.style.right=0,oe.style.borderTop="".concat(fe,"em solid currentColor"),ce.appendChild(oe),(ve=Be(F.div.cloneNode(!0))).style.visibility="hidden",ve.style.fontSize="",ve.style.height=0,ce.appendChild(ve),ue.appendChild(ce),F.div.insertBefore(ue,F.div.firstElementChild),(ye=document.createElement("div")).style.verticalAlign="text-top",ye.innerText=" ",ye.style.paddingBottom="".concat(fe+.16-$e.baselineHeightOf(Ve)+F.div.renderedDepth/T,"em"),ye.style.display="inline-block",ye.style.width=0,F.div.insertBefore(ye,ue),F.div.renderedDepth+=fe+.16;break;case ze.ACC:var se=document.createElement("div");se.style.display="inline-block",se.style.position="relative","it"==Le?se.style.fontStyle="italic":"sl"==Le?se.style.fontStyle="oblique":"bf"==Le&&(se.style.fontWeight="bold"),se.style.top="".concat(Math.min($e.heightOf("x",Ve),F.div.renderedHeight)-F.div.renderedHeight,"em"),se.style.width=0,se.style.lineHeight=1.1,se.style.height="1.1em",se.style.verticalAlign="text-bottom",se.textContent=F.accChar,he=(he=!F.nucleus||"symbol"!=F.nucleus.type||"it"!=Le&&"sl"!=Le?0:$e.italCorrOf(F.accChar,Ve))||(F.nucleus&&1==F.nucleus.length&&F.nucleus[0].nucleus&&"symbol"==F.nucleus[0].nucleus.type&&F.nucleus[0].atomType==ze.VARIABLE&&"nm"==Le?$e.italCorrOf(F.accChar,Ve):0);var re=F.div.style.fontSize;F.div.style.fontSize="50px",Pe.appendChild(F.div),se.style.left="".concat(((F.div.offsetWidth+1)/50-$e.widthOf(F.accChar,Ve,Le))/2+he,"em"),Pe.removeChild(F.div),F.div.style.fontSize=re,F.div.insertBefore(se,F.div.firstElementChild);var ne=document.createElement("div");ne.style.display="inline-block",ne.style.width=0,ne.style.height="".concat(F.div.renderedHeight-Math.min($e.heightOf("x",Ve),F.div.renderedHeight)+$e.heightOf(F.accChar,Ve,Le),"em"),F.div.insertBefore(ne,se),F.div.renderedHeight=F.div.renderedHeight-Math.min($e.heightOf("x",Ve),F.div.renderedHeight)+$e.heightOf(F.accChar,Ve,Le);break;case ze.VCENT:var le=$e.heightOf("x",Ve)/2;he=F.div.renderedHeight-le-(F.div.renderedDepth+le),F.div.style.position="relative",F.div.style.top="".concat(he/2,"em"),F.div.style.marginTop="".concat(-he/2,"em"),F.div.style.marginBottom="".concat(he/2,"em"),F.div.renderedHeight-=he/2,F.div.renderedDepth+=he/2;break;case ze.RAD:fe=$e.visibleWidthOf("|",Ve),F.div.renderedHeight=Math.max(F.div.renderedHeight||0,$e.heightOf("x",Ve)/2),F.div.renderedDepth=Math.max(F.div.renderedDepth||0,0),Pe.appendChild(F.div),de=(F.div.offsetWidth+1)/Ne,Pe.removeChild(F.div),(ue=document.createElement("div")).style.display="inline-block",ue.style.width=ue.style.height=0,ue.style.position="relative",ue.style.top="".concat(-$e.baselineHeightOf(Ve)-F.div.renderedHeight/T-fe-.12,"em"),ue.style.verticalAlign="text-bottom",ue.style.pointerEvents="none",(me=document.createElement("div")).style.display="inline-block",me.style.webkitUserSelect=me.style.mozUserSelect=me.style.msUserSelect=me.style.userSelect="none",me.style.position="relative",me.style.width="".concat(de,"em"),(pe=document.createElement("div")).style.position="absolute",pe.style.left=pe.style.right=0,pe.style.borderTop="".concat(fe,"em solid currentColor"),me.appendChild(pe),me.appendChild(document.createTextNode(" ")),ue.appendChild(me),F.div.insertBefore(ue,F.div.firstElementChild),(ye=document.createElement("div")).style.height="".concat(F.div.renderedHeight/T+fe+.16,"em"),ye.style.display="inline-block",ye.style.width=0,F.div.insertBefore(ye,ue),F.div.renderedHeight+=(fe+.16)*T;var oe,ce,he,de,pe,me,ue,fe,ve,ge,ye,be=document.createElement("canvas"),we=0,xe=0;je["radical.build"][0]?(be.height=(F.div.renderedDepth+F.div.renderedHeight)*Ne,be.style.height="".concat(F.div.renderedDepth+F.div.renderedHeight,"em"),be.style.position="relative",be.style.top="".concat(F.div.renderedDepth,"em"),be.style.marginLeft=".1em",be.style.marginTop="".concat(-F.div.renderedDepth,"em"),oe=fe,ve=F.div.renderedHeight+F.div.renderedDepth-.04-oe/2,ce=je["radical.w"][0],re=Math.max(0,Math.min(ce,je["radical.t"][0])),ne=Math.max(0,je["radical.h"][0]),se=ve/Math.max(0,je["radical.verticalthreshold"][0]),le=Math.sqrt(se),ge=Math.sqrt(3),we=F.div.renderedHeight+F.div.renderedDepth<Math.max(0,je["radical.verticalthreshold"][0])?(ne=Math.min(F.div.renderedHeight+F.div.renderedDepth,ne/Math.max(je["radical.verticalthreshold"][0],0)),he=oe*se*ge/(6*se*se+2),be.width=(-oe*(re*(se-1)-se*ce-ve*le+ce)/(2*ve)+he+ce)*Ne,be.style.width="".concat((-oe*re*(se-1)+oe*se*ce-ce*(oe-2*ve)+ve*(oe+2*he))/(2*ve),"em"),(de=be.getContext("2d")).fillStyle=qe.color,pe=[Math.max(-oe*(re*(se-1)-se*ce-ve*le+ce)/(2*ve),0)+he+ce,ve-oe/2],me=[Math.min(-oe*(-re*(se-1)+se*ce+ve*le-ce)/(2*ve)+he+ce,pe[0]),ve+oe/2],ue=[-(4*re*re*se*ge*(se-1)*(se-1)-re*(se-1)*(4*se*se*ce*ge+3*oe*ge*Math.pow(se,1.5)-4*se*(ve*(ne-1)-he*ge)+4*ve*ne)-ve*(4*se*se*ce*(ne-1)+oe*Math.pow(se,1.5)*(3*ne+2)-4*se*(ne*ce-he*(ne-1))-3*oe*ne*le-4*ne*he))/(4*(ge*re*se*(se-1)+ve*(se*(ne-1)-ne))),-(ne*ve+se*re*ge)/(se*(ce-re))*(-(4*re*re*se*ge*(se-1)*(se-1)-re*(se-1)*(4*se*se*ce*ge+3*oe*ge*Math.pow(se,1.5)-4*se*(ve*(ne-1)-he*ge)+4*ve*ne)-ve*(4*se*se*ce*(ne-1)+oe*Math.pow(se,1.5)*(3*ne+2)-4*se*(ne*ce-he*(ne-1))-3*oe*ne*le-4*ne*he))/(4*(ge*re*se*(se-1)+ve*(se*(ne-1)-ne)))-se*(ce-re)-re-3*oe*le/4-he)],fe=[Math.max(-re*(se-1)+se*ce+oe/2*le+he,-ue[1]*(me[0]-ue[0])/(me[1]-ue[1])+ue[0]+pe[0]-(me[0]-ue[0])/(me[1]-ue[1])*(pe[1]-ue[1]+(me[1]-ue[1])/(me[0]-ue[0])*ue[0])),0],de.beginPath(),de.moveTo(pe[0]*Ne,be.height-pe[1]*Ne),de.lineTo((-oe*(re*(se-1)-se*ce-ve*le+ce)/(2*ve)+he+ce)*Ne,be.height-(ve+oe/2)*Ne),de.lineTo(me[0]*Ne,be.height-me[1]*Ne),de.lineTo(ue[0]*Ne,be.height-ue[1]*Ne),de.lineTo((8*re*re*se*ge*(se-1)-re*(8*se*se*ce*ge+6*oe*Math.pow(se,1.5)*ge+se*(oe+8*he*ge)+8*ve*ne)+oe*se*ce-6*oe*ve*ne*le-8*ve*ne*he)/(8*(re*se*ge*(se-1)-se*se*ce*ge-ve*ne))*Ne,be.height-(xe=se*ge*(8*re*re*se*ge*(se-1)-re*(8*se*se*ce*ge+6*oe*Math.pow(se,1.5)*ge+se*(oe+8*he*ge)+8*ve*ne)+oe*se*ce-6*oe*ve*ne*le-8*ve*ne*he)/(8*(re*se*ge*(se-1)-se*se*ce*ge-ve*ne))+ne*ve+oe/8)*Ne),de.lineTo(0,be.height-(ne*ve+oe/8)*Ne),de.lineTo(2*he*Ne,be.height-(ne*ve-oe/8)*Ne),de.lineTo((8*re*re*se*ge*(se-1)-re*(8*se*se*ge*(ce-2*he)-6*oe*Math.pow(se,1.5)*ge-se*(oe-8*he*ge)+8*ve*ne)-16*he*se*se*ce*ge-oe*se*ce+6*oe*ve*ne*le-8*ve*ne*he)/(8*(re*se*ge*(se-1)-se*se*ce*ge-ve*ne))*Ne,be.height-(se*ge*((8*re*re*se*ge*(se-1)-re*(8*se*se*ge*(ce-2*he)-6*oe*Math.pow(se,1.5)*ge-se*(oe-8*he*ge)+8*ve*ne)-16*he*se*se*ce*ge-oe*se*ce+6*oe*ve*ne*le-8*ve*ne*he)/(8*(re*se*ge*(se-1)-se*se*ce*ge-ve*ne))-2*he)+ne*ve-oe/8)*Ne),de.lineTo((-re*(se-1)+se*ce-.75*oe*le+he)*Ne,be.height),de.lineTo(fe[0]*Ne,be.height),de.closePath(),de.fill(),(me[0]-ue[0])/(me[1]-ue[1])*(xe-ue[1])+ue[0]):(ne=Math.max(0,Math.min(ve,je["radical.h"][0])),be.width=(8*ce+oe*(4+ge))/8*Ne,be.style.width="".concat((8*ce+oe*(4+ge))/8,"em"),(ve=be.getContext("2d")).fillStyle=qe.color,ve.beginPath(),ve.moveTo((ce+oe*(ge+4)/8)*Ne,.04*Ne),ve.lineTo((ce+oe*(ge-4)/8)*Ne,.04*Ne),ve.lineTo((ce+oe*(ge-4)/8)*Ne,be.height-5*oe*(ne+re*ge)/(4*(ce-re))*Ne),ve.lineTo((re*(4*ce*ge+oe*(3*ge+2)+4*ne)-oe*(2*ce-3*ne-1.5*ce-ne/2*ge))/(4*(ce*ge+ne))*Ne,be.height-(xe=(re*(4*ce*ge+oe*(3*ge+2)+4*ne)-oe*(2*ce-3*ne))/(4*(ce*ge+ne))*ge+ne+oe/2)*Ne),ve.lineTo(0,be.height-(oe/8+ne)*Ne),ve.lineTo(oe*ge/4*Ne,be.height-(-oe/8+ne)*Ne),ve.lineTo((re*(4*ce*ge-oe*(3*ge+2)+4*ne)+oe*(2*ce-3*ne+1.5*ce+ne/2*ge))/(4*(ce*ge+ne))*Ne,be.height-((re*(4*ce*ge-oe*(3*ge+2)+4*ne)+oe*(2*ce-3*ne))/(4*(ce*ge+ne))*ge+ne-oe/2)*Ne),ve.lineTo((ce-oe*(6-ge)/8)*Ne,be.height),ve.lineTo((ce+oe*(ge+4)/8)*Ne,be.height),ve.closePath(),ve.fill(),ce+oe*(ge-4)/8)):(be.height=($e.heightOf("√",Ve)+$e.depthOf("√",Ve))*Ne,be.width=$e.widthOf("√",Ve)*Ne,ge=be.getContext("2d"),be.style.height="".concat(F.div.renderedHeight+F.div.renderedDepth,"em"),be.style.width="".concat($e.widthOf("√",Ve),"em"),be.style.position="relative",be.style.top="".concat(F.div.renderedDepth,"em"),be.style.marginTop="".concat(-F.div.renderedDepth,"em"),ge.textAlign="center",ge.font="".concat(Ne,"px ").concat(Ve),ge.fillText("√",be.width/2,be.height*(1-$e.depthOf("√",Ve)))),F.div.insertBefore(be,ye),F.index.length&&((ye=document.createElement("div")).style.display="inline-block",ye.style.position="relative",Ae(F.index,"scriptscript",!1,Le,ye),ye.style.fontSize="50px",Pe.appendChild(ye),ye.style.marginLeft="".concat(Math.max(-(ye.offsetWidth+1)/50,-(we+.05)/("script"==Oe?Ue:"scriptscript"==Oe?1:.5)),"em"),Pe.removeChild(ye),ye.style.fontSize="".concat("script"==Oe?Ue:"scriptscript"==Oe?1:.5,"em"),ye.style.top="".concat(-Math.max(xe-F.div.renderedDepth,$e.heightOf("x",Ve)/2)/("script"==Oe?Ue:"scriptscript"==Oe?1:.5)-ye.renderedDepth-.1,"em"),ye.style.left="".concat((.05+we)/("script"==Oe?Ue:"scriptscript"==Oe?1:.5),"em"),F.div.insertBefore(ye,be))}return"continue"}if("rule"==F.type){var ke=document.createElement("div"),Se="100%",Ee="100%",Ce="";ke.style.background="currentColor",F.height&&((Se=new Ge(F.height)).em.value+=Se.sp.value/65536/6*8/Ne*65536,Se=Se.em.value/65536),F.depth&&((Ce=new Ge(F.depth)).em.value+=Ce.sp.value/65536/6*8/Ne*65536,Ce=Ce.em.value/65536),F.width&&((Ee=new Ge(F.width)).em.value+=Ee.sp.value/65536/6*8/Ne*65536,Ee=Ee.em.value/65536),"v"==F.ruleType?("100%"==Se?(ke.style.alignSelf="stretch",ke.renderedDepth=0,ke.renderedHeight=0):(ke.style.height="".concat(Math.max(Se+Ce,0),"em"),ke.style.marginBottom=ke.style.top="".concat(Ce,"em"),ke.style.marginTop="".concat(-Ce,"em"),ke.style.position="relative",ke.renderedHeight=Math.max(Se,0),ke.renderedDepth=Math.max(Ce,0)),Ee<0?He.push({type:"kern",dimen:new Ge(0,65536*Ee)}):ke.style.width="".concat(Ee,"em")):"h"==F.ruleType&&(ke.style.width="100%"==Ee?"100%":"".concat(Ee,"em"),ke.style.height="".concat(Math.max(Se+Ce,0),"em"),ke.style.marginBottom=ke.style.top="".concat(Ce,"em"),ke.style.marginTop="".concat(-Ce,"em"),ke.style.position="relative",He.push({type:"atom",atomType:ze.ORD,nucleus:{},superscript:null,subscript:null,style:Oe,isLineBreak:!0,div:document.createElement("div")}),He[He.length-1].div.style.width="100%",Me.push(He[He.length-1]));Se={type:"atom",atomType:ze.ORD,nucleus:null,superscript:null,subscript:null,style:Oe,div:ke,isLineBreak:"h"==F.ruleType,growHeight:"v"==F.ruleType,stretchHeight:"100%"==Se};return He.push(Se),Me.push(Se),"h"==F.ruleType&&(He.push({type:"atom",atomType:ze.ORD,nucleus:null,superscript:null,subscript:null,isLineBreak:!0,div:document.createElement("div")}),He[He.length-1].div.style.width="100%",Me.push(He[He.length-1])),"continue"}};for(var r=0;r<Te.length;r++)s(r);Me.length&&Me[Me.length-1].atomType==ze.BIN&&(Me[Me.length-1].atomType=ze.ORD);He.length||(Re.empty=!0);for(var n=0,l=He.length;n<l;n++){var o,c=He[n],h=Me.indexOf(c);if(c.italicCorrection&&(c.dimen=new Ge(0,65536*$e.italCorrOf(c.italicCorrection,Ve))),"glue"==c.type&&"dimension"==c.glue.stretch.type&&0==c.glue.stretch.sp.value&&0==c.glue.stretch.em.value&&"dimension"==c.glue.shrink.type&&0==c.glue.shrink.sp.value&&0==c.glue.shrink.em.value&&(c.type="kern",c.dimen=c.glue.start),"vkern"!=c.type||!c.dimen.sp.value&&!c.dimen.em.value)if("kern"!=c.type||!c.dimen.sp.value&&!c.dimen.em.value)if("glue"!=c.type){if("atom"==c.type){if(0!=h&&c.atomType==ze.BIN&&("display"!=Oe&&"text"!=Oe||((o=document.createElement("div")).style.flexShrink=1,o.style.flexGrow=1,o.style.maxWidth="".concat(6/18,"em"),o.style.width="".concat(4/18,"em"),i.push(o)),(o=document.createElement("div")).style.display="inline-flex",o.style.flexWrap="nowrap",o.style.alignItems="baseline",a&&(o.style.position="relative",o.style.marginTop="".concat(a/65536,"em"),o.style.marginBottom="".concat(-a/65536,"em"),o.style.top="".concat(-a/65536,"em"),o.verticalRaise=a),i.push(o)),0!=h&&c.atomType==ze.REL&&("display"!=Oe&&"text"!=Oe||Me[h-1].atomType==ze.REL||Me[h-1].atomType==ze.OPEN||(p=document.createElement("div"),6==Me[h-1].atomType?p.style.width="".concat(3/18,"em"):(p.style.flexGrow=1,p.style.maxWidth="".concat(10/18,"em"),p.style.minWidth="".concat(5/18,"em")),i.push(p)),(p=document.createElement("div")).style.display="inline-flex",p.style.flexWrap="nowrap",p.style.alignItems="baseline",a&&(p.style.position="relative",p.style.marginTop="".concat(a/65536,"em"),p.style.marginBottom="".concat(-a/65536,"em"),p.style.top="".concat(-a/65536,"em"),p.verticalRaise=a),i.push(p)),0!=h){var d=[ze.ORD,ze.OP,ze.BIN,ze.REL,ze.OPEN,ze.CLOSE,ze.PUNCT,ze.INNER],p=d.indexOf(Me[h-1].atomType);p=~p?p:0;var d=d.indexOf(c.atomType),d=[[0,1,0,0,0,0,0,-1],[1,1,0,0,0,0,0,-1],[-2,-2,0,0,-2,0,0,-2],[-3,-3,0,0,-3,0,0,-3],[0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,-1],[0,0,0,0,0,0,0,0],[-1,1,0,0,-1,0,-1,-1]][p][d=~d?d:0],m=document.createElement("div");switch(d=d<0?"script"==c.style||"scriptscript"==c.style?0:-d:d){case 1:m.style.minWidth="".concat(3/18,"em"),m.style.maxWidth="".concat(3/18,"em");break;case 2:m.style.width="".concat(4/18,"em"),m.style.maxWidth="".concat(6/18,"em"),m.style.flexGrow=1,m.style.flexShrink=1;break;case 3:m.style.minWidth="".concat(5/18,"em"),m.style.maxWidth="".concat(10/18),m.style.flexGrow=1}d&&i[i.length-1].appendChild(m)}var u,f,d=i[i.length-1];d.renderedHeight=Math.max(d.renderedHeight||0,c.div.renderedHeight),d.renderedDepth=Math.max(d.renderedDepth||0,c.div.renderedDepth),c.div.baseline+c.div.baselineOffset<d.baseline+d.baselineOffset?(d.baseline=d.baseline||0,d.baselineOffset=d.baselineOffset||0):(d.baseline=c.div.baseline,d.baselineOffset=c.div.baselineOffset),c.isLineBreak?(i.push(c.div),(u=document.createElement("div")).style.display="inline-flex",u.style.flexWrap="nowrap",u.style.alignItems="baseline",a&&(u.style.position="relative",u.style.marginTop="".concat(a/65536,"em"),u.style.marginBottom="".concat(-a/65536,"em"),u.style.top="".concat(-a/65536,"em"),u.verticalRaise=a),i.push(u)):c.growHeight?((u=document.createElement("div")).style.display="inline-flex",u.style.flexWrap="nowrap",u.style.alignItems="baseline",c.stretchHeight&&(u.style.alignSelf="stretch"),a&&(u.style.position="relative",u.style.marginTop="".concat(a/65536,"em"),u.style.marginBottom="".concat(-a/65536,"em"),u.style.top="".concat(-a/65536,"em"),u.verticalRaise=a),u.appendChild(c.div),i.push(u),(u=document.createElement("div")).style.display="inline-flex",u.style.flexWrap="nowrap",u.style.alignItems="baseline",a&&(u.style.position="relative",u.style.marginTop="".concat(a/65536,"em"),u.style.marginBottom="".concat(-a/65536,"em"),u.style.top="".concat(-a/65536,"em"),u.verticalRaise=a),i.push(u)):d.appendChild(c.div),c.atomType==ze.PUNCT&&("display"!=Oe&&"text"!=Oe||!Me[h+1]||Me[h+1].atomType==ze.REL||((f=document.createElement("div")).style.minWidth="".concat(3/18,"em"),f.style.maxWidth="".concat(3/18,"em"),i.push(f)),(f=document.createElement("div")).style.display="inline-flex",f.style.flexWrap="nowrap",f.style.alignItems="baseline",a&&(f.style.position="relative",f.style.marginTop="".concat(a/65536,"em"),f.style.marginBottom="".concat(-a/65536,"em"),f.style.top="".concat(-a/65536,"em"),f.verticalRaise=a),i.push(f))}}else{var v=document.createElement("div"),g=(c.glue.start.sp.value/12*16/Ne+c.glue.start.em.value)/65536;v.style.width="".concat(g,"em"),"infinite dimension"==c.glue.stretch.type?v.style.flexGrow=c.glue.stretch.number.value/65536*Math.pow(1290,c.glue.stretch.magnitude.value):(c.glue.stretch.sp.value||c.glue.stretch.em.value)&&(v.style.flexGrow=1,v.style.maxWidth="".concat(g+(c.glue.stretch.sp.value/12*16/Ne+c.glue.stretch.em.value)/65536,"em")),"infinite dimension"==c.glue.shrink.type?v.style.flexShrink=c.glue.shrink.number.value/65536*Math.pow(1290,c.glue.shrink.magnitude.value):(c.glue.shrink.sp.value||c.glue.shrink.em.value)&&(v.style.flexShrink=1,v.style.minWidth="".concat(g-(c.glue.shrink.sp.value/12*16/Ne+c.glue.shrink.em.value)/65536,"em")),i.push(v);var g=document.createElement("div");g.style.display="inline-flex",g.style.flexWrap="nowrap",g.style.alignItems="baseline",a&&(g.style.position="relative",g.style.marginTop="".concat(a/65536,"em"),g.style.marginBottom="".concat(-a/65536,"em"),g.style.top="".concat(-a/65536,"em"),g.verticalRaise=a),i.push(g)}else{v=i[i.length-1];v.lastElementChild&&!v.lastElementChild.style.marginRight||((g=document.createElement("div")).style.display="inline-block",v.appendChild(g)),v.lastElementChild.style.marginRight="".concat((c.dimen.sp.value/12*16/Ne+c.dimen.em.value)/65536,"em")}else{a+=c.dimen.em.value,a+=c.dimen.sp.value/12*16/Ne;c=document.createElement("div");c.style.display="inline-flex",c.style.flexWrap="nowrap",c.style.alignItems="baseline",a&&(c.style.position="relative",c.style.marginTop="".concat(a/65536,"em"),c.style.marginBottom="".concat(-a/65536,"em"),c.style.top="".concat(-a/65536,"em"),c.verticalRaise=a),i.push(c)}}for(var y=0,b=i.length;y<b;y++)Re.appendChild(i[y]),Re.renderedHeight=Math.max(Re.renderedHeight||0,(i[y].renderedHeight||0)+(i[y].verticalRaise||0)/65536),Re.renderedDepth=Math.max(Re.renderedDepth||0,(i[y].renderedDepth||0)-(i[y].verticalRaise||0)/65536),i[y].baselineOffset+i[y].baseline<Re.baselineOffset+Re.baseline?(Re.baseline=Re.baseline||0,Re.baselineOffset=Re.baselineOffset||0):(Re.baseline=i[y].baseline,Re.baselineOffset=i[y].baselineOffset);e.appendChild(Re);e.renderedHeight=Math.max(e.renderedHeight||0,Re.renderedHeight);e.renderedDepth=Math.max(e.renderedDepth||0,Re.renderedDepth);Re.baselineOffset+Re.baseline<e.baselineOffset+e.baseline?(e.baseline=e.baseline||0,e.baselineOffset=e.baselineOffset||0):(e.baseline=Re.baseline,e.baselineOffset=Re.baselineOffset);return De}(e,w,!1,"nm",t),t=t.firstElementChild.empty&&1==t.children.length?document.createTextNode(""):t}S.parse=function(c){function e(e){var t=c[e]||"",i=Ce.cats[t.codePointAt(0)];if(!i)return[{},0];if((i=i.value)!=we.ESCAPE&&i!=we.MATHSHIFT&&i!=we.ACTIVE)return[{},0];if(i==we.ESCAPE){var a,s=c[e+1],r=c.codePointAt(e+1),n="";if(r in Ce.cats&&Ce.cats[r].value==we.LETTER){for(var l=e+1,o=c.codePointAt(l);o&&o in Ce.cats&&Ce.cats[o].value==we.LETTER;o=c.codePointAt(++l))n+=c[l];if(!Ce.defs.macros[n])return[{},0];a=Ce.defs.macros[n]}else{if(!s||!Ce.defs.primitive[s]&&!Ce.defs.macros[s])return[{},0];a=Ce.defs.primitive[n=s]||Ce.defs.macros[s]}s=!1;return a.isLet&&(a=a.original,s=!0),a===Ce.defs.primitive["["]?[{type:"command",name:"[",cat:-1},n.length+1]:a===Ce.defs.primitive["("]?[{type:"command",name:"(",cat:-1},n.length+1]:s&&a.replacement&&1==a.replacement.length&&a.replacement[0].cat==we.MATHSHIFT?[{char:t,cat:we.MATHSHIFT},n.length+1]:[{},0]}if(i==we.MATHSHIFT)return[{char:t,cat:we.MATHSHIFT},1];if(i==we.ACTIVE&&Ce.defs.active[t]){if(Ce.defs.active[t].isLet){i=Ce.defs.active[t].original;if(i===Ce.defs.primitive["["])return[{type:"command",name:"[",cat:-1},1];if(i===Ce.defs.primitive["("])return[{type:"command",name:"(",cat:-1},1];if(i.replacement&&1==i.replacement.length&&i.replacement[0].cat==we.MATHSHIFT)return[{char:t,cat:we.MATHSHIFT},1]}return[{},0]}return[{},0]}for(var t=[],i=c;c;)if(c.codePointAt(0)in Ce.cats){var a,s=e(0),r=null,n=0;if(s[0].cat==we.MATHSHIFT?(n+=s[1],(a=e(s[1]))[0].cat==we.MATHSHIFT?(r="display",n+=a[1]):r="inline"):"command"==s[0].type&&"["==s[0].name?(r="display",n+=s[1]):"command"==s[0].type&&"("==s[0].name&&(r="inline",n+=s[1]),"display"==r||"inline"==r){n=y(c.substring(n),r);if(!n[2]){t.push(c),c="";break}c=n[1],t.push([n[0],"display"==r?"display":"text"])}else"string"==typeof t[t.length-1]?t[t.length-1]+=c[0]:t.push(c[0]),c=c.substring(1)}else"string"==typeof t[t.length-1]?t[t.length-1]+=c[0]:t.push(c[0]),c=c.substring(1);return new S.ParsedFontTeX(i,t)},S.render=function(e){for(var t=(e=E(e)).length-1;0<=t;t--){var i=e[t].getAttribute("".concat(x,"-input"));null===(i=null===(i=null===i?e[t].getAttribute("use"):i)?e[t].getAttribute("data-use"):i)&&(i=e[t].innerHTML),S.parse(i).renderIn(e[t]),e[t].setAttribute("".concat(x,"-input"),i)}},"interactive"==document.readyState?t():document.addEventListener("readystatechange",function(){"interactive"==this.readyState&&t()}),S.ParsedFontTeX=function(){function i(e,t){_classCallCheck(this,i),this.texString=e,this.parsedTokens=t}var e,t,a;return e=i,(t=[{key:"renderIn",value:function(w){r.then(function(){for(var e=E(w),t=this.parsedTokens.slice(),i=e.length-1;0<=i;i--){e[i].innerHTML="";var a,s=void 0;if(e[i].hasAttribute("".concat(x,"-container-id"))?(a=+e[i].getAttribute("".concat(x,"-container-id")),s=C[a].styles,C[a].oldFontFamily=s.fontFamily,C[a].oldFontSize=s.fontSize,C[a].oldColor=s.color,C[a].parsedTeXInstance=this):(a=C.length,s=getComputedStyle(e[i]),e[i].setAttribute("".concat(x,"-container-id"),a),C[a]={elem:e[i],styles:s,parsedTeXInstance:this,oldFontFamily:s.fontFamily,oldFontSize:s.fontSize,oldColor:s.oldColor}),!function(e,a){for(var s=e.split(",").map(function(e){return k(e.trim())}),r=1/0,t=0,i=s.length;t<i;t++)D.then(function(i){!function e(t){requestAnimationFrame(function(){return L.includes(s[t])?void(t<r&&(r=t)):(i.style.fontFamily="".concat(s[t],", serif"),i.offsetWidth!=O?(L.push(s[t]),void(t<r&&a(s[r=t]))):(i.style.fontFamily="".concat(s[t],", sans-serif"),i.offsetWidth!=I?(L.push(s[t]),void(t<r&&a(s[r=t]))):void e(t)))})}(this)}.bind(t))}(s.fontFamily,function(e){R(e),S.rerender(this)}.bind(e[i])),je.parsehtml[0]){for(var r,n="",l=[],o=0,c=t.length;o<c;o++)"string"==typeof t[o]?n+=t[o]:(r=Fe(),l.push([r,A(e[i],t[o][0],t[o][1],s)]),n+="<span ".concat(x,"-uuid-").concat(r,"></span>"));var h=document.createElement("div");h.innerHTML=n;for(var d=!1,p=0,m=l.length;p<m;p++){var u=h.querySelector("[".concat(x,"-uuid-").concat(l[p][0],"]"));u?(u.parentNode.insertBefore(l[p][1],u),u.parentNode.removeChild(u)):d=!0}d&&console.warn("Malformed HTML was passed into `renderIn`. Some TeX couldn't be rendered.\nPassed in value: ".concat(this.texString));for(var f=0,v=h.childNodes.length;f<v;f++)e[i].appendChild(h.firstChild)}else{for(var g=document.createDocumentFragment(),y=0,b=t.length;y<b;y++)"string"==typeof t[y]?g.appendChild(document.createTextNode(t[y])):g.appendChild(A(e[i],t[y][0],t[y][1],s));e[i].appendChild(g)}e[i].setAttribute("".concat(x,"-input"),this.texString),e[i].setAttribute("".concat(x,"-is-parsed"),"true")}}.bind(this))}},{key:"again",value:function(){return this.parsedTokens=S.parse(this.texString).parsedTokens,this}},{key:"reparse",value:function(){return this.parsedTokens=S.parse(this.texString).parsedTokens,this}}])&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),i}(),S.global=function(e){var t,i,a=y(e,"standalone",!0);for(t in a.defs.macros)Ce.defs.macros[t]=a.defs.macros[t];for(i in a.defs.active)Ce.defs.active[i]=a.defs.active[i];var s,r,n,l,o,c,h,d,p,m=[];for(s in a.registers.count){var u=new xe(a.registers.count[s]);Ce.registers.count[s]=u,m.push(u)}for(r in a.registers.dimen){var f=new Ge(a.registers.dimen[r]);Ce.registers.dimen[r]=f,m.push(f)}for(n in a.registers.skip){var v=new Xe(a.registers.skip[n]);Ce.registers.skip[n]=v,m.push(v)}for(l in a.registers.muskip){var g=new Se(a.registers.muskip[l]);Ce.registers.muskip[l]=g,m.push(g)}for(o in a.registers.named)m.includes(a.registers.named[o])?Ce.registers.named[o]=a.registers.named[o]:"integer"==a.registers.named[o].type?Ce.registers.named[o]=new xe(a.registers.named[o]):"dimension"==a.registers.named[o].type?Ce.registers.named[o]=new Ge(a.registers.named[o]):"mu dimension"==a.registers.named[o].type?Ce.registers.named[o]=new ke(a.registers.named[o]):"glue"==a.registers.named[o].type?Ce.registers.named[o]=new Xe(a.registers.named[o]):"mu glue"==a.registers.named[o].type&&(Ce.registers.named[o]=new Se(a.registers.named[o]));for(c in a.cats)Ce.cats[c].value=a.cats[c].value;for(h in a.mathcodes)Ce.mathcodes[h].value=a.mathcodes[h].value;for(d in a.uc)Ce.uc[d].value=a.uc[d].value;for(p in a.lc)Ce.lc[p].value=a.lc[p].value};function g(e,t){_classCallCheck(this,g),_defineProperty(this,"type","primitive"),this.name=e,this.function=t}function b(e,t){_classCallCheck(this,b),_defineProperty(this,"type","macro"),e instanceof g||e instanceof b?(e.proxy&&(e=e.original),this.proxy=!0,this.isLet=Boolean(t),this.original=e):(this.proxy=!1,this.replacement=e||[],this.parameters=t||[])}var xe=function e(t,i,a,s){_classCallCheck(this,e),_defineProperty(this,"type","integer"),_defineProperty(this,"register",!0),this.message=s||"",t instanceof e?(this.value=t.value,this.parent=t,this.min=t.min,this.max=t.max):(this.min=null==i?Number.MIN_SAFE_INTEGER:i,this.max=null==a?Number.MAX_SAFE_INTEGER:a,t=!isNaN(t)&&Math.round(t)||0,isFinite(t)||(t=t<0?this.min:this.max),this.value=Math.max(this.min,Math.min(this.max,t)))},Ge=function e(t,i,a){_classCallCheck(this,e),_defineProperty(this,"type","dimension"),_defineProperty(this,"register",!0),this.message=a||"",t instanceof e?(this.sp=new xe(t.sp),this.em=new xe(t.em),this.parent=t):t instanceof ke?(this.sp=new xe(0),this.em=new xe(t.mu/18)):(this.sp=new xe(t),this.em=new xe(i))},ke=function e(t,i){_classCallCheck(this,e),_defineProperty(this,"type","mu dimension"),_defineProperty(this,"register",!0),this.message=i||"",t instanceof e?(this.mu=new xe(t.mu),this.parent=t):this.mu=new xe(t instanceof Ge?t.em/18+t.sp/65536/12*18:t)},Xe=function e(t,i,a,s){_classCallCheck(this,e),_defineProperty(this,"type","glue"),_defineProperty(this,"register",!0),this.message=s||"",t instanceof e?(this.start=new Ge(t.start),this.stretch=new Ge(t.stretch),this.shrink=new Ge(t.shrink),this.parent=t):(this.start=new Ge(t),this.stretch=i instanceof Ee?i:new Ge(i),this.shrink=a instanceof Ee?a:new Ge(a))},Se=function e(t,i,a,s){_classCallCheck(this,e),_defineProperty(this,"type","mu glue"),_defineProperty(this,"register",!0),this.message=s||"",t instanceof e?(this.start=new ke(t.start),this.stretch=new ke(t.stretch),this.shrink=new ke(t.shrink),this.parent=t):(this.start=new ke(t),this.stretch=i instanceof Ee?i:new ke(i),this.shrink=a instanceof Ee?a:new ke(a))},Ee=function e(t,i,a){_classCallCheck(this,e),_defineProperty(this,"type","infinite dimension"),_defineProperty(this,"register",!0),this.message=a||"",this.number=new xe(t),this.magnitude=new xe(i)};function T(e){return e.invalid=!0,[e]}function f(e){return e&&("command"==e.type||"character"==e.type&&e.cat==we.ACTIVE)}function v(e){var t=e.eat();t&&"character"==t.type&&"="==t.char&&t.cat==we.OTHER||e.revert()}var Ce={defs:{primitive:{"(":new g("(",function(e){return T(this)}),")":new g(")",function(e){return"inline"==e.style?[{type:"character",char:"$",code:"$".codePointAt(0),cat:we.MATHSHIFT}]:T(this)}),"/":new g("/",function(e){return"superscript"==e.lastContext.type||"subscript"==e.lastContext.type?T(this):(e.tokens.push({type:"kern",dimen:new Ge(0),italicCorrection:!0}),[])}),"[":new g("[",function(e){return T(this)}),"]":new g("]",function(e){return"display"==e.style?[{type:"character",char:"$",code:"$".codePointAt(0),cat:we.MATHSHIFT},{type:"character",char:"$",code:"$".codePointAt(0),cat:we.MATHSHIFT}]:T(this)}),above:new g("above",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=e.mouth.eat("dimension");return t?(e.lastScope.isFrac=!0,e.lastScope.fracRightDelim=e.lastScope.fracRightDelim=".",e.lastScope.barWidth=t,e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[]):T(this)}),abovewithdelims:new g("abovewithdelims",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(f(i)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!Ce.delims.includes(i.code)||i.cat!=we.OTHER&&i.cat!=we.LETTER)return e.mouth.loadState(t),delete e.lastScope.fracLeftDelim,T(this);if(e.lastScope.fracLeftDelim){e.lastScope.fracRightDelim=i.char;break}e.lastScope.fracLeftDelim=i.char}}var s=e.mouth.eat("dimension");return s?(e.lastScope.isFrac=!0,e.lastScope.barWidth=s,e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[]):T(this)}),accent:new g("accent",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");return!i||i.value<0?(e.mouth.loadState(t),T(this)):(e.tokens.push({type:"accent modifier",char:String.fromCodePoint(i.value),code:i.value,token:this}),[])}),advance:new g("advance",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!f(i)){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==we.ACTIVE){if(!a)return e.mouth.loadState(t),T(this);e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=we.ACTIVE||e.mouth.revert(2)}if("integer"==i.type){s=e.mouth.eat("integer");if(!s)return e.mouth.loadState(t),T(this);i.value+=s.value;var r=i;if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=r.value;e.toggles.global=!1}else if("dimension"==i.type){var n=e.mouth.eat("dimension");if(!n)return e.mouth.loadState(t),T(this);i.sp.value+=n.sp.value,i.em.value+=n.em.value;var l=i;if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=l.sp.value,i.em.value=l.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){n=e.mouth.eat("mu dimension");if(!n)return e.mouth.loadState(t),T(this);i.mu.value+=n.mu.value;var o=i;if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=o.mu.value;e.toggles.global=!1}else if("glue"==i.type){var c=e.mouth.eat("glue");if(!c)return e.mouth.loadState(t),T(this);i.start.sp.value+=c.start.sp.value,i.start.em.value+=c.start.em.value,"infinite dimension"==c.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==c.stretch.magnitude.value?i.stretch.number.value+=c.stretch.number.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<c.stretch.magnitude.value)&&(i.stretch=new Ee(c.stretch.number.value,c.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.sp.value+=c.stretch.sp.value,i.stretch.em.value+=c.stretch.em.value),"infinite dimension"==c.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==c.shrink.magnitude.value?i.shrink.number.value+=c.shrink.number.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<c.shrink.magnitude.value)&&(i.shrink=new Ee(c.shrink.number.value,c.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.sp.value+=c.shrink.sp.value,i.shrink.em.value+=c.shrink.em.value);var h=i;if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value+=c.start.sp.value,i.start.em.value+=c.start.em.value,"infinite dimension"==h.stretch.type?i.stretch=new Ee(h.stretch.number.value,h.stretch.magnitude.value):i.stretch=new Ge(h.stretch.sp.value,h.stretch.em.value),"infinite dimension"==h.shrink.type?i.shrink=new Ee(h.shrink.number.value,h.shrink.magnitude.value):i.shrink=new Ge(h.shrink.sp.value,h.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){var d=e.mouth.eat("mu glue");if(!d)return e.mouth.loadState(t),T(this);i.start.mu.value+=d.start.mu.value,"infinite dimension"==d.stretch.type?"infinite dimension"==i.stretch.type&&i.stretch.magnitude.value==d.stretch.magnitude.value?i.stretch.value+=d.stretch.value:("infinite dimension"!=i.stretch.type||i.stretch.magnitude.value<d.stretch.magnitude.value)&&(i.stretch=new Ee(d.stretch.number.value,d.stretch.magnitude.value)):"infinite dimension"!=i.stretch.type&&(i.stretch.mu.value+=d.stretch.mu.value),"infinite dimension"==d.shrink.type?"infinite dimension"==i.shrink.type&&i.shrink.magnitude.value==d.shrink.magnitude.value?i.shrink.value+=d.shrink.value:("infinite dimension"!=i.shrink.type||i.shrink.magnitude.value<d.shrink.magnitude.value)&&(i.shrink=new Ee(d.shrink.number.value,d.shrink.magnitude.value)):"infinite dimension"!=i.shrink.type&&(i.shrink.mu.value+=d.shrink.mu.value);var p=i;if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=p.start.mu.value,"infinite dimension"==p.stretch.type?i.stretch=new Ee(p.stretch.number.value,p.stretch.magnitude.value):i.stretch=new ke(p.stretch.mu.value),"infinite dimension"==p.shrink.type?i.shrink=new Ee(p.shrink.number.value,p.shrink.magnitude.value):i.stretch=new ke(p.shrink.mu.value);e.toggles.global=!1}break}return e.mouth.loadState(t),T(this)}d=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,d)}return[]}),atop:new g("atop",function(e){return"superscript"==e.lastContext.type||"subscript"==e.lastContext.type?T(this):(e.lastScope.isFrac=!0,e.lastScope.fracLeftDelim=e.lastScope.fracRightDelim=".",e.lastScope.barWidth=new Ge(0),e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[])}),atopwithdelims:new g("atopwithdelims",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(f(i)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!Ce.delims.includes(i.code)||i.cat!=we.OTHER&&i.cat!=we.LETTER)return e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,T(this);if(e.lastScope.fracLeftDelim){e.lastScope.fracRightDelim=i.char;break}e.lastScope.fracLeftDelim=i.char}}return e.lastScope.isFrac=!0,e.lastScope.barWidth=new Ge(0),e.lastScope.root&&(e.lastScope.root.invalid=!0,e.lastScope.root=!1),e.lastScope.fracNumerator=e.lastScope.tokens,e.lastScope.tokens=[],[]}),begingroup:new g("begingroup",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();e.mouth.saveState(t),new e.Scope;t=e.scopes[e.scopes.length-1];return t.semisimple=!0,e.openGroups.push(this),e.contexts.push({toString:function(){return"scope"},type:"scope"}),this.ignore=!0,t.tokens.push(this),[]}),bf:new g("bf",function(e){return"superscript"==e.lastContext.type||"subscript"==e.lastContext.type?T(this):(e.tokens.push({type:"font modifier",value:"bf"}),[])}),catcode:new g("catcode",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=e.mouth.eat("integer");if(t){if(t.value<0)return e.mouth.revert(),T(this);if(!(t.value in Ce.cats)){Ce.cats[t.value]=new xe(we.OTHER,0,15);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].cats[t.value]=new xe((0==i?Ce:e.scopes[i-1]).cats[t.value])}return[e.lastScope.cats[t.value]]}return T(this)}),char:new g("char",function(e){var t=e.mouth.eat("integer");return!t||t.value<0?T(this):(e.mouth.queue.unshift({type:"character",cat:we.OTHER,char:String.fromCodePoint(t.value),code:t.value}),[])}),chardef:new g("chardef",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return e.mouth.loadState(t),T(this);if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return e.mouth.loadState(t),T(this);v(e.mouth);var a=e.mouth.eat("integer");if(!a||a.value<0)return e.mouth.loadState(t),T(this);var s=new b([{type:"character",cat:we.OTHER,char:String.fromCodePoint(a.value),code:a.value}],[]);if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value){Ce.defs.macros[i.name]=s,delete Ce.registers.named[i.name];for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].defs.macros[i.name]=s,delete e.scopes[r].registers.named[i.name]}else e.lastScope.defs.macros[i.name]=s,delete e.lastScope.registers.named[i.name];e.toggles.global=!1}),count:new g("count",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return T(this);if(!Ce.registers.count[t.value]){Ce.registers.count[t.value]=new xe(0);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.count[t.value]=new xe((i?e.scopes[i-1]:Ce).registers.count[t.value])}return[e.lastScope.registers.count[t.value]]}),countdef:new g("countdef",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return e.mouth.loadState(t),T(this);if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return e.mouth.loadState(t),T(this);v(e.mouth);var a=e.mouth.eat("integer");if(!a||a.value<0)return e.mouth.loadState(t),T(this);if(i=i.name,a=a.value,!Ce.registers.count[a]){Ce.registers.count[a]=new xe(0);for(var s=0,r=e.scopes.length;s<r;s++)e.scopes[s].registers.count[a]=new xe((s?e.scopes[s-1]:Ce).registers.count[a])}if(e.toggles.global&&0<=e.lastScope.registers.named.globaldefs.value||0<e.lastScope.registers.named.globaldefs.value){Ce.registers.named[i]=Ce.registers.count[a],delete Ce.defs.macros[i];for(var n=0,l=e.scopes.length;n<l;n++)e.scopes[n].registers.named[i]=e.scopes[n].registers.count[a],delete e.scopes[n].defs.macros[i]}else e.lastScope.registers.named[i]=e.lastScope.registers.count[a],delete e.lastScope.defs.macros[i]}),cr:new g("cr",function(e){if("scope"!=e.lastContext.type)return T(this);for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalign||e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return T(this);var a=t.isHalign?t:t.parentScope;if((h=t.isHalign?null:a.cellData[a.cellData.length-1])&&h[h.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.lastScope.isHalign&&!e.lastScope.isHalignCell)return this.invalid=!0,[this];if(t.isHalignCell){if(!this.postPreamble){for(var s=-1,r=0,n=h.length;r<n;r++)s+=h[r].span;if(a.preamble[s])d=a.preamble[s][1];else{if(!~a.repeatPreambleAt)return this.invalid=!0,[this];var l=a.preamble.slice(a.repeatPreambleAt,a.preamble.length);d=l[(s-a.repeatPreambleAt)%l.length][1]}for(var o=[],r=0,n=d.length;r<n;r++){var c={};for(k in d[r])c[k]=d[r][k];o.push(c)}return this.postPreamble=!0,o.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var h,d=e.scopes.last().tokens;e.scopes.last().isFrac?(h[h.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:d,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),(h=e.scopes.last().cellData[e.scopes.last().cellData.length-1])[h.length-1].content=h[h.length-1].content.concat(d))}var p=Symbol(),m=!1;for(e.mouth.saveState(p);;){if(!(c=e.mouth.eat())){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if("character"==c.type&&c.cat!=we.ACTIVE){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if("command"==c.type||"character"==c.type&&c.cat==we.ACTIVE){if(c.name in e.scopes.last().registers.named){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(!(b="command"==c.type?e.scopes.last().defs.primitive[c.name]||e.scopes.last().defs.macros[c.name]:e.scopes.last().defs.active[c.char])){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(b===Ce.defs.primitive.the||b.proxy&&b.original===Ce.defs.primitive.the||b===Ce.defs.primitive.expandafter||b.proxy&&b.original===Ce.defs.primitive.expandafter||b===Ce.defs.primitive.number||b.proxy&&b.original===Ce.defs.primitive.number||b===Ce.defs.primitive.romannumeral||b.proxy&&b.original===Ce.defs.primitive.romannumeral||b===Ce.defs.primitive.csname||b.proxy&&b.original===Ce.defs.primitive.csname||b===Ce.defs.primitive.string||b.proxy&&b.original===Ce.defs.primitive.string||b===Ce.defs.primitive.if||b.isLet&&b.original===Ce.defs.primitive.if||b===Ce.defs.primitive.ifcase||b.isLet&&b.original===Ce.defs.primitive.ifcase||b===Ce.defs.primitive.ifcat||b.isLet&&b.original===Ce.defs.primitive.ifcat||b===Ce.defs.primitive.ifdim||b.isLet&&b.original===Ce.defs.primitive.ifdim||b===Ce.defs.primitive.ifeof||b.isLet&&b.original===Ce.defs.primitive.ifeof||b===Ce.defs.primitive.iffalse||b.isLet&&b.original===Ce.defs.primitive.iffalse||b===Ce.defs.primitive.ifodd||b.isLet&&b.original===Ce.defs.primitive.ifodd||b===Ce.defs.primitive.ifnum||b.isLet&&b.original===Ce.defs.primitive.ifnum||b===Ce.defs.primitive.ifhmode||b.isLet&&b.original===Ce.defs.primitive.ifhmode||b===Ce.defs.primitive.ifinner||b.isLet&&b.original===Ce.defs.primitive.ifinner||b===Ce.defs.primitive.ifmmode||b.isLet&&b.original===Ce.defs.primitive.ifmmode||b===Ce.defs.primitive.iftrue||b.isLet&&b.original===Ce.defs.primitive.iftrue||b===Ce.defs.primitive.ifvmode||b.isLet&&b.original===Ce.defs.primitive.ifvmode||b===Ce.defs.primitive.ifvoid||b.isLet&&b.original===Ce.defs.primitive.ifvoid||b===Ce.defs.primitive.ifx||b.isLet&&b.original===Ce.defs.primitive.ifx){if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]===c&&c.invalid){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}else{if(b===Ce.defs.primitive.noalign||b.proxy&&b.original===Ce.defs.primitive.noalign){e.mouth.preview().cat!=we.OPEN?(e.mouth.loadState(p),e.scopes.last().noAligns.push(null)):m=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]==-c&&c.invalid){e.mouth.loadState(p),e.scopes.last().noAligns.push(null);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}}var u=Symbol();for(e.mouth.saveState(u);;){if(!(c=e.mouth.eat())){e.mouth.loadState(u);break}if("character"==c.type&&c.cat!=we.ACTIVE){e.mouth.loadState(u);break}if("command"==c.type||"character"==c.type&&c.cat==we.ACTIVE){if(c.name in e.scopes.last().registers.named){e.mouth.loadState(u);break}if(!(b="command"==c.type?e.scopes.last().defs.primitive[c.name]||e.scopes.last().defs.macros[c.name]:e.scopes.last().defs.active[c.char])){e.mouth.loadState(u);break}if(b===Ce.defs.primitive.the||b.proxy&&b.original===Ce.defs.primitive.the||b===Ce.defs.primitive.expandafter||b.proxy&&b.original===Ce.defs.primitive.expandafter||b===Ce.defs.primitive.number||b.proxy&&b.original===Ce.defs.primitive.number||b===Ce.defs.primitive.romannumeral||b.proxy&&b.original===Ce.defs.primitive.romannumeral||b===Ce.defs.primitive.csname||b.proxy&&b.original===Ce.defs.primitive.csname||b===Ce.defs.primitive.string||b.proxy&&b.original===Ce.defs.primitive.string||b===Ce.defs.primitive.if||b.isLet&&b.original===Ce.defs.primitive.if||b===Ce.defs.primitive.ifcase||b.isLet&&b.original===Ce.defs.primitive.ifcase||b===Ce.defs.primitive.ifcat||b.isLet&&b.original===Ce.defs.primitive.ifcat||b===Ce.defs.primitive.ifdim||b.isLet&&b.original===Ce.defs.primitive.ifdim||b===Ce.defs.primitive.ifeof||b.isLet&&b.original===Ce.defs.primitive.ifeof||b===Ce.defs.primitive.iffalse||b.isLet&&b.original===Ce.defs.primitive.iffalse||b===Ce.defs.primitive.ifodd||b.isLet&&b.original===Ce.defs.primitive.ifodd||b===Ce.defs.primitive.ifnum||b.isLet&&b.original===Ce.defs.primitive.ifnum||b===Ce.defs.primitive.ifhmode||b.isLet&&b.original===Ce.defs.primitive.ifhmode||b===Ce.defs.primitive.ifinner||b.isLet&&b.original===Ce.defs.primitive.ifinner||b===Ce.defs.primitive.ifmmode||b.isLet&&b.original===Ce.defs.primitive.ifmmode||b===Ce.defs.primitive.iftrue||b.isLet&&b.original===Ce.defs.primitive.iftrue||b===Ce.defs.primitive.ifvmode||b.isLet&&b.original===Ce.defs.primitive.ifvmode||b===Ce.defs.primitive.ifvoid||b.isLet&&b.original===Ce.defs.primitive.ifvoid||b===Ce.defs.primitive.ifx||b.isLet&&b.original===Ce.defs.primitive.ifx){if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]===c&&c.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}else{if(b===Ce.defs.primitive.crcr||b.proxy&&b.original===Ce.defs.primitive.crcr)break;if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(u);break}if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]==-c&&c.invalid){e.mouth.loadState(u);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}}var f=Symbol();for(e.mouth.saveState(f);;){if(!(c=e.mouth.eat())){e.mouth.loadState(f);break}if("character"==c.type&&c.cat==we.CLOSE){if(~(a=e.scopes.last()).repeatPreambleAt)for(var v=Math.max.apply(Math,a.cellData.map(function(e){for(var t=0,i=0,a=e.length;i<a;i++)t+=e[i].span;return t})),g=a.tabSkips.slice(a.repeatPreambleAt+1,a.tabSkips.length),y=0;a.tabSkips.length<v+1;)a.tabSkips.push(g[y]),y=(y+1)%g.length;return e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"table",cellData:a.cellData,tabSkips:a.tabSkips,noAligns:a.noAligns}],superscript:null,subscript:null}),[]}if("character"==c.type&&c.cat!=we.ACTIVE){e.mouth.loadState(f);break}if("command"==c.type||"character"==c.type&&c.cat==we.ACTIVE){if(c.name in e.scopes.last().registers.named){e.mouth.loadState(f);break}if(!(b="command"==c.type?e.scopes.last().defs.primitive[c.name]||e.scopes.last().defs.macros[c.name]:e.scopes.last().defs.active[c.char])){e.mouth.loadState(f);break}if(b===Ce.defs.primitive.the||b.proxy&&b.original===Ce.defs.primitive.the||b===Ce.defs.primitive.expandafter||b.proxy&&b.original===Ce.defs.primitive.expandafter||b===Ce.defs.primitive.number||b.proxy&&b.original===Ce.defs.primitive.number||b===Ce.defs.primitive.romannumeral||b.proxy&&b.original===Ce.defs.primitive.romannumeral||b===Ce.defs.primitive.csname||b.proxy&&b.original===Ce.defs.primitive.csname||b===Ce.defs.primitive.string||b.proxy&&b.original===Ce.defs.primitive.string||b===Ce.defs.primitive.if||b.isLet&&b.original===Ce.defs.primitive.if||b===Ce.defs.primitive.ifcase||b.isLet&&b.original===Ce.defs.primitive.ifcase||b===Ce.defs.primitive.ifcat||b.isLet&&b.original===Ce.defs.primitive.ifcat||b===Ce.defs.primitive.ifdim||b.isLet&&b.original===Ce.defs.primitive.ifdim||b===Ce.defs.primitive.ifeof||b.isLet&&b.original===Ce.defs.primitive.ifeof||b===Ce.defs.primitive.iffalse||b.isLet&&b.original===Ce.defs.primitive.iffalse||b===Ce.defs.primitive.ifodd||b.isLet&&b.original===Ce.defs.primitive.ifodd||b===Ce.defs.primitive.ifnum||b.isLet&&b.original===Ce.defs.primitive.ifnum||b===Ce.defs.primitive.ifhmode||b.isLet&&b.original===Ce.defs.primitive.ifhmode||b===Ce.defs.primitive.ifinner||b.isLet&&b.original===Ce.defs.primitive.ifinner||b===Ce.defs.primitive.ifmmode||b.isLet&&b.original===Ce.defs.primitive.ifmmode||b===Ce.defs.primitive.iftrue||b.isLet&&b.original===Ce.defs.primitive.iftrue||b===Ce.defs.primitive.ifvmode||b.isLet&&b.original===Ce.defs.primitive.ifvmode||b===Ce.defs.primitive.ifvoid||b.isLet&&b.original===Ce.defs.primitive.ifvoid||b===Ce.defs.primitive.ifx||b.isLet&&b.original===Ce.defs.primitive.ifx){if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]===c&&c.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}else{if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(f);break}if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]==-c&&c.invalid){e.mouth.loadState(f);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}}var b,w,x=Symbol();for(e.mouth.saveState(x),e.scopes.last().cellData.push([{type:"cell",content:[],omit:!1,span:1}]);;){if(!(c=e.mouth.eat())){e.mouth.loadState(x);break}if("character"==c.type&&c.cat!=we.ACTIVE){e.mouth.loadState(x);break}if("command"==c.type||"character"==c.type&&c.cat==we.ACTIVE){if(c.name in e.scopes.last().registers.named){e.mouth.loadState(x);break}if(!(b="command"==c.type?e.scopes.last().defs.primitive[c.name]||e.scopes.last().defs.macros[c.name]:e.scopes.last().defs.active[c.char])){e.mouth.loadState(x);break}if(b===Ce.defs.primitive.the||b.proxy&&b.original===Ce.defs.primitive.the||b===Ce.defs.primitive.expandafter||b.proxy&&b.original===Ce.defs.primitive.expandafter||b===Ce.defs.primitive.number||b.proxy&&b.original===Ce.defs.primitive.number||b===Ce.defs.primitive.romannumeral||b.proxy&&b.original===Ce.defs.primitive.romannumeral||b===Ce.defs.primitive.csname||b.proxy&&b.original===Ce.defs.primitive.csname||b===Ce.defs.primitive.string||b.proxy&&b.original===Ce.defs.primitive.string||b===Ce.defs.primitive.if||b.isLet&&b.original===Ce.defs.primitive.if||b===Ce.defs.primitive.ifcase||b.isLet&&b.original===Ce.defs.primitive.ifcase||b===Ce.defs.primitive.ifcat||b.isLet&&b.original===Ce.defs.primitive.ifcat||b===Ce.defs.primitive.ifdim||b.isLet&&b.original===Ce.defs.primitive.ifdim||b===Ce.defs.primitive.ifeof||b.isLet&&b.original===Ce.defs.primitive.ifeof||b===Ce.defs.primitive.iffalse||b.isLet&&b.original===Ce.defs.primitive.iffalse||b===Ce.defs.primitive.ifodd||b.isLet&&b.original===Ce.defs.primitive.ifodd||b===Ce.defs.primitive.ifnum||b.isLet&&b.original===Ce.defs.primitive.ifnum||b===Ce.defs.primitive.ifhmode||b.isLet&&b.original===Ce.defs.primitive.ifhmode||b===Ce.defs.primitive.ifinner||b.isLet&&b.original===Ce.defs.primitive.ifinner||b===Ce.defs.primitive.ifmmode||b.isLet&&b.original===Ce.defs.primitive.ifmmode||b===Ce.defs.primitive.iftrue||b.isLet&&b.original===Ce.defs.primitive.iftrue||b===Ce.defs.primitive.ifvmode||b.isLet&&b.original===Ce.defs.primitive.ifvmode||b===Ce.defs.primitive.ifvoid||b.isLet&&b.original===Ce.defs.primitive.ifvoid||b===Ce.defs.primitive.ifx||b.isLet&&b.original===Ce.defs.primitive.ifx){if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]===c&&c.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}else{if(b===Ce.defs.primitive.omit||b.proxy&&b.original===Ce.defs.primitive.omit){e.scopes.last().cellData[e.scopes.last().cellData.length-1][0].omit=!0;break}if("primitive"==b.type||b.proxy&&"primitive"==b.original.type){e.mouth.loadState(x);break}if(1==(w=e.mouth.expand(c,e.mouth)).length&&w[0]==-c&&c.invalid){e.mouth.loadState(x);break}e.mouth.queue.unshift.apply(e.mouth.queue,w)}}}a=e.scopes.last();if(e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope,e.scopes.last().isHalignCell=!0,e.scopes.last().noAligned=m,a.cellData[a.cellData.length-1][0].omit)return[];for(o=[],r=0,n=(d=a.preamble[0][0]).length;r<n;r++){var k,c={};for(k in d[r])c[k]=d[r][k];o.push(c)}return o}),crcr:new g("crcr",null),csname:new g("csname",function(e){var t=Symbol();e.mouth.saveState(t);for(var i=[];;){var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if(0!=i.length||a.cat!=we.WHITESPACE)if("command"==a.type||"character"==a.type&&a.cat==we.ACTIVE){if(a.name in e.scopes.last().registers.named)return this.invalid=!0,e.mouth.loadState(t),[this];var s,r="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:e.scopes.last().defs.active[a.char];if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if((r=r.proxy?r.original:r)===Ce.defs.primitive.endcsname)break;if(r!==Ce.defs.primitive.the&&r!==Ce.defs.primitive.expandafter&&r!==Ce.defs.primitive.number&&r!==Ce.defs.primitive.romannumeral&&r!==Ce.defs.primitive.csname&&r!==Ce.defs.primitive.string&&r!==Ce.defs.primitive.if&&r!==Ce.defs.primitive.ifcase&&r!==Ce.defs.primitive.ifcat&&r!==Ce.defs.primitive.ifdim&&r!==Ce.defs.primitive.ifeof&&r!==Ce.defs.primitive.iffalse&&r!==Ce.defs.primitive.ifodd&&r!==Ce.defs.primitive.ifnum&&r!==Ce.defs.primitive.ifhmode&&r!==Ce.defs.primitive.ifinner&&r!==Ce.defs.primitive.ifmmode&&r!==Ce.defs.primitive.iftrue&&r!==Ce.defs.primitive.ifvmode&&r!==Ce.defs.primitive.ifvoid&&r!==Ce.defs.primitive.ifx){if(r instanceof g)return this.invalid=!0,e.mouth.loadState(t),[this];if(1==(s=e.mouth.expand(a,e.mouth)).length&&s[0]===a&&s[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,s)}else{if(1==(s=e.mouth.expand(a,e.mouth)).length&&s[0]===a&&s[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,s)}}else i.push(a)}return[{type:"command",nameType:"command",escapeChar:String.fromCharCode(e.scopes.last().registers.named.escapechar.value),name:i.map(function(e){return e.char}).join("")}]}),day:new g("day",function(e){return[new xe((new Date).getDate())]}),def:new g("def",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||Ce.parameters.includes(a)))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==we.OPEN){e.mouth.revert();break}if(o.cat==we.PARAMETER){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==we.OPEN)n=!0,e.mouth.revert(),s.push({type:"character",cat:we.OPEN,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==we.OTHER&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1;;){if(!(o=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=we.PARAMETER||d)if("character"==o.type&&o.cat==we.OPEN)c++;else if("character"==o.type&&o.cat==we.CLOSE){if(0==--c)break}else d=d&&!1;else{var p=e.mouth.eat("pre space");if(!p||!(p.cat==we.PARAMETER||p.cat==we.OTHER&&p.char<=s.length&&1<=p.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),p.cat==we.PARAMETER&&(d=!0)}h.push(o)}h.shift(),n&&h.push(s[s.length-1]);var m=new b(h,s);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){Ce.defs.macros[a]=m,delete Ce.registers.named[a];for(var u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.macros[a]=m,delete e.scopes[u].registers[a]}else{Ce.defs.active[a]=m,delete Ce.registers.named[a];for(u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.ative[a]=m,delete e.scopes[u].registers[a]}else e.scopes.last().defs["macro"==i?"macros":"active"][a]=m,delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),dimen:new g("dimen",function(e){var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!Ce.registers.dimen[t.value]){Ce.registers.dimen[t.value]=new Ge(0,0);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.dimen[t.value]=new Ge((i?e.scopes[i-1]:Ce).registers.dimen[t.value])}return[e.scopes.last().registers.dimen[t.value]]}),dimendef:new g("dimendef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==we.OTHER||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!Ce.registers.dimen[s]){Ce.registers.dimen[s]=new Ge(0,0);for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.dimen[s]=new Ge((r?e.scopes[r-1]:Ce).registers.dimen[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.registers.named[i]=Ce.registers.dimen[s],delete Ce.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.dimen[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.dimen[s],delete e.scopes.last().defs.macros[i]}),displaylimits:new g("displaylimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:"display",token:this}),[])}),displaystyle:new g("displaystyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"displaystyle"}),[])}),divide:new g("divide",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=we.ACTIVE)){if(i&&i.register){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==we.ACTIVE){if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=we.ACTIVE||e.mouth.revert(2)}s=e.mouth.eat("integer");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value=~~(i.value/s.value);var r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=r.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value=~~(i.sp.value/s.value),i.em.value=~~(i.em.value/s.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=r.sp.value,i.em.value=r.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value=~~(i.mu.value/s.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=r.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value=~~(i.start.sp.value/s.value),i.start.em.value=~~(i.start.em.value/s.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/s.value):(i.stretch.sp.value=~~(i.stretch.sp.value/s.value),i.stretch.em.value=~~(i.stretch.em.value/s.value)),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/s.value):(i.shrink.sp.value=~~(i.shrink.sp.value/s.value),i.shrink.em.value=~~(i.shrink.em.value/s.value));r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=r.start.sp.value,i.start.em.value=r.start.em.value,"infinite dimension"==r.stretch.type?i.stretch=new Ee(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new Ge(r.stretch.sp.value,r.stretch.em.value),"infinite dimension"==r.shrink.type?i.shrink=new Ee(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new Ge(r.shrink.sp.value,r.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value=~~(i.start.mu.value/s.value),"infinite dimension"==i.stretch.type?i.stretch.number.value=~~(i.stretch.number.value/s.value):i.stretch.mu.value=~~(i.stretch.mu.value/s.value),"infinite dimension"==i.shrink.type?i.shrink.number.value=~~(i.shrink.number.value/s.value):i.shrink.mu.value=~~(i.shrink.mu.value/s.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=r.start.mu.value,"infinite dimension"==r.stretch.type?i.stretch=new Ee(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new ke(r.stretch.mu.value),"infinite dimension"==r.shrink.type?i.shrink=new Ee(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new ke(r.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}return[]}),edef:new g("edef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in Ce.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==we.OPEN){e.mouth.revert();break}if(o.cat==we.PARAMETER){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==we.OPEN)n=!0,e.mouth.revert(),s.push({type:"character",cat:we.OPEN,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==we.OTHER&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1,p=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=we.PARAMETER||p)if("character"==o.type&&o.cat==we.OPEN)c++,h.push(o),d=!1;else if("character"==o.type&&o.cat==we.CLOSE){if(0==--c)break;h.push(o),d=!1}else if(d)h.push(o),d=!1;else if("command"==o.type||"character"==o.type&&o.cat==we.ACTIVE)if(o.name in e.scopes.last().registers.named)h.push(o);else{if(!(u="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(u===Ce.defs.primitive.the||u.proxy&&u.original===Ce.defs.primitive.the||u===Ce.defs.primitive.expandafter||u.proxy&&u.original===Ce.defs.primitive.expandafter||u===Ce.defs.primitive.number||u.proxy&&u.original===Ce.defs.primitive.number||u===Ce.defs.primitive.romannumeral||u.proxy&&u.original===Ce.defs.primitive.romannumeral||u===Ce.defs.primitive.csname||u.proxy&&u.original===Ce.defs.primitive.csname||u===Ce.defs.primitive.string||u.proxy&&u.original===Ce.defs.primitive.string||u===Ce.defs.primitive.if||u.isLet&&u.original===Ce.defs.primitive.if||u===Ce.defs.primitive.ifcase||u.isLet&&u.original===Ce.defs.primitive.ifcase||u===Ce.defs.primitive.ifcat||u.isLet&&u.original===Ce.defs.primitive.ifcat||u===Ce.defs.primitive.ifdim||u.isLet&&u.original===Ce.defs.primitive.ifdim||u===Ce.defs.primitive.ifeof||u.isLet&&u.original===Ce.defs.primitive.ifeof||u===Ce.defs.primitive.iffalse||u.isLet&&u.original===Ce.defs.primitive.iffalse||u===Ce.defs.primitive.ifodd||u.isLet&&u.original===Ce.defs.primitive.ifodd||u===Ce.defs.primitive.ifnum||u.isLet&&u.original===Ce.defs.primitive.ifnum||u===Ce.defs.primitive.ifhmode||u.isLet&&u.original===Ce.defs.primitive.ifhmode||u===Ce.defs.primitive.ifinner||u.isLet&&u.original===Ce.defs.primitive.ifinner||u===Ce.defs.primitive.ifmmode||u.isLet&&u.original===Ce.defs.primitive.ifmmode||u===Ce.defs.primitive.iftrue||u.isLet&&u.original===Ce.defs.primitive.iftrue||u===Ce.defs.primitive.ifvmode||u.isLet&&u.original===Ce.defs.primitive.ifvmode||u===Ce.defs.primitive.ifvoid||u.isLet&&u.original===Ce.defs.primitive.ifvoid||u===Ce.defs.primitive.ifx||u.isLet&&u.original===Ce.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m)}else u===Ce.defs.primitive.noexpand||u.proxy&&u.original===Ce.defs.primitive.noexpand?d=!0:u instanceof g||u.proxy&&u.original instanceof g?h.push(o):e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{m=e.mouth.eat("pre space");if(!m||!(m.cat==we.PARAMETER||m.cat==we.OTHER&&m.char<=s.length&&1<=m.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),m.cat==we.PARAMETER&&(p=!0),h.push(o),d=!1}}h.shift(),n&&h.push(s[s.length-1]);var u=new b(h,s);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){Ce.defs.macros[a]=u,delete Ce.registers.named[a];for(var f=0,v=e.scopes.length;f<v;f++)e.scopes[f].defs.macros[a]=u,delete e.scopes[f].registers.named[a]}else{Ce.defs.active[a]=u,delete Ce.registers.named[a];for(f=0,v=e.scopes.length;f<v;f++)e.scopes[f].defs.ative[a]=u,delete e.scopes[f].registers.named[a]}else e.scopes.last().defs["macro"==i?"macros":"active"][a]=u,delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),else:new g("else",function(e){return T(this)}),endcsname:new g("endcsname",function(e){return T(this)}),endgroup:new g("endgroup",function(e){if(!e.openGroups.length||e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||!e.scopes.last().semisimple||"scope"!=e.contexts.last)return this.invalid=!0,[this];e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.openGroups.pop(),e.contexts.pop();var t=e.scopes.last().tokens;e.scopes.last().isFrac?(e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:0,nucleus:[{type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:t,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:t,superscript:null,subscript:null}))}),Error:new g("Error",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==we.OPEN){for(var i,a=0,s=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==we.OPEN)a++,s.push(i.char);else if("character"==i.type&&i.cat==we.CLOSE){if(!a)break;a--,s.push(i.char)}else"command"==i.type?(s.push(i.escapeChar),s.push.apply(s,i.name.split(""))):s.push(i.char)}return s.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),expandafter:new g("expandafter",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a=e.mouth.eat(),s=e.mouth.expand(a,e.mouth);return 1==s.length&&s[0]===a&&a.invalid?(this.invalid=!0,e.mouth.loadState(t),[this]):[i].concat(s)}),ExpandedError:new g("ExpandedError",function(e){var t=Symbol();if(e.mouth.saveState(t),(i=e.mouth.eat())&&"character"==i.type&&i.cat==we.OPEN){for(var i,a=0,s=[],r=!1;;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==we.OPEN)a++,s.push(i.char),r=!1;else if("character"==i.type&&i.cat==we.CLOSE){if(!a)break;a--,s.push(i.char),r=!1}else if("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE){var n,l="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:e.scopes.last().defs.active[i.char];if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if((l=l.proxy?l.original:l)!==Ce.defs.primitive.noexpand)if(r||l!==Ce.defs.primitive.the&&l!==Ce.defs.primitive.expandafter&&l!==Ce.defs.primitive.number&&l!==Ce.defs.primitive.romannumeral&&l!==Ce.defs.primitive.csname&&l!==Ce.defs.primitive.string&&l!==Ce.defs.primitive.if&&l!==Ce.defs.primitive.ifcase&&l!==Ce.defs.primitive.ifcat&&l!==Ce.defs.primitive.ifdim&&l!==Ce.defs.primitive.ifeof&&l!==Ce.defs.primitive.iffalse&&l!==Ce.defs.primitive.ifodd&&l!==Ce.defs.primitive.ifnum&&l!==Ce.defs.primitive.ifhmode&&l!==Ce.defs.primitive.ifinner&&l!==Ce.defs.primitive.ifmmode&&l!==Ce.defs.primitive.iftrue&&l!==Ce.defs.primitive.ifvmode&&l!==Ce.defs.primitive.ifvoid&&l!==Ce.defs.primitive.ifx)if(l instanceof g)s.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),s.push.apply(s,l.name.split("")),r=!1;else{if(r)s.push(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)),s.push.apply(s,i.name.split(""));else{if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n)}r=!1}else{if(1==(n=e.mouth.expand(i,e.mouth)).length&&n[0]===i&&n[0].invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,n),r=!1}else r=!0}else s.push(i.char),r=!1}return s.map(function(e){return{type:"character",char:e,code:e.charCodeAt(0),cat:12,invalid:!0,recognized:!0}})}return this.invalid=!0,[this]}),fi:new g("fi",function(e){return T(this)}),futurelet:new g("futurelet",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in Ce.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==we.OTHER||s&&e.mouth.revert();var r=e.mouth.eat();if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];s=e.mouth.eat();if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==s.type||"character"==s.type&&s.cat==we.ACTIVE){if(c="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.name])c=new b(c,"primitive"==c.type||c.isLet);else if("command"==s.type&&"macro"==i){var n=e.scopes.last().registers.named[s.name];if(n){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.registers.named[a]=n,delete Ce.defs.macros[a];for(var l=0,o=e.scopes.length;l<o;l++)e.scopes[l].registers.named[a]=n,delete e.scopes[l].defs.macros[a]}else e.scopes.last().registers.named[a]=n,delete e.scopes.last().defs.macros[a];return e.toggles.global=!1,[]}}}else var c=new b(new b([s]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){c?Ce.defs.macros[a]=c:delete Ce.defs.macros[a],delete Ce.registers.named[a];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.macros[a]=c:delete e.scopes[l].defs.macros[a],delete e.scopes[l].registers.named[a]}else{c?Ce.defs.active[a]=c:delete e.scopes[l].defs.macros[a],delete Ce.registers.named[a];for(l=0,o=e.scopes.length;l<o;l++)c?e.scopes[l].defs.ative[a]=c:delete e.scopes[l].defs.macros[a],delete e.scopes[l].registers.named[a]}else c?e.scopes.last().defs["macro"==i?"macros":"active"][a]=c:delete e.scopes.last().defs["macro"==i?"macros":"active"][a],delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[r,s]}),gdef:new g("gdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in Ce.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==we.OPEN){e.mouth.revert();break}if(o.cat==we.PARAMETER){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==we.OPEN)n=!0,e.mouth.revert(),s.push({type:"character",cat:we.OPEN,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==we.OTHER&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=we.PARAMETER||d){if("character"==o.type&&o.cat==we.OPEN)c++;else if("character"==o.type&&o.cat==we.CLOSE&&0==--c)break}else{var p=e.mouth.eat("pre space");if(!p||!(p.cat==we.PARAMETER||p.cat==we.OTHER&&p.char<=s.length&&1<=p.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),p.cat==we.PARAMETER&&(d=!0)}h.push(o)}h.shift(),n&&h.push(s[s.length-1]);var m=new b(h,s);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][a]=m,delete e.scopes.last().registers.named[a];else if("macro"==i){Ce.defs.macros[a]=m,delete Ce.registers.named[a];for(var u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.macros[a]=m,delete e.scopes[u].registers.named[a]}else{Ce.defs.active[a]=m,delete Ce.registers.named[a];for(u=0,f=e.scopes.length;u<f;u++)e.scopes[u].defs.ative[a]=m,delete e.scopes[u].registers.named[a]}return e.toggles.global=!1,[]}),global:new g("global",function(e){return"superscript"==e.lastContext.type||"subscript"==e.lastContext.type?T(this):((e.toggles.global=this).ignore=!0,[this])}),halign:new g("halign",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=we.OPEN)return e.mouth.loadState(t),T(this);for(var a=[[[]]],s=-1,r=[new Xe(e.lastScope.registers.named.tabskip)],n=!1;;){var l=e.mouth.eat("pre space");if(!l)return e.mouth.loadState(t),T(this);if(f(l)){var o="command"==l.type?e.lastScope.defs.primitive[l.name]||e.lastScope.defs.macros[l.name]||e.lastScope.registers.named[l.name]:e.lastScope.defs.active[l.char];if(!(o=o&&o.proxy?o.original:o)){(a[a.length-1][1]||a[a.length-1][0]).push(l);continue}if(o===Ce.defs.primitive.cr){if(a[a.length-1][1]){r.push(new Xe(e.lastScope.registers.named.tabskip));var c=n||r[0],h=e.lastScope.registers.named.tabskip;h.start.sp.value=c.start.sp.value,h.start.em.value=c.start.em.value,"infinite dimension"==c.stretch.type?h.stretch=new Ee(c.stretch.number.value,c.stretch.magnitude.value):h.stretch=new Ge(c.stretch.sp.value,c.stretch.em.value),"infinite dimension"==c.shrink.type?h.shrink=new Ee(c.shrink.number.value,c.shrink.magnitude.value):h.shrink=new Ge(c.shrink.sp.value,c.shrink.em.value);break}return e.mouth.loadState(t),T(this)}if(o===e.lastScope.registers.named.tabskip){var d=Symbol();e.mouth.saveState(d),v();var p=e.mouth.eat("glue");if(!p){e.mouth.loadState(d),(a[a.length-1][1]||a[a.length-1][0]).push(l);continue}var m=e.lastScope.registers.named.tabskip;if(m.start.sp.value=p.start.sp.value,m.start.em.value=p.start.em.value,"infinite dimension"==p.stretch.type?m.stretch=new Ee(p.stretch.number.value,p.stretch.magnitude.value):m.stretch=new Ge(p.stretch.sp.value,p.stretch.em.value),"infinite dimension"==p.shrink.type?m.shrink=new Ee(p.shrink.number.value,p.shrink.magnitude.value):m.shrink=new Ge(p.shrink.sp.value,p.shrink.em.value),0<e.lastScope.registers.named.globaldefs.value)for(n=new Xe(m);m.parent;)(m=m.parent).start.sp.value=p.start.sp.value,m.start.em.value=p.start.em.value,"infinite dimension"==p.stretch.type?m.stretch=new Ee(p.stretch.number.value,p.stretch.magnitude.value):m.stretch=new Ge(p.stretch.sp.value,p.stretch.em.value),"infinite dimension"==p.shrink.type?r.shrink=new Ee(p.shrink.number.value,p.shrink.magnitude.value):m.shrink=new Ge(p.shrink.sp.value,p.shrink.em.value);continue}if(o===Ce.defs.primitive.span){c=e.mouth.eat();if(!c)return e.mouth.loadState(t),T(this);d=e.mouth.expand(c,e.mouth);if(1==d.length&&d[0]===c&&c.invalid)return e.mouth.loadState(t),T(this);e.mouth.queue.unshift.apply(e.mouth.queue,d);continue}if(o.replacement&&o.replacement[0]&&o.replacement[0].cat==we.PARAMETER){if(a[a.length-1][1])return e.mouth.loadState(t),T(this);a[a.length-1][1]=[];continue}if(o.replacement&&o.replacement[0]&&o.replacement[0].cat==we.ALIGN){if(~s||a[a.length-1][0].length||a[a.length-1][1]){if(!a[a.length-1][1])return e.mouth.loadState(t),T(this);a.push([[]]),r.push(new Xe(e.lastScope.registers.named.tabskip))}else s=a.length-1;continue}}else{if(l.cat==we.PARAMETER){if(a[a.length-1][1])return e.mouth.loadState(t),T(this);a[a.length-1][1]=[];continue}if(l.cat==we.ALIGN){if(~s||a[a.length-1][0].length||a[a.length-1][1]){if(!a[a.length-1][1])return e.mouth.loadState(t),T(this);a.push([[]]),r.push(new Xe(e.lastScope.registers.named.tabskip))}else s=a.length-1;continue}if(l.cat==we.WHITESPACE&&!a[a.length-1][0].length&&!a[a.length-1][1])continue}(a[a.length-1][1]||a[a.length-1][0]).push(l)}var u={type:"atom",atomType:ze.ORD,nucleus:("command"==this.type?this.escapeChar+this.name:this.char).split("").map(function(e){return{type:"atom",atomType:ze.ORD,nucleus:{type:"symbol",char:e,code:e.codePointAt(0)},superscript:null,subscript:null}}),superscript:null,subscript:null,ignore:!0};e.openGroups.push(u),e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope;i=e.scopes[e.scopes.length-1];return i.tokens.push(u),i.isHalign=!0,i.cellData=[],i.preamble=a,i.repeatPreambleAt=s,i.tabSkips=r,i.noAligns=[],e.mouth.revert(),[]}),hbox:new g("hbox",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t,i,a=Symbol();for(e.mouth.saveState(a);;){var s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("command"!=s.type&&("character"!=s.type||s.cat!=we.ACTIVE)){if("character"!=s.type||"t"!=s.char&&"T"!=s.char){if("character"!=s.type||"s"!=s.char&&"S"!=s.char){if("character"!=s.type||s.cat!=we.OPEN)return this.invalid=!0,e.mouth.loadState(a),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==we.ACTIVE||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==we.ACTIVE||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==we.ACTIVE||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==we.ACTIVE||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==we.ACTIVE)return this.invalid=!0,e.mouth.loadState(a),[this];if(o=e.mouth.eat("dimension")){t=o;break}return this.invalid=!0,e.mouth.loadState(a),[this]}c=e.mouth.eat("pre space");if(!c||"character"!=c.type||"o"!=c.char&&"O"!=s.char||s.cat==we.ACTIVE)return this.invalid=!0,e.mouth.loadState(a),[this];if(o=e.mouth.eat("dimension")){i=o;break}return this.invalid=!0,e.mouth.loadState(a),[this]}c="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(c&&(c===Ce.defs.primitive.relax||c.proxy&&c.original===Ce.defs.primitive.relax))break;s=e.mouth.expand(s,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}var h=e.mouth.preview();return h&&"character"==h.type&&h.cat==we.OPEN?(i||t||(t=new Ge(0,0)),e.tokens.push({type:"box wrapper",value:"horizontal",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(a),[this])}),hfil:new g("hfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new Xe(new Ge(0),new Ee(65536,1),new Ge(0))}),[])}),hfill:new g("hfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",glue:new Xe(new Ge(0),new Ee(65536,2),new Ge(0))}),[])}),hrule:new g("hrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,a=!1,s=!1;;){var r=e.mouth.eat();if(!r)break;if("h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE){if("d"!=r.char&&"D"!=r.char||r.cat==we.ACTIVE){if("w"!=r.char&&"W"!=r.char||r.cat==we.ACTIVE){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return i=i||new Ge(0,65536/30),a=a||new Ge(0,0),e.tokens.push({type:"rule",ruleType:"h",height:i,depth:a,width:s}),[]}),hskip:new g("hskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),if:new g("if",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],a=!1;i.length<2;){var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=s.type||s.cat!=we.WHITESPACE||0!=i.length)if("character"==s.type&&i.cat!=we.ACTIVE)i.push(s),a=!1;else if(a)i.push(s),a=!1;else if("command"==s.type||"character"==s.type&&s.cat==we.ACTIVE)if(s.name in e.scopes.last().registers.named)i.push(s);else{var r,n="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===Ce.defs.primitive.the||n.proxy&&n.original===Ce.defs.primitive.the||n===Ce.defs.primitive.expandafter||n.proxy&&n.original===Ce.defs.primitive.expandafter||n===Ce.defs.primitive.number||n.proxy&&n.original===Ce.defs.primitive.number||n===Ce.defs.primitive.romannumeral||n.proxy&&n.original===Ce.defs.primitive.romannumeral||n===Ce.defs.primitive.csname||n.proxy&&n.original===Ce.defs.primitive.csname||n===Ce.defs.primitive.string||n.proxy&&n.original===Ce.defs.primitive.string||n===Ce.defs.primitive.if||n.isLet&&n.original===Ce.defs.primitive.if||n===Ce.defs.primitive.ifcase||n.isLet&&n.original===Ce.defs.primitive.ifcase||n===Ce.defs.primitive.ifcat||n.isLet&&n.original===Ce.defs.primitive.ifcat||n===Ce.defs.primitive.ifdim||n.isLet&&n.original===Ce.defs.primitive.ifdim||n===Ce.defs.primitive.ifeof||n.isLet&&n.original===Ce.defs.primitive.ifeof||n===Ce.defs.primitive.iffalse||n.isLet&&n.original===Ce.defs.primitive.iffalse||n===Ce.defs.primitive.ifodd||n.isLet&&n.original===Ce.defs.primitive.ifodd||n===Ce.defs.primitive.ifnum||n.isLet&&n.original===Ce.defs.primitive.ifnum||n===Ce.defs.primitive.ifhmode||n.isLet&&n.original===Ce.defs.primitive.ifhmode||n===Ce.defs.primitive.ifinner||n.isLet&&n.original===Ce.defs.primitive.ifinner||n===Ce.defs.primitive.ifmmode||n.isLet&&n.original===Ce.defs.primitive.ifmmode||n===Ce.defs.primitive.iftrue||n.isLet&&n.original===Ce.defs.primitive.iftrue||n===Ce.defs.primitive.ifvmode||n.isLet&&n.original===Ce.defs.primitive.ifvmode||n===Ce.defs.primitive.ifvoid||n.isLet&&n.original===Ce.defs.primitive.ifvoid||n===Ce.defs.primitive.ifx||n.isLet&&n.original===Ce.defs.primitive.ifx){if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]===s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else if(n===Ce.defs.primitive.noexpand||n.proxy&&n.original===Ce.defs.primitive.noexpand)a=!0;else if(n instanceof g||n.proxy&&n.original instanceof g)i.push(s);else{if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]==-s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}}else i.push(s)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].char==i[1].char,e.mouth,e.scopes,t)}),ifcase:new g("ifcase",function(i){if("superscript"==i.contexts.last||"subscript"==i.contexts.last)return this.invalid=!0,[this];var e=Symbol();i.mouth.saveState(e);var t=i.mouth.eat("integer");if(!t)return this.invalid=!0,[this];var a=[],s=!1;if((t=t.value)<0)l("else");else for(;0<t&&!s;t--)l("or");for(;;){var r=i.mouth.eat();if(!r)return this.invalid=!0,i.mouth.loadState(stateSymbol),[this];if("command"==r.type||"character"==r.type&&r.cat==we.ACTIVE){var n="command"==r.type?i.scopes.last().defs.primitive[r.name]||i.scopes.last().defs.macros[r.name]:i.scopes.last().defs.active[r.char];if(n&&(n===Ce.defs.primitive.fi||n.isLet&&n.original===Ce.defs.primitive.fi))return a;!s&&n&&(n===Ce.defs.primitive.or||n.isLet&&n.original===Ce.defs.primitive.or||n===Ce.defs.primitive.else||n.isLet&&n.original===Ce.defs.primitive.else)?l("fi"):(n=i.mouth.expand(r,i.mouth),i.mouth.queue.unshift.apply(i.mouth.queue,n))}else a.push(r)}function l(e){for(;;){var t=i.mouth.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===we.ACTIVE){t="command"==t.type?i.scopes.last().defs.primitive[t.name]||i.scopes.last().defs.macros[t.name]:i.scopes.last().defs.active[t.char];if(t)if(t===Ce.defs.primitive.if||t.isLet&&t.original===Ce.defs.primitive.if||t===Ce.defs.primitive.ifcase||t.isLet&&t.original===Ce.defs.primitive.ifcase||t===Ce.defs.primitive.ifcat||t.isLet&&t.original===Ce.defs.primitive.ifcat||t===Ce.defs.primitive.ifdim||t.isLet&&t.original===Ce.defs.primitive.ifdim||t===Ce.defs.primitive.ifeof||t.isLet&&t.original===Ce.defs.primitive.ifeof||t===Ce.defs.primitive.iffalse||t.isLet&&t.original===Ce.defs.primitive.iffalse||t===Ce.defs.primitive.ifodd||t.isLet&&t.original===Ce.defs.primitive.ifodd||t===Ce.defs.primitive.ifnum||t.isLet&&t.original===Ce.defs.primitive.ifnum||t===Ce.defs.primitive.ifhmode||t.isLet&&t.original===Ce.defs.primitive.ifhmode||t===Ce.defs.primitive.ifinner||t.isLet&&t.original===Ce.defs.primitive.ifinner||t===Ce.defs.primitive.ifmmode||t.isLet&&t.original===Ce.defs.primitive.ifmmode||t===Ce.defs.primitive.iftrue||t.isLet&&t.original===Ce.defs.primitive.iftrue||t===Ce.defs.primitive.ifvmode||t.isLet&&t.original===Ce.defs.primitive.ifvmode||t===Ce.defs.primitive.ifvoid||t.isLet&&t.original===Ce.defs.primitive.ifvoid||t===Ce.defs.primitive.ifx||t.isLet&&t.original===Ce.defs.primitive.ifx)l("fi"),i.mouth.eat();else{if("or"==e&&(t===Ce.defs.primitive.or||t.isLet&&t.original===Ce.defs.primitive.or))return;if(("or"==e||"else"==e)&&(t===Ce.defs.primitive.else||t.isLet&&t.original===Ce.defs.primitive.else))return void(s=!0);if(t===Ce.defs.primitive.fi||t.isLet&&t.original===Ce.defs.primitive.fi)return void i.mouth.revert()}}}}}),ifcat:new g("ifcat",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=[],a=!1;i.length<2;){var s=e.mouth.eat("pre space");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=s.type||s.cat!=we.WHITESPACE||0!=i.length)if("character"==s.type&&i.cat!=we.ACTIVE)i.push(s),a=!1;else if(a)i.push(s),a=!1;else if("command"==s.type||"character"==s.type&&s.cat==we.ACTIVE)if(s.name in e.scopes.last().registers.named)i.push(s);else{var r,n="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(!n)return this.invalid=!0,e.mouth.loadState(t),[this];if(n===Ce.defs.primitive.the||n.proxy&&n.original===Ce.defs.primitive.the||n===Ce.defs.primitive.expandafter||n.proxy&&n.original===Ce.defs.primitive.expandafter||n===Ce.defs.primitive.number||n.proxy&&n.original===Ce.defs.primitive.number||n===Ce.defs.primitive.romannumeral||n.proxy&&n.original===Ce.defs.primitive.romannumeral||n===Ce.defs.primitive.csname||n.proxy&&n.original===Ce.defs.primitive.csname||n===Ce.defs.primitive.string||n.proxy&&n.original===Ce.defs.primitive.string||n===Ce.defs.primitive.if||n.isLet&&n.original===Ce.defs.primitive.if||n===Ce.defs.primitive.ifcase||n.isLet&&n.original===Ce.defs.primitive.ifcase||n===Ce.defs.primitive.ifcat||n.isLet&&n.original===Ce.defs.primitive.ifcat||n===Ce.defs.primitive.ifdim||n.isLet&&n.original===Ce.defs.primitive.ifdim||n===Ce.defs.primitive.ifeof||n.isLet&&n.original===Ce.defs.primitive.ifeof||n===Ce.defs.primitive.iffalse||n.isLet&&n.original===Ce.defs.primitive.iffalse||n===Ce.defs.primitive.ifodd||n.isLet&&n.original===Ce.defs.primitive.ifodd||n===Ce.defs.primitive.ifnum||n.isLet&&n.original===Ce.defs.primitive.ifnum||n===Ce.defs.primitive.ifhmode||n.isLet&&n.original===Ce.defs.primitive.ifhmode||n===Ce.defs.primitive.ifinner||n.isLet&&n.original===Ce.defs.primitive.ifinner||n===Ce.defs.primitive.ifmmode||n.isLet&&n.original===Ce.defs.primitive.ifmmode||n===Ce.defs.primitive.iftrue||n.isLet&&n.original===Ce.defs.primitive.iftrue||n===Ce.defs.primitive.ifvmode||n.isLet&&n.original===Ce.defs.primitive.ifvmode||n===Ce.defs.primitive.ifvoid||n.isLet&&n.original===Ce.defs.primitive.ifvoid||n===Ce.defs.primitive.ifx||n.isLet&&n.original===Ce.defs.primitive.ifx){if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]===s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}else if(n===Ce.defs.primitive.noexpand||n.proxy&&n.original===Ce.defs.primitive.noexpand)a=!0;else if(n instanceof g||n.proxy&&n.original instanceof g)i.push(s);else{if(1==(r=e.mouth.expand(s,e.mouth)).length&&r[0]==-s&&s.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,r)}}else i.push(s)}return l.call(this,"command"==i[0].type&&"command"==i[1].type||"character"==i[0].type&&i[0].cat==i[1].cat,e.mouth,e.scopes,t)}),ifdim:new g("ifdim",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();if(e.mouth.saveState(t),!(i=e.mouth.eat("dimension")))return this.invalid=!0,[this];var i=i.sp.value+12*i.em.value,a=e.mouth.eat();if(!a||a.cat==we.ACTIVE&&("<"==a.char||"="==a.char||">"==a.char))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat("dimension");return s?(s=s.sp.value+12*s.em.value,l.call(this,"<"==a.char?i<s:"="==a.char?i==s:s<i,e.mouth,e.scopes,t)):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifeof:new g("ifeof",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iffalse:new g("iffalse",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifodd:new g("ifodd",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");return i?l.call(this,i.value%2==1,e.mouth,e.scopes,t):(this.invalid=!0,[this])}),ifnum:new g("ifnum",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("integer");if(!i)return this.invalid=!0,[this];var a=e.mouth.eat();if(!a||a.cat==we.ACTIVE&&("<"==a.char||"="==a.char||">"==a.char))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat("integer");return s?l.call(this,"<"==a.char?i.value<s.value:"="==a.char?i.value==s.value:i.value>s.value,e.mouth,e.scopes,t):(this.invalid=!0,e.mouth.loadState(t),[this])}),ifhmode:new g("ifhmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifinner:new g("ifinner",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,"inline"==e.style,e.mouth,e.scopes,t)}),ifmmode:new g("ifmmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),iftrue:new g("iftrue",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifvmode:new g("ifvmode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!1,e.mouth,e.scopes,t)}),ifvoid:new g("ifvoid",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();return e.mouth.saveState(t),l.call(this,!0,e.mouth,e.scopes,t)}),ifx:new g("ifx",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a=e.mouth.eat("pre space");if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];if((i="command"==i.type?e.scopes.last().defs.primitive[i.name]||e.scopes.last().defs.macros[i.name]:"character"==i.type&&i.cat==we.ACTIVE?e.scopes.last().defs.active[i.char]:i)&&i.proxy&&(i=i.original),(a="command"==a.type?e.scopes.last().defs.primitive[a.name]||e.scopes.last().defs.macros[a.name]:"character"==a.type&&a.cat==we.ACTIVE?e.scopes.last().defs.active[a.char]:a)&&a.proxy&&(a=a.original),!i&&!a)return l.call(this,!0,e.mouth,e.scopes,t);if(!i||!a||i.type!=a.type)return l.call(this,!1,e.mouth,e.scopes,t);if("character"==i.type)return l.call(this,i.char==a.char&&i.cat==a.cat,e.mouth,e.scopes,t);if("primitive"==i.type)return l.call(this,i===a,e.mouth,e.scopes,t);if(i.parameters.length!=a.parameters.length||i.replacement.length!=a.replacement.length)return l.call(this,!1,e.mouth,e.scopes,t);for(var s=0,r=i.parameters.length;s<r;s++)if(!("character"==i.parameters[s].type&&i.parameters[s].char==a.parameters[s].char&&i.parameters[s].cat==a.parameters[s].cat||"command"==i.parameters[s].type&&i.parameters[s].name==a.parameters[s].name))return l.call(this,!1,e.mouth,e.scopes,t);for(s=0,r=i.replacement.length;s<r;s++)if(!("character"==i.replacement[s].type&&i.replacement[s].char==a.replacement[s].char&&i.replacement[s].cat==a.replacement[s].cat||"command"==i.replacement[s].type&&i.replacement[s].name==a.replacement[s].name))return l.call(this,!1,e.mouth,e.scopes,t);return l.call(this,!0,e.mouth,e.scopes,t)}),it:new g("it",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"it"}),[])}),kern:new g("kern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),lccode:new g("lccode",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");return t&&0<t.value?[e.scopes.last().lc[t.value]=e.scopes.last().lc[t.value]||new xe(0)]:(this.invalid=!0,[this])}),left:new g("left",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=we.ACTIVE)){if(!i||"character"!=i.type||!Ce.delims.includes(i.code)||i.cat!=we.OTHER&&i.cat!=we.LETTER)return this.invalid=!0,e.mouth.loadState(t),[this];new e.Scope,e.scopes.last().delimited=!0,e.scopes.last().leftDelimiter=i.char,e.scopes.last().nullDelimiterSpace=new Ge(e.scopes.last().registers.named.nulldelimiterspace),e.openGroups.push(this),e.contexts.push({toString:function(){return"scope"},type:"scope"}),e.scopes.last().tokens.push(this),e.scopes.last().tokens.push({type:"atom",atomType:0,nucleus:{type:"symbol",char:i.char,code:i.code},subscript:null,superscript:null}),this.ignore=!0;break}i=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,i)}}),let:new g("let",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in Ce.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];var s=e.mouth.eat();s&&"character"==s.type&&"="==s.char&&s.cat==we.OTHER||s&&e.mouth.revert();s=e.mouth.eat();if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("command"==s.type||"character"==s.type&&s.cat==we.ACTIVE){if(o="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.name])o=new b(o,"primitive"==o.type||o.isLet);else if("command"==s.type&&"macro"==i){var r=e.scopes.last().registers.named[s.name];if(r){if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.registers.named[a]=r,delete Ce.defs.macros[a];for(var n=0,l=e.scopes.length;n<l;n++)e.scopes[n].registers.named[a]=r,delete e.scopes[n].defs.macros[a]}else e.scopes.last().registers.named[a]=r,delete e.scopes.last().defs.macros[a];return e.toggles.global=!1,[]}}}else var o=new b(new b([s]),!0);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)if("macro"==i){o?Ce.defs.macros[a]=o:delete Ce.defs.macros[a],delete Ce.registers.named[a];for(n=0,l=e.scopes.length;n<l;n++)o?e.scopes[n].defs.macros[a]=o:delete e.scopes[n].defs.macros[a],delete e.scopes[n].registers.named[a]}else{o?Ce.defs.active[a]=o:delete Ce.defs.active[a],delete Ce.registers.named[a];for(n=0,l=e.scopes.length;n<l;n++)o?e.scopes[n].defs.active[a]=o:delete e.scopes[n].defs.active[a],delete e.scopes[n].registers[a]}else o?e.scopes.last().defs["macro"==i?"macros":"active"][a]=o:delete e.scopes.last().defs["macro"==i?"macros":"active"][a],delete e.scopes.last().registers.named[a];return e.toggles.global=!1,[]}),limits:new g("limits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!0,token:this}),[])}),lower:new g("lower",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(t.sp.value*=-1,t.em.value*=-1,e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),lowercase:new g("lowercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat("pre space");if(!i||i.cat!=we.OPEN)return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],s=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==we.OPEN)s++,a.push(r);else if("character"==r.type&&r.cat==we.CLOSE){if(!(0<--s))break;a.push(r)}else a.push(r)}for(var n=0,l=a.length;n<l;n++)"character"==a[n].type&&e.scopes.last().lc[a[n].code]&&0<e.scopes.last().lc[a[n].code].value&&(a[n].code=e.scopes.last().lc[a[n].code].value,a[n].char=String.fromCharCode(a[n].code));return a}),mathbin:new g("mathbin",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:2,token:this}),[])}),mathchar:new g("mathchar",function(e){var t,i,a=e.mouth.eat("integer");return!a||a.value<0?(this.invalid=!0,[this]):(!(a.value<65536)&&a.value<524288?(t=a.value%65536,i=(a.value-t)/65536,a.value=t):i=0,e.mouth.queue.unshift({type:"character",cat:we.OTHER,char:String.fromCharCode(a.value),code:a.value,forcedMathCode:i}),[])}),mathchardef:new g("mathchardef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"command"!=i.type)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==we.OTHER||a&&e.mouth.revert();var s,a=e.mouth.eat("integer");if(!a||a.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];!(a.value<65536)&&a.value<524288?(t=a.value%65536,s=(a.value-t)/65536,a.value=t):s=0;var r=new b([{type:"character",cat:we.OTHER,char:String.fromCharCode(a.value),code:a.value,forcedMathCode:s}],[]);if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.defs.macros[i.name]=r,delete Ce.registers.named[i.name];for(var n=0,l=e.scopes.length;n<l;n++)e.scopes[n].defs.macros[i.name]=r,delete e.scopes[n].registers.named[i.name]}else e.scopes.last().defs.macros[i.name]=r,delete e.scopes.last().registers.named[i.name];e.toggles.global=!1}),mathchoice:new g("mathchoice",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t={type:"command",nameType:"command",escapeChar:this.escapeChar,name:"mathchoice",recognized:!0};e.contexts.push({toString:function(){return"mathchoice"},type:"mathchoice",token:t,current:0,failed:function(){this.token.invalid=!0,e.contexts.pop()},succeeded:function(){e.contexts.pop(),this.token.type="mathchoice",this.token.groups=e.scopes.last().tokens.splice(e.scopes.last().tokens.length-4,4),this.token.ignore=!1}}),e.tokens.push(t),t.ignore=!0}),mathclose:new g("mathclose",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:5,token:this}),[])}),mathcode:new g("mathcode",function(e){if("superscript"==e.lastContext.type||"subscript"==e.lastContext.type)return T(this);var t=e.mouth.eat("integer");if(t&&0<=t.value){if(!(t.value in Ce.mathcodes)){Ce.mathcodes[t.value]=new xe(ze.ORD,0,8);for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].mathcodes[t.value]=new xe((0==i?Ce:e.scopes[i-1]).mathcodes[t.value])}return[e.lastScope.mathcodes[t.value]]}return T(this)}),mathinner:new g("mathinner",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"inner",token:this}),[])}),mathop:new g("mathop",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:1,token:this}),[])}),mathopen:new g("mathopen",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:4,token:this}),[])}),mathord:new g("mathord",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:0,token:this}),[])}),mathpunct:new g("mathpunct",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:6,token:this}),[])}),mathrel:new g("mathrel",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:3,token:this}),[])}),meaning:new g("meaning",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];e.mouth.string;var t=e.mouth.eat();if(!t)return this.invalid=!0,[this];var i="",a=!1;if("command"==t.type||"character"==t.type&&t.cat==we.ACTIVE){var s="command"==t.type?e.scopes[e.scopes.length-1].defs.primitive[t.name]||e.scopes[e.scopes.length-1].defs.macros[t.name]:e.scopes[e.scopes.length-1].defs.active[t.char];if(s)if("primitive"==s.type||s.isLet&&"primitive"==s.original.type)i+="".concat(t.escapeChar).concat(t.name,"=").concat(String.fromCodePoint(e.scopes[e.scopes.length-1].registers.named.escapechar.value)).concat((s.original||s).name),a=!0;else if(s.isLet)i+="".concat(t.escapeChar+t.name||t.char,"="),t=s.original.replacement[0];else{s.proxy&&(s=s.original),i+="".concat(t.escapeChar+t.name||t.char,"=macro:\n");for(var r=0,n=0,l=s.parameters.length;n<l;n++)"character"==s.parameters[n].type&&s.parameters[n].cat!=we.PARAMETER?i+=s.parameters[n].char:"character"==s.parameters[n].type?i+=s.parameters[n].char+ ++r:i+=s.parameters[n].escapeChar+s.parameters[n].name;i+="->";for(var o=0,c=s.replacement.length;o<c;o++)i+="character"==s.replacement[o].type?s.replacement[o].char:s.replacement[o].escapeChar+s.replacement[o].name;a=!0}else i+="".concat(t.escapeChar).concat(t.name,"=undefined."),a=!0}if(!a)switch(t.cat){case we.OPEN:i+="begin-group character ".concat(t.char,".");break;case we.CLOSE:i+="end-group character ".concat(t.char,".");break;case we.MATHSHIFT:i+="math shift character ".concat(t.char,".");break;case we.ALIGN:i+="alignment tab character ".concat(t.char,".");break;case we.PARAMETER:i+="macro parameter character ".concat(t.char,".");break;case we.SUPERSCRIPT:i+="superscript character ".concat(t.char,".");break;case we.SUBSCRIPT:i+="subscript character ".concat(t.char,".");break;case we.WHITESPACE:i+="blank space ".concat(t.char,".");break;case we.LETTER:i+="the letter ".concat(t.char,".");break;case we.OTHER:default:i+="the character ".concat(t.char,".")}return i.replace(/\n/g," ").split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.codePointAt(0)}})}),message:new g("message",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||"character"!=i.type||i.cat!=we.OPEN)return this.invalid=!0,[this];for(var a=0,s=[];;){if(!(i=e.mouth.eat("pre space")))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==i.type&&i.cat==we.OPEN)a++,s.push(i.char);else if("character"==i.type&&i.cat==we.CLOSE){if(!a)break;a--,s.push(i.char)}else"command"==i.type?(s.push(i.escapeChar),s.push.apply(s,i.name.split(""))):s.push(i.char)}h(s.join(""))}),mkern:new g("mkern",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu dimension");return t?(e.tokens.push({type:"kern",dimen:t}),[]):(this.invalid=!0,[this])}),month:new g("month",function(e){return[new xe((new Date).getMonth()+1)]}),mskip:new g("mskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("mu glue");return t?(e.tokens.push({type:"glue",glue:t}),[]):(this.invalid=!0,[this])}),multiply:new g("multiply",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=we.ACTIVE)){if(i&&i.register){if(i&&i.register){var a=e.mouth.eat();if(!a||"character"!=a.type||"b"!=a.char&&"B"!=a.char||a.cat==we.ACTIVE){if(!a)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert()}else{var s=e.mouth.eat();s&&"character"==s.type&&("y"==s.char||"Y"==s.char)&&s.cat!=we.ACTIVE||e.mouth.revert(2)}s=e.mouth.eat("integer");if(!s)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type){i.value*=s.value;var r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).value=r.value;e.toggles.global=!1}else if("dimension"==i.type){i.sp.value*=s.value,i.em.value*=s.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).sp.value=r.sp.value,i.em.value=r.em.value;e.toggles.global=!1}else if("mu dimension"==i.type){i.mu.value*=s.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).mu.value=r.mu.value;e.toggles.global=!1}else if("glue"==i.type){i.start.sp.value*=s.value,i.start.em.value*=s.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=s.value:(i.stretch.sp.value*=s.value,i.stretch.em.value*=s.value),"infinite dimension"==i.shrink.type?i.shrink.number.value*=s.value:(i.shrink.sp.value*=s.value,i.shrink.em.value*=s.value);r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.sp.value=r.start.sp.value,i.start.em.value=r.start.em.value,"infinite dimension"==r.stretch.type?i.stretch=new Ee(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new Ge(r.stretch.sp.value,r.stretch.em.value),"infinite dimension"==r.shrink.type?i.shrink=new Ee(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new Ge(r.shrink.sp.value,r.shrink.em.value);e.toggles.global=!1}else if("mu glue"==i.type){i.start.mu.value*=s.value,"infinite dimension"==i.stretch.type?i.stretch.number.value*=s.value:i.stretch.mu.value*=s.value,"infinite dimension"==i.shrink.type?i.shrink.number.value*=s.value:i.shrink.mu.value*=s.value;r=i;if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value)for(;i.parent;)(i=i.parent).start.mu.value=r.start.mu.value,"infinite dimension"==r.stretch.type?i.stretch=new Ee(r.stretch.number.value,r.stretch.magnitude.value):i.stretch=new ke(r.stretch.mu.value),"infinite dimension"==r.shrink.type?i.shrink=new Ee(r.shrink.number.value,r.shrink.magnitude.value):i.shrink=new ke(r.shrink.mu.value);e.toggles.global=!1}break}return this.invalid=!0,e.mouth.loadState(t),[this]}return this.invalid=!0,e.mouth.loadState(t),[this]}s=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}return[]}),muskip:new g("muskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!Ce.registers.muskip[t.value]){Ce.registers.muskip[t.value]=new Se(new ke(0,0),new ke(0,0),new ke(0,0));for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.muskip[t.value]=new Se((i?e.scopes[i-1]:Ce).registers.muskip[t.value])}return[e.scopes.last().registers.muskip[t.value]]}),muskipdef:new g("muskipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==we.OTHER||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!Ce.registers.muskip[s]){Ce.registers.muskip[s]=new Se(new ke(0),new ke(0),new ke(0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.muskip[s]=new Se((r?e.scopes[r-1]:Ce).registers.muskip[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.registers.named[i]=Ce.registers.muskip[s],delete Ce.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.muskip[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.muskip[s],delete e.scopes.last().defs.macros[i]}),noalign:new g("noalign",function(e){return this.invalid=!0,[this]}),noexpand:new g("noexpand",function(e){var t=e.mouth.eat();return t?(e.mouth.revert(),"command"==t.type||"character"==t.type&&t.cat==we.ACTIVE?(this.invalid=!0,[this]):[]):(this.invalid=!0,[this])}),nolimits:new g("nolimits",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"limit modifier",value:!1,token:this}),[])}),nonscript:new g("nonscript",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"glue",isNonScript:!0}),[])}),normalfont:new g("normalfont",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"nm"}),[])}),number:new g("number",function(e){e=e.mouth.eat("integer");return e?e.value.toString().split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,[this])}),of:new g("of",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(e.scopes.last().root){var t=e.scopes.last().tokens.indexOf(e.scopes.last().root);return e.tokens.push({type:"family modifier",value:"rad",index:e.scopes.last().tokens.splice(t,e.scopes.last().tokens.length-t+1).slice(1),token:this}),e.scopes.last().root=!1,[]}return this.invalid=!0,[this]}),omit:new g("omit",function(e){return this.invalid=!0,[this]}),or:new g("or",function(e){return this.invalid=!0,[this]}),over:new g("over",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.scopes.last().isFrac=!0,e.scopes.last().fracLeftDelim=e.scopes.last().fracRightDelim=".",e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[])}),overline:new g("overline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"over",token:this}),[])}),overwithdelims:new g("overwithdelims",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||"character"!=i.type||!Ce.delims.includes(i.code)||i.cat!=we.OTHER&&i.cat!=we.LETTER)return this.invalid=!0,e.mouth.loadState(t),delete e.scopes.last().fracLeftDelim,[this];if(e.scopes.last().fracLeftDelim){e.scopes.last().fracRightDelim=i.char;break}e.scopes.last().fracLeftDelim=i.char}}return e.scopes.last().isFrac=!0,e.scopes.last().barWidth="from font",e.scopes.last().root&&(e.scopes.last().root.invalid=!0,e.scopes.last().root=!1),e.scopes.last().fracNumerator=e.scopes.last().tokens,e.scopes.last().tokens=[],[]}),phantom:new g("phantom",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"phantom",index:[],token:this}),[])}),raise:new g("raise",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("dimension");return t?(e.tokens.push({type:"vkern",dimen:t}),[]):(this.invalid=!0,[this])}),relax:new g("relax",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):[]}),right:new g("right",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];if(!e.openGroups.length||!e.scopes.last().delimited||e.scopes.last().isHalign||e.scopes.last().isHalignCell||e.scopes.last().semisimple)return this.invalid=!0,[this];var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(!i||"command"!=i.type&&("character"!=i.type||i.cat!=we.ACTIVE)){if(!i||"character"!=i.type||!Ce.delims.includes(i.code)||i.cat!=we.OTHER&&i.cat!=we.LETTER)return this.invalid=!0,e.mouth.loadState(t),[this];if("scope"!=e.contexts.last)return this.invalid=!0,e.mouth.loadState(t),[this];e.openGroups.pop(),e.contexts.pop();var a,s=e.scopes.last().tokens;e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.scopes.last().isFrac?(e.scopes.last().fracNumerator.shift(),e.scopes.last().fracNumerator.shift(),e.scopes[e.scopes.length-2].tokens.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:s,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace),delims:[e.scopes.last().leftDelimiter,i.char]}),e.scopes.pop()):(s.shift(),s.shift(),a=e.scopes.last().leftDelimiter,e.scopes.pop(),e.scopes.last().tokens.push({type:"atom",atomType:"inner",nucleus:s,superscript:null,subscript:null,delimited:!0,nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace),delims:[a,i.char]}));break}i=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,i)}}),rm:new g("rm",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"rm"}),[])}),romannumeral:new g("romannumeral",function(e){var t=e.mouth.eat("integer");if(!t)return this.invalid=!0,[this];if(t.value<=0)return this.invalid=!0,e.mouth.revert(),[this];var i="",a=~~((t=t.value)/1e3),s=~~((t%=1e3)/100),e=~~((t%=100)/10),t=t%10,i=new Array(1+a).join("m");return i+=s<3?new Array(1+s).join("c"):4==s?"cd":s<9?"d"+new Array(s%5+1).join("c"):"cm",i+=e<3?new Array(1+e).join("x"):4==e?"xl":e<9?"l"+new Array(e%5+1).join("x"):"xc",(i+=t<3?new Array(1+t).join("i"):4==t?"iv":t<9?"v"+new Array(t%5+1).join("i"):"ix").split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}})}),scriptscriptstyle:new g("scriptscriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptscriptstyle"}),[])}),scriptstyle:new g("scriptstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"scriptstyle"}),[])}),show:new g("show",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.string,i=e.mouth.eat();if(!i)return this.invalid=!0,[this];var a='"'.concat(this.escapeChar).concat(this.name).concat(t.substring(0,t.length-e.mouth.string.length),'":\n');if("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE){var s="command"==i.type?e.scopes[e.scopes.length-1].defs.primitive[i.name]||e.scopes[e.scopes.length-1].defs.macros[i.name]:e.scopes[e.scopes.length-1].defs.active[i.char];if(!s)return h("".concat(a).concat(i.escapeChar).concat(i.name,"=undefined.")),[];if("primitive"==s.type||s.isLet&&"primitive"==s.original.type)return h("".concat(a).concat(i.escapeChar).concat(i.name,"=").concat(String.fromCodePoint(e.scopes[e.scopes.length-1].registers.named.escapechar.value)).concat((s.original||s).name)),[];if(!s.isLet){s.proxy&&(s=s.original),a+="".concat(i.escapeChar+i.name||i.char,"=macro:\n");for(var r=0,n=0,l=s.parameters.length;n<l;n++)"character"==s.parameters[n].type&&s.parameters[n].cat!=we.PARAMETER?a+=s.parameters[n].char:"character"==s.parameters[n].type?a+=s.parameters[n].char+ ++r:a+=s.parameters[n].escapeChar+s.parameters[n].name;a+="->";for(var o=0,c=s.replacement.length;o<c;o++)a+="character"==s.replacement[o].type?s.replacement[o].char:s.replacement[o].escapeChar+s.replacement[o].name;return h(a),[]}a+="".concat(i.escapeChar+i.name||i.char,"="),i=s.original.replacement[0]}switch(i.cat){case we.OPEN:h("".concat(a,"begin-group character ").concat(i.char,"."));break;case we.CLOSE:h("".concat(a,"end-group character ").concat(i.char,"."));break;case we.MATHSHIFT:h("".concat(a,"math shift character ").concat(i.char,"."));break;case we.ALIGN:h("".concat(a,"alignment tab character ").concat(i.char,"."));break;case we.PARAMETER:h("".concat(a,"macro parameter character ").concat(i.char,"."));break;case we.SUPERSCRIPT:h("".concat(a,"superscript character ").concat(i.char,"."));break;case we.SUBSCRIPT:h("".concat(a,"subscript character ").concat(i.char,"."));break;case we.WHITESPACE:h("".concat(a,"blank space ").concat(i.char,"."));break;case we.LETTER:h("".concat(a,"the letter ").concat(i.char,"."));break;case we.OTHER:default:h("".concat(a,"the character ").concat(i.char,"."))}return[]}),showthe:new g("showthe",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i,a,s,r,n=e.mouth.eat();if(!n||"command"!=n.type&&("character"!=n.type||n.cat!=we.ACTIVE))return n&&n.register?("integer"==n.type?h(n.value+"."):"dimension"==n.type?(i=Math.round(n.sp.value/65536*1e5)/1e5,i+=Math.round(n.em.value/65536*1e5)/1e5*12,h(i+(Number.isInteger(i)?".0pt.":"pt."))):"mu dimension"==n.type?(s=Math.round(n.mu.value/65536*1e5)/1e5,h(s+(Number.isInteger(s)?".0mu.":"mu."))):"glue"==n.type?(a="",i=Math.round(n.start.sp.value/65536*1e5)/1e5,a=(i+=Math.round(n.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt"),n.stretch instanceof Ge&&(n.stretch.sp.value||n.stretch.em.value)?(i=Math.round(n.stretch.sp.value/65536*1e5)/1e5,a+=" plus "+(i+=Math.round(n.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.stretch instanceof Ee&&n.stretch.number.value&&(a+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof Ge&&(n.shrink.sp.value||n.shrink.em.value)?(i=Math.round(n.shrink.sp.value/65536*1e5)/1e5,a+=" minus "+(i+=Math.round(n.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(i)?".0pt":"pt")):n.shrink instanceof Ee&&n.shrink.number.value&&(a+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),h(a+".")):"mu glue"==n.type&&(a="",a=(s=Math.round(n.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"),n.stretch instanceof ke&&n.stretch.mu.value?a+=" plus "+(s=Math.round(n.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"):n.stretch instanceof Ee&&n.stretch.number.value&&(a+=" plus "+(r=Math.round(n.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.stretch.magnitude.value).join("l")),n.shrink instanceof ke&&n.shrink.mu.value?a+=" minus "+(s=Math.round(n.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(s)?".0mu":"mu"):n.shrink instanceof Ee&&n.shrink.number.value&&(a+=" minus "+(r=Math.round(n.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(r)?".0":"")+"fil"+new Array(n.shrink.magnitude.value).join("l")),h(a+".")),[]):(this.invalid=!0,e.mouth.loadState(t),[this]);n=e.mouth.expand(n,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,n)}}),skip:new g("skip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("integer");if(!t||t.value<0)return this.invalid=!0,[this];if(!Ce.registers.skip[t.value]){Ce.registers.skip[t.value]=new Xe(new Ge(0,0),new Ge(0,0),new Ge(0,0));for(var i=0,a=e.scopes.length;i<a;i++)e.scopes[i].registers.skip[t.value]=new Xe((i?e.scopes[i-1]:Ce).registers.skip[t.value])}return[e.scopes.last().registers.skip[t.value]]}),skipdef:new g("skipdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if("command"!=i.type)return this.invalid=!0,e.mouth.loadState(countDefSym),[!0];if(i.name in Ce.defs.primitive||i.name in Ce.parameters)return this.invalid=!0,e.mouth.loadState(t),[!0];var a=e.mouth.eat();a&&"character"==a.type&&"="==a.char&&a.cat==we.OTHER||a&&e.mouth.revert();var s=e.mouth.eat("integer");if(!s||s.value<0)return this.invalid=!0,e.mouth.loadState(t),[!0];if(i=i.name,s=s.value,!Ce.registers.skip[s]){Ce.registers.skip[s]=new Xe(new Ge(0,0),new Ge(0,0),new Ge(0,0));for(var r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.skip[s]=new Xe((r?e.scopes[r-1]:Ce).registers.skip[s])}if(e.toggles.global&&0<=e.scopes.last().registers.named.globaldefs.value||0<e.scopes.last().registers.named.globaldefs.value){Ce.registers.named[i]=Ce.registers.skip[s],delete Ce.defs.macros[i];for(r=0,n=e.scopes.length;r<n;r++)e.scopes[r].registers.named[i]=e.scopes[r].registers.skip[s],delete e.scopes[r].defs.macros[i]}else e.scopes.last().registers.named[i]=e.scopes.last().registers.skip[s],delete e.scopes.last().defs.macros[i]}),sl:new g("sl",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"sl"}),[])}),span:new g("span",function(e){"mathchoice"==e.contexts.last&&e.contexts.last.failed();for(var t=!1,i=e.scopes.length-1;0<=i;i--)if(e.scopes[i].isHalignCell){t=e.scopes[i];break}if(!t)return this.invalid=!0,[this];var a=t.parentScope,s=a.cellData[a.cellData.length-1];if(s[s.length-1].omit&&(this.postPreamble=!0),this.postPreamble&&!e.scopes.last().isHalignCell||"scope"!=e.contexts.last)return this.invalid=!0,[this];if(!this.postPreamble){for(var r=-1,i=0,n=s.length;i<n;i++)r+=s[i].span;if(a.preamble[r])c=a.preamble[r][1];else{if(!~a.repeatPreambleAt)return this.invalid=!0,[this];c=(m=a.preamble.slice(a.repeatPreambleAt,a.preamble.length))[(r-a.repeatPreambleAt)%m.length][1]}if(!a.preamble[++r]&&!~a.repeatPreambleAt)return this.invalid=!0,[this];for(var l=[],i=0,n=c.length;i<n;i++){var o={};for(u in c[i])o[u]=c[i][u];l.push(o)}return this.postPreamble=!0,l.concat(this)}e.scopes.last().root&&(e.scopes.last().root.invalid=!0),e.contexts.pop();var c=e.scopes.last().tokens;e.scopes.last().isFrac?(s[s.length-1].content.push({type:"atom",atomType:"inner",nucleus:[{type:"fraction",numerator:e.scopes.last().fracNumerator,denominator:c,barWidth:e.scopes.last().barWidth,delims:[e.scopes.last().fracLeftDelim,e.scopes.last().fracRightDelim],nullDelimiterSpace:new Ge(e.scopes.last().registers.named.nulldelimiterspace)}],superscript:null,subscript:null}),e.scopes.pop()):(e.scopes.pop(),s[s.length-1].content=s[s.length-1].content.concat(c));var h=Symbol();for(e.mouth.saveState(h),s[s.length-1].omit=!1,s[s.length-1].span++;;){if(!(o=e.mouth.eat())){e.mouth.loadState(h);break}if("character"==o.type&&o.cat!=we.ACTIVE){e.mouth.loadState(h);break}if("command"==o.type||"character"==o.type&&o.cat==we.ACTIVE){if(o.name in e.scopes.last().registers.named){e.mouth.loadState(h);break}var d,p="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char];if(!p){e.mouth.loadState(h);break}if(p===Ce.defs.primitive.the||p.proxy&&p.original===Ce.defs.primitive.the||p===Ce.defs.primitive.expandafter||p.proxy&&p.original===Ce.defs.primitive.expandafter||p===Ce.defs.primitive.number||p.proxy&&p.original===Ce.defs.primitive.number||p===Ce.defs.primitive.romannumeral||p.proxy&&p.original===Ce.defs.primitive.romannumeral||p===Ce.defs.primitive.csname||p.proxy&&p.original===Ce.defs.primitive.csname||p===Ce.defs.primitive.string||p.proxy&&p.original===Ce.defs.primitive.string||p===Ce.defs.primitive.if||p.isLet&&p.original===Ce.defs.primitive.if||p===Ce.defs.primitive.ifcase||p.isLet&&p.original===Ce.defs.primitive.ifcase||p===Ce.defs.primitive.ifcat||p.isLet&&p.original===Ce.defs.primitive.ifcat||p===Ce.defs.primitive.ifdim||p.isLet&&p.original===Ce.defs.primitive.ifdim||p===Ce.defs.primitive.ifeof||p.isLet&&p.original===Ce.defs.primitive.ifeof||p===Ce.defs.primitive.iffalse||p.isLet&&p.original===Ce.defs.primitive.iffalse||p===Ce.defs.primitive.ifodd||p.isLet&&p.original===Ce.defs.primitive.ifodd||p===Ce.defs.primitive.ifnum||p.isLet&&p.original===Ce.defs.primitive.ifnum||p===Ce.defs.primitive.ifhmode||p.isLet&&p.original===Ce.defs.primitive.ifhmode||p===Ce.defs.primitive.ifinner||p.isLet&&p.original===Ce.defs.primitive.ifinner||p===Ce.defs.primitive.ifmmode||p.isLet&&p.original===Ce.defs.primitive.ifmmode||p===Ce.defs.primitive.iftrue||p.isLet&&p.original===Ce.defs.primitive.iftrue||p===Ce.defs.primitive.ifvmode||p.isLet&&p.original===Ce.defs.primitive.ifvmode||p===Ce.defs.primitive.ifvoid||p.isLet&&p.original===Ce.defs.primitive.ifvoid||p===Ce.defs.primitive.ifx||p.isLet&&p.original===Ce.defs.primitive.ifx){if(1==(d=e.mouth.expand(o,e.mouth)).length&&d[0]===o&&o.invalid){e.mouth.loadState(h);break}e.mouth.queue.unshift.apply(e.mouth.queue,d)}else{if(p===Ce.defs.primitive.omit||p.proxy&&p.original===Ce.defs.primitive.omit){s[s.length-1].omit=!0;break}if("primitive"==p.type||p.proxy&&"primitive"==p.original.type){e.mouth.loadState(h);break}if(1==(d=e.mouth.expand(o,e.mouth)).length&&d[0]==-o&&o.invalid){e.mouth.loadState(h);break}e.mouth.queue.unshift.apply(e.mouth.queue,d)}}}if(e.contexts.push({toString:function(){return"scope"},type:"scope"}),new e.Scope,e.scopes.last().isHalignCell=!0,!s[s.length-1].omit){for(var m,r=-1,i=0,n=s.length;i<n;i++)r+=s[i].span;a.preamble[r]?c=a.preamble[r][0]:~a.repeatPreambleAt&&(c=(m=a.preamble.slice(a.repeatPreambleAt,a.preamble.length))[(r-a.repeatPreambleAt)%m.length][0]);for(l=[],i=0,n=c.length;i<n;i++){var u,o={};for(u in c[i])o[u]=c[i][u];l.push(o)}return l}}),radical:new g("radical",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"rad",index:[],token:this}),[])}),root:new g("root",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last||e.scopes.last().root?(this.invalid=!0,[this]):(this.ignore=!0,[e.scopes.last().root=this])}),string:new g("string",function(e){var t=e.mouth.eat();return t?"character"==t.type?[{type:"character",cat:we.OTHER,char:t.char,code:t.code}]:"command"==t.type?(String.fromCharCode(e.scopes.last().registers.named.escapechar.value)+t.name).split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}}):(this.invalid=!0,e.mouth.revert(),[this]):(this.invalid=!0,[this])}),textstyle:new g("textstyle",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"font modifier",value:"textstyle"}),[])}),the:new g("the",function(e){var t=Symbol();for(e.mouth.saveState(t);;){var i=e.mouth.eat();if(i&&("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE)){var a=e.mouth.expand(i,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,a)}else{if(!i||!i.register)return this.invalid=!0,e.mouth.loadState(t),[this];if("integer"==i.type)return i.value.toString().split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}});if("dimension"==i.type){var s=Math.round(i.sp.value/65536*1e5)/1e5;return((s+=Math.round(i.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")).split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}})}if("mu dimension"==i.type)return((n=Math.round(i.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu")).split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}});if("glue"==i.type){var r="",s=Math.round(i.start.sp.value/65536*1e5)/1e5;return r=(s+=Math.round(i.start.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt"),i.stretch instanceof Ge&&(i.stretch.sp.value||i.stretch.em.value)?(s=Math.round(i.stretch.sp.value/65536*1e5)/1e5,r+=" plus "+(s+=Math.round(i.stretch.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")):i.stretch instanceof Ee&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof Ge&&(i.shrink.sp.value||i.shrink.em.value)?(s=Math.round(i.shrink.sp.value/65536*1e5)/1e5,r+=" minus "+(s+=Math.round(i.shrink.em.value/65536*1e5)/1e5*12)+(Number.isInteger(s)?".0pt":"pt")):i.shrink instanceof Ee&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}})}if("mu glue"==i.type){var n,l,r="";return r=(n=Math.round(i.start.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"),i.stretch instanceof ke&&i.stretch.mu.value?r+=" plus "+(n=Math.round(i.stretch.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.stretch instanceof Ee&&i.stretch.number.value&&(r+=" plus "+(l=Math.round(i.stretch.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.stretch.magnitude.value).join("l")),i.shrink instanceof ke&&i.shrink.mu.value?r+=" minus "+(n=Math.round(i.shrink.mu.value/65536*1e5)/1e5)+(Number.isInteger(n)?".0mu":"mu"):i.shrink instanceof Ee&&i.shrink.number.value&&(r+=" minus "+(l=Math.round(i.shrink.number.value/65536*1e5)/1e5)+(Number.isInteger(l)?".0":"")+"fil"+new Array(i.shrink.magnitude.value).join("l")),r.split("").map(function(e){return{type:"character",cat:we.OTHER,char:e,code:e.charCodeAt(0)}})}}}}),time:new g("time",function(e){var t=new Date;return[new xe(60*t.getHours()+t.getMinutes())]}),uccode:new g("uccode",function(e){var t=e.mouth.eat("integer");return t&&0<t.value?[e.scopes.last().uc[t.value]=e.scopes.last().uc[t.value]||new xe(0)]:(this.invalid=!0,[this])}),underline:new g("underline",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"under",token:this}),[])}),uppercase:new g("uppercase",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat();if(!i||i.cat!=we.OPEN)return this.invalid=!0,e.mouth.loadState(t),[this];for(var a=[],s=1;;){var r=e.mouth.eat("pre space");if(!r)return this.invalid=!0,e.mouth.loadState(t),[this];if("character"==r.type&&r.cat==we.OPEN)s++,a.push(r);else if("character"==r.type&&r.cat==we.CLOSE){if(!(0<--s))break;a.push(r)}else a.push(r)}for(var n=0,l=a.length;n<l;n++)"character"==a[n].type&&e.scopes.last().uc[a[n].code]&&0<e.scopes.last().uc[a[n].code].value&&(a[n].code=e.scopes.last().uc[a[n].code].value,a[n].char=String.fromCharCode(a[n].code));return a}),vbox:new g("vbox",function(e){var t,i,a=Symbol();for(e.mouth.saveState(a);;){var s=e.mouth.eat();if(!s)return this.invalid=!0,[this];if("command"!=s.type&&("character"!=s.type||s.cat!=we.ACTIVE)){if("character"!=s.type||"t"!=s.char&&"T"!=s.char){if("character"!=s.type||"s"!=s.char&&"S"!=s.char){if("character"!=s.type||s.cat!=we.OPEN)return this.invalid=!0,e.mouth.loadState(a),[this];e.mouth.revert();break}var r=e.mouth.eat(),n=e.mouth.eat(),l=e.mouth.eat(),o=e.mouth.eat(),c=e.mouth.eat();if(!r||"character"!=r.type||"p"!=r.char&&"P"!=r.char||r.cat==we.ACTIVE||!n||"character"!=n.type||"r"!=n.char&&"R"!=n.char||n.cat==we.ACTIVE||!l||"character"!=l.type||"e"!=l.char&&"E"!=l.char||l.cat==we.ACTIVE||!o||"character"!=o.type||"a"!=o.char&&"A"!=o.char||o.cat==we.ACTIVE||!c||"character"!=c.type||"d"!=c.char&&"D"!=c.char||c.cat==we.ACTIVE)return this.invalid=!0,e.mouth.loadState(a),[this];if(o=e.mouth.eat("dimension")){t=o;break}return this.invalid=!0,e.mouth.loadState(a),[this]}c=e.mouth.eat("pre space");if(!c||"character"!=c.type||"o"!=c.char&&"O"!=s.char||s.cat==we.ACTIVE)return this.invalid=!0,e.mouth.loadState(a),[this];if(o=e.mouth.eat("dimension")){i=o;break}return this.invalid=!0,e.mouth.loadState(a),[this]}c="command"==s.type?e.scopes.last().defs.primitive[s.name]||e.scopes.last().defs.macros[s.name]:e.scopes.last().defs.active[s.char];if(c&&(c===Ce.defs.primitive.relax||c.proxy&&c.original===Ce.defs.primitive.relax))break;s=e.mouth.expand(s,e.mouth);e.mouth.queue.unshift.apply(e.mouth.queue,s)}var h=e.mouth.preview();return h&&"character"==h.type&&h.cat==we.OPEN?(i||t||(t=new Ge(0,0)),e.tokens.push({type:"box wrapper",value:"vertical",to:i,spread:t,token:this}),[]):(this.invalid=!0,e.mouth.loadState(a),[this])}),vcenter:new g("vcenter",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"family modifier",value:"vcent",token:this}),[])}),vfil:new g("vfil",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new Xe(new Ge(0),new Ee(1,1),new Ge(0))}),[])}),vfill:new g("vfill",function(e){return"superscript"==e.contexts.last||"subscript"==e.contexts.last?(this.invalid=!0,[this]):(e.tokens.push({type:"vglue",glue:new Xe(new Ge(0),new Ee(1,2),new Ge(0))}),[])}),vrule:new g("vrule",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);for(var i=!1,a=!1,s=!1;;){var r=e.mouth.eat();if(!r){e.mouth.revert();break}if("h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE){if("d"!=r.char&&"D"!=r.char||r.cat==we.ACTIVE){if("w"!=r.char&&"W"!=r.char||r.cat==we.ACTIVE){e.mouth.revert();break}if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"d"!=r.char&&"D"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){s=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"p"!=r.char&&"P"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else{if(r=e.mouth.eat("dimension")){a=r;continue}e.mouth.revert(5)}break}if(!(r=e.mouth.eat("pre space"))||"e"!=r.char&&"E"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?2:1);else if(!(r=e.mouth.eat("pre space"))||"i"!=r.char&&"I"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?3:2);else if(!(r=e.mouth.eat("pre space"))||"g"!=r.char&&"G"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?4:3);else if(!(r=e.mouth.eat("pre space"))||"h"!=r.char&&"H"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?5:4);else if(!(r=e.mouth.eat("pre space"))||"t"!=r.char&&"T"!=r.char||r.cat==we.ACTIVE)e.mouth.revert(r?6:5);else{if(r=e.mouth.eat("dimension")){i=r;continue}e.mouth.revert(6)}break}return s=s||new Ge(0,65536/30),e.tokens.push({type:"rule",ruleType:"v",height:i,depth:a,width:s}),[]}),vskip:new g("vskip",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=e.mouth.eat("glue");return t?(e.tokens.push({type:"vglue",glue:t}),[]):(this.invalid=!0,[this])}),xdef:new g("xdef",function(e){if("superscript"==e.contexts.last||"subscript"==e.contexts.last)return this.invalid=!0,[this];var t=Symbol();e.mouth.saveState(t);var i,a=e.mouth.eat();if(!a)return this.invalid=!0,[this];if("character"==a.type){if(e.catOf(a.char)!=we.ACTIVE)return this.invalid=!0,e.mouth.loadState(t),[this];i="active",a=a.char}else if("command"==a.type&&(i="macro",(a=a.name)in e.scopes.last().defs.primitive||a in Ce.parameters))return this.invalid=!0,e.mouth.loadState(t),[this];for(var s=[],r=0,n=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if(o.cat==we.OPEN){e.mouth.revert();break}if(o.cat==we.PARAMETER){var l=e.mouth.eat("pre space");if(!l)return this.invalid=!0,e.mouth.loadState(t),[this];if(l.cat==we.OPEN)n=!0,e.mouth.revert(),s.push({type:"character",cat:we.OPEN,char:l.char,code:l.code});else{if(!(48<l.code&&l.code<58&&l.cat==we.OTHER&&+l.char==r+1))return this.invalid=!0,e.mouth.loadState(t),[this];s.push(o),r++}}else s.push(o)}for(var o,c=0,h=[],d=!1,p=!1;;){if(!(o=e.mouth.eat()))return this.invalid=!0,e.mouth.loadState(t),[this];if("character"!=o.type||o.cat!=we.PARAMETER||p)if("character"==o.type&&o.cat==we.OPEN)c++,h.push(o),d=!1;else if("character"==o.type&&o.cat==we.CLOSE){if(0==--c)break;h.push(o),d=!1}else if(d)h.push(o),d=!1;else if("command"==o.type||"character"==o.type&&o.cat==we.ACTIVE)if(o.name in e.scopes.last().registers.named)h.push(o);else{if(!(u="command"==o.type?e.scopes.last().defs.primitive[o.name]||e.scopes.last().defs.macros[o.name]:e.scopes.last().defs.active[o.char]))return this.invalid=!0,e.mouth.loadState(t),[this];if(u===Ce.defs.primitive.the||u.proxy&&u.original===Ce.defs.primitive.the||u===Ce.defs.primitive.expandafter||u.proxy&&u.original===Ce.defs.primitive.expandafter||u===Ce.defs.primitive.number||u.proxy&&u.original===Ce.defs.primitive.number||u===Ce.defs.primitive.romannumeral||u.proxy&&u.original===Ce.defs.primitive.romannumeral||u===Ce.defs.primitive.csname||u.proxy&&u.original===Ce.defs.primitive.csname||u===Ce.defs.primitive.string||u.proxy&&u.original===Ce.defs.primitive.string||u===Ce.defs.primitive.if||u.isLet&&u.original===Ce.defs.primitive.if||u===Ce.defs.primitive.ifcase||u.isLet&&u.original===Ce.defs.primitive.ifcase||u===Ce.defs.primitive.ifcat||u.isLet&&u.original===Ce.defs.primitive.ifcat||u===Ce.defs.primitive.ifdim||u.isLet&&u.original===Ce.defs.primitive.ifdim||u===Ce.defs.primitive.ifeof||u.isLet&&u.original===Ce.defs.primitive.ifeof||u===Ce.defs.primitive.iffalse||u.isLet&&u.original===Ce.defs.primitive.iffalse||u===Ce.defs.primitive.ifodd||u.isLet&&u.original===Ce.defs.primitive.ifodd||u===Ce.defs.primitive.ifnum||u.isLet&&u.original===Ce.defs.primitive.ifnum||u===Ce.defs.primitive.ifhmode||u.isLet&&u.original===Ce.defs.primitive.ifhmode||u===Ce.defs.primitive.ifinner||u.isLet&&u.original===Ce.defs.primitive.ifinner||u===Ce.defs.primitive.ifmmode||u.isLet&&u.original===Ce.defs.primitive.ifmmode||u===Ce.defs.primitive.iftrue||u.isLet&&u.original===Ce.defs.primitive.iftrue||u===Ce.defs.primitive.ifvmode||u.isLet&&u.original===Ce.defs.primitive.ifvmode||u===Ce.defs.primitive.ifvoid||u.isLet&&u.original===Ce.defs.primitive.ifvoid||u===Ce.defs.primitive.ifx||u.isLet&&u.original===Ce.defs.primitive.ifx){var m=e.mouth.expand(o,e.mouth);if(1==m.length&&m[0]===o&&o.invalid)return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.queue.unshift.apply(e.mouth.queue,m)}else u===Ce.defs.primitive.noexpand||u.proxy&&u.original===Ce.defs.primitive.noexpand?d=!0:u instanceof g||u.proxy&&u.original instanceof g?h.push(o):e.mouth.queue.unshift.apply(e.mouth.queue,e.mouth.expand(o,e.mouth))}else h.push(o);else{m=e.mouth.eat("pre space");if(!m||!(m.cat==we.PARAMETER||m.cat==we.OTHER&&m.char<=s.length&&1<=m.char))return this.invalid=!0,e.mouth.loadState(t),[this];e.mouth.revert(),m.cat==we.PARAMETER&&(p=!0),h.push(o),d=!1}}h.shift(),n&&h.push(s[s.length-1]);var u=new b(h,s);if(e.scopes.last().registers.named.globaldefs.value<0)e.scopes.last().defs["macro"==i?"macros":"active"][a]=u,delete e.scopes.last().registers.named[a];else if("macro"==i){Ce.defs.macros[a]=u,delete Ce.registers.named[a];for(var f=0,v=e.scopes.length;f<v;f++)e.scopes[f].defs.macros[a]=u,delete e.scopes.last().registers.named[a]}else{Ce.defs.active[a]=u,delete Ce.registers.named[a];for(f=0,v=e.scopes.length;f<v;f++)e.scopes[f].defs.ative[a]=u,delete e.scopes.last().registers.named[a]}return e.toggles.global=!1,[]}),year:new g("year",function(e){return[new xe((new Date).getFullYear())]}),"@debug":new g("@debug",function(e){return[]}),"js@function":new g("js@function",function(e){var t=Symbol();e.mouth.saveState(t);var i=e.mouth.eat(),a=null;if(!i)return e.mouth.loadState(t),T(this);if(f(i)){var s="command"==i.type?e.lastScope.defs.primitive[i.name]||e.lastScope.defs.macros[i.name]:e.lastScope.defs.active[i.char];if(!s)return T(this);(s=s.proxy?s.original:s)==Ce.defs.primitive.begingroup?a="semisimple":"character"==s.replacement[0].type&&s.replacement[0].cat==we.OPEN&&(a="simple")}else"character"==i.type&&i.cat==we.OPEN&&(a="simple");if(!a)return e.mouth.loadState(t),T(this);for(var r,n=[],l=e.mouth.string,o=l;l;)if(n.length){var c=n[n.length-1],h='"'==c||"'"==c||"`"==c;"raw"==c?("`"==l[0]?n.pop():"${"==l.substring(0,2)&&(n.push("}"),l=l.substring(1)),l=l.substring(1)):l=h?("\\"==l[0]?l=l.substring(1):l[0]==c?n.pop():"${"==l.substring(0,2)&&"`"==c&&(n.push("}"),l=l.substring(1)),l.substring(1)):"String.raw`"!=l.substring(0,11)?("("!=l[0]?"["!=l[0]?"{"!=l[0]?'"'!=l[0]?"'"!=l[0]?"`"==l[0]?n.push("`"):l[0]==c&&n.pop():n.push("'"):n.push('"'):n.push("}"):n.push("]"):n.push(")"),l.substring(1)):(c.push("raw"),l.substring(11))}else if("String.raw`"!=l.substring(0,11))if("("!=l[0])if("["!=l[0])if("{"!=l[0])if('"'!=l[0])if("'"!=l[0])if("`"==l[0])n.push("`"),l=l.substring(1);else{if(e.catOf(l[0])==we.CLOSE&&"simple"==a){o=o.substring(0,o.length-l.length),l=l.substring(1);break}l=l.substring(1)}else n.push("'"),l=l.substring(1);else n.push('"'),l=l.substring(1);else n.push("}"),l=l.substring(1);else n.push("]"),l=l.substring(1);else n.push(")"),l=l.substring(1);else n.push("raw"),l=l.substring(11);e.mouth.history.push({queue:e.mouth.queue.slice(),string:e.mouth.string,history:e.mouth.history.slice()}),e.mouth.string=l;try{r=new Function(o)()}catch(e){return"".concat(e.name,": ").concat(e.message).split("").map(function(e){return{type:"character",char:e,code:e.codePointAt(0),cat:we.OTHER,invalid:!0,recognized:!0}})}return null!=r&&null!=r&&(r=new String(r).valueOf(),e.mouth.string=r+e.mouth.string),[]})},macros:{},active:{}},registers:{count:{},dimen:{},skip:{},muskip:{},named:{pretolerance:new xe(100),tolerance:new xe(200),hbadness:new xe(1e3),vbadness:new xe(1e3),linepenalty:new xe(10),hypenpenalty:new xe(50),exhyphenpenalty:new xe(50),binoppenalty:new xe(700),relpenalty:new xe(500),clubpenalty:new xe(150),widowpenalty:new xe(150),displaywidowpenalty:new xe(50),brokenpenalty:new xe(100),predisplaypenalty:new xe(1e4),postdisplaypenalty:new xe(0),floatingpenalty:new xe(0),interlinepenalty:new xe(0),outputpenalty:new xe(-10001),doublehyphendemerits:new xe(1e4),finalhyphendemerits:new xe(5e3),adjdemerits:new xe(1e4),looseness:new xe(0),pausing:new xe(0),holdinginserts:new xe(0),tracingonline:new xe(0),tracingmacros:new xe(0),tracingstats:new xe(0),tracingparagraphs:new xe(0),tracingpages:new xe(0),tracingoutput:new xe(0),tracinglostchars:new xe(0),tracingcommands:new xe(0),tracingrestores:new xe(0),language:new xe(0),uchyph:new xe(1),lefthyphenmin:new xe(2),righthyphenmin:new xe(3),globaldefs:new xe(0),defaulthyphenchar:new xe(45),defaultskewchar:new xe(-1),escapechar:new xe(92),endlinechar:new xe(13),newlinechar:new xe(10),maxdeadcycles:new xe(100),hangafter:new xe(1),fam:new xe(0),mag:new xe(1e3),delimiterfactor:new xe(901),showboxbreadth:new xe(-1),showboxdepth:new xe(-1),errorcontextlines:new xe(-1),hfuzz:new Ge(6553.6,0),vfuzz:new Ge(6553.6,0),overfullrule:new Ge(0,0),emergencystetch:new Ge(0,0),hsize:new Ge(22609920,0),vsize:new Ge(36044800,0),maxdepth:new Ge(327680,0),splitmaxdepth:new Ge(1074397184,-65536),boxmaxdepth:new Ge(1074397184,-65536),lineskiplimit:new Ge(0,0),delimitershortfall:new Ge(327680,0),nulldelimiterspace:new Ge(0,6553.6),scriptspace:new Ge(32768,0),mathsurround:new Ge(0,0),predisplaystyle:new Ge(0,0),displaywidth:new Ge(0,0),displayindent:new Ge(0,0),parindent:new Ge(983040,0),hangindent:new Ge(0,0),hoffset:new Ge(0,0),voffset:new Ge(0,0),baselineskip:new Xe(new Ge(786432,0)),lineskip:new Xe(new Ge(65536,0)),parskip:new Xe(new Ge(0,0),new Ge(65536,0)),abovedisplayskip:new Xe(new Ge(655360,0),new Ge(131072,0),new Ge(327680,0)),abovedisplayshortskip:new Xe(new Ge(0,0),new Ge(196608,0)),belowdisplayskip:new Xe(new Ge(0,0),new Ge(196608,0)),belowdisplayshortskip:new Xe(new Ge(393216,0),new Ge(196608,0),new Ge(196608,0)),leftskip:new Xe(new Ge(0,0)),rightskip:new Xe(new Ge(0,0)),topskip:new Xe(new Ge(655360,0)),splittopskip:new Xe(new Ge(655360,0)),tabskip:new Xe(new Ge(0,0)),spaceskip:new Xe(new Ge(0,0)),xspaceskip:new Xe(new Ge(0,0)),parfillskip:new Xe(new Ge(0,0),new Ee(65536,1)),thinmuskip:new Se(new ke(196608)),medmuskip:new Se(new ke(262144),new ke(131072),new ke(262144)),thickmuskip:new Se(new ke(327680),new ke(327680))}},cats:function(){for(var e={92:new xe(we.ESCAPE,0,15),123:new xe(we.OPEN,0,15),125:new xe(we.CLOSE,0,15),36:new xe(we.MATHSHIFT,0,15),38:new xe(we.ALIGN,0,15),10:new xe(we.ENDOFLINE,0,15),35:new xe(we.PARAMETER,0,15),94:new xe(we.SUPERSCRIPT,0,15),95:new xe(we.SUBSCRIPT,0,15),0:new xe(we.IGNORE,0,15),9:new xe(we.WHITESPACE,0,15),32:new xe(we.WHITESPACE,0,15),126:new xe(we.ACTIVE,0,15),37:new xe(we.COMMENT,0,15),127:new xe(we.INVALID,0,15)},t="a".codePointAt(0),i="z".codePointAt(0);t<=i;t++)e[t]=new xe(we.LETTER,0,15);for(var a="A".codePointAt(0),s="Z".codePointAt(0);a<=s;a++)e[a]=new xe(we.LETTER,0,15);return e}(),mathcodes:function(){for(var e={},t=0,i="".length;t<i;t++)e["".codePointAt(t)]=new xe(ze.OP,0,8);for(var a="+-*±∓∖×∗⋆⋄∘∙÷∩∪⊎⊓⊔◃▹≀◯△▽∨∧⊕⊖⊗⊘⊙†‡⨿",s=0,r=a.length;s<r;s++)e[a.codePointAt(s)]=new xe(ze.BIN,0,8);for(var n='<>=:"≤≺⪯≪⊂⊆⊏⊑∈⊢⌣⌢≥≻⪰≫⊃⊇⊐⊒∋⊣≡∼≃≍≈≅⋈∝⊨≐⊥≮≰⊀⊄⊈⋢≯≱⊁⊅⊉⋣≠≢≁≄≆≭',l=0,o=n.length;l<o;l++)e[n.codePointAt(l)]=new xe(ze.REL,0,8);for(var c=0,h="([{`".length;c<h;c++)e["([{`".codePointAt(c)]=new xe(ze.OPEN,0,8);for(var d=0,p="}])!?".length;d<p;d++)e["}])!?".codePointAt(d)]=new xe(ze.CLOSE,0,8);for(var m=0,u=",;".length;m<u;m++)e[",;".codePointAt(m)]=new xe(ze.PUNCT,0,8);for(var f="abcdefghħijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZαβγδϵεζηθϑικλμνξπϖρϱσςτυϕφχψω",v=0,g=f.length;v<g;v++)e[f.codePointAt(v)]=new xe(ze.VARIABLE,0,8);return e}(),delims:[40,41,46,60,62,47,91,92,93,123,124,125,8214,8593,8595,8597,8657,8659,8661,8741,8968,8969,8970,8971,9130,9136,9137,9168,10216,10217,10222,10223],parameters:["pretolerance","tolerance","hbadness","vbadness","linepenalty","hypenpenalty","exhyphenpenalty","binoppenalty","relpenalty","clubpenalty","widowpenalty","displaywidowpenalty","brokenpenalty","predisplaypenalty","postdisplaypenalty","floatingpenalty","interlinepenalty","outputpenalty","doublehyphendemerits","finalhyphendemerits","adjdemerits","looseness","pausing","holdinginserts","tracingonline","tracingmacros","tracingstats","tracingparagraphs","tracingpages","tracingoutput","tracinglostchars","tracingcommands","tracingrestores","language","uchyph","lefthyphenmin","righthyphenmin","globaldefs","defaulthyphenchar","defaultskewchar","escapechar","endlinechar","newlinechar","maxdeadcycles","hangafter","fam","mag","delimiterfactor","showboxbreadth","showboxdepth","errorcontextlines","hfuzz","vfuzz","overfullrule","emergencystetch","hsize","vsize","maxdepth","splitmaxdepth","boxmaxdepth","lineskiplimit","delimitershortfall","nulldelimiterfall","scriptspace","mathsurround","predisplaystyle","displaywidth","displayindent","parindent","hangindent","hoffset","voffset","baselineskip","lineskip","parskip","abovedisplayskip","abovedisplayshortskip","belowdisplayskip","belowdisplayshortskip","leftskip","rightskip","topskip","splittopskip","tabskip","spaceskip","xspaceskip","parfillskip","thinmuskip","medmuskip","thickmuskip"],lc:{65:new xe(97),66:new xe(98),67:new xe(99),68:new xe(100),69:new xe(101),70:new xe(102),71:new xe(103),72:new xe(104),73:new xe(105),74:new xe(106),75:new xe(107),76:new xe(108),77:new xe(109),78:new xe(110),79:new xe(111),80:new xe(112),81:new xe(113),82:new xe(114),83:new xe(115),84:new xe(116),85:new xe(117),86:new xe(118),87:new xe(119),88:new xe(120),89:new xe(121),90:new xe(122),97:new xe(97),98:new xe(98),99:new xe(99),100:new xe(100),101:new xe(101),102:new xe(102),103:new xe(103),104:new xe(104),105:new xe(105),106:new xe(106),107:new xe(107),108:new xe(108),109:new xe(109),110:new xe(110),111:new xe(111),112:new xe(112),113:new xe(113),114:new xe(114),115:new xe(115),116:new xe(116),117:new xe(117),118:new xe(118),119:new xe(119),120:new xe(120),121:new xe(121),122:new xe(122),913:new xe(945),914:new xe(946),915:new xe(947),916:new xe(948),917:new xe(949),918:new xe(950),919:new xe(951),920:new xe(952),921:new xe(953),922:new xe(954),923:new xe(955),924:new xe(956),925:new xe(957),926:new xe(958),927:new xe(959),928:new xe(960),929:new xe(961),931:new xe(963),932:new xe(964),933:new xe(965),934:new xe(966),935:new xe(967),936:new xe(968),937:new xe(969),945:new xe(945),946:new xe(946),947:new xe(947),948:new xe(948),949:new xe(949),950:new xe(950),951:new xe(951),952:new xe(952),953:new xe(953),954:new xe(954),955:new xe(955),956:new xe(956),957:new xe(957),958:new xe(958),959:new xe(959),960:new xe(960),961:new xe(961),963:new xe(963),964:new xe(964),965:new xe(965),966:new xe(966),967:new xe(967),968:new xe(968),969:new xe(969)},uc:{65:new xe(65),66:new xe(66),67:new xe(67),68:new xe(68),69:new xe(69),70:new xe(70),71:new xe(71),72:new xe(72),73:new xe(73),74:new xe(74),75:new xe(75),76:new xe(76),77:new xe(77),78:new xe(78),79:new xe(79),80:new xe(80),81:new xe(81),82:new xe(82),83:new xe(83),84:new xe(84),85:new xe(85),86:new xe(86),87:new xe(87),88:new xe(88),89:new xe(89),90:new xe(90),97:new xe(65),98:new xe(66),99:new xe(67),100:new xe(68),101:new xe(69),102:new xe(70),103:new xe(71),104:new xe(72),105:new xe(73),106:new xe(74),107:new xe(75),108:new xe(76),109:new xe(77),110:new xe(78),111:new xe(79),112:new xe(80),113:new xe(81),114:new xe(82),115:new xe(83),116:new xe(84),117:new xe(85),118:new xe(86),119:new xe(87),120:new xe(88),121:new xe(89),122:new xe(90),913:new xe(913),914:new xe(914),915:new xe(915),916:new xe(916),917:new xe(917),918:new xe(918),919:new xe(919),920:new xe(920),921:new xe(921),922:new xe(922),923:new xe(923),924:new xe(924),925:new xe(925),926:new xe(926),927:new xe(927),928:new xe(928),929:new xe(929),931:new xe(931),932:new xe(932),933:new xe(933),934:new xe(934),935:new xe(935),936:new xe(936),937:new xe(937),945:new xe(913),946:new xe(914),947:new xe(915),948:new xe(916),949:new xe(917),950:new xe(918),951:new xe(919),952:new xe(920),953:new xe(921),954:new xe(922),955:new xe(923),956:new xe(924),957:new xe(925),958:new xe(926),959:new xe(927),960:new xe(928),961:new xe(929),963:new xe(931),964:new xe(932),965:new xe(933),966:new xe(934),967:new xe(935),968:new xe(936),969:new xe(937)}},Ae=[Ce.defs.primitive.catcode,Ce.defs.primitive.count,Ce.defs.primitive.day,Ce.defs.primitive.dimen,Ce.defs.primitive.lccode,Ce.defs.primitive.mathcode,Ce.defs.primitive.meaning,Ce.defs.primitive.month,Ce.defs.primitive.muskip,Ce.defs.primitive.skip,Ce.defs.primitive.time,Ce.defs.primitive.uccode,Ce.defs.primitive.year],Te=[Ce.defs.primitive.the,Ce.defs.primitive.expandafter,Ce.defs.primitive.number,Ce.defs.primitive.romannumeral,Ce.defs.primitive.csname,Ce.defs.primitive.string,Ce.defs.primitive.if,Ce.defs.primitive.ifcase,Ce.defs.primitive.ifcat,Ce.defs.primitive.ifdim,Ce.defs.primitive.ifeof,Ce.defs.primitive.iffalse,Ce.defs.primitive.ifodd,Ce.defs.primitive.ifnum,Ce.defs.primitive.ifhmode,Ce.defs.primitive.ifinner,Ce.defs.primitive.ifmmode,Ce.defs.primitive.iftrue,Ce.defs.primitive.ifvmode,Ce.defs.primitive.ifvoid,Ce.defs.primitive.ifx];function l(e,s,r,t){var i,a,n,l=[];if(e)for(;;){if(!(i=s.eat()))return this.invalid=!0,s.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE)if(a="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])if(a===Ce.defs.primitive.if||a.isLet&&a.original===Ce.defs.primitive.if||a===Ce.defs.primitive.ifcase||a.isLet&&a.original===Ce.defs.primitive.ifcase||a===Ce.defs.primitive.ifcat||a.isLet&&a.original===Ce.defs.primitive.ifcat||a===Ce.defs.primitive.ifdim||a.isLet&&a.original===Ce.defs.primitive.ifdim||a===Ce.defs.primitive.ifeof||a.isLet&&a.original===Ce.defs.primitive.ifeof||a===Ce.defs.primitive.iffalse||a.isLet&&a.original===Ce.defs.primitive.iffalse||a===Ce.defs.primitive.ifodd||a.isLet&&a.original===Ce.defs.primitive.ifodd||a===Ce.defs.primitive.ifnum||a.isLet&&a.original===Ce.defs.primitive.ifnum||a===Ce.defs.primitive.ifhmode||a.isLet&&a.original===Ce.defs.primitive.ifhmode||a===Ce.defs.primitive.ifinner||a.isLet&&a.original===Ce.defs.primitive.ifinner||a===Ce.defs.primitive.ifmmode||a.isLet&&a.original===Ce.defs.primitive.ifmmode||a===Ce.defs.primitive.iftrue||a.isLet&&a.original===Ce.defs.primitive.iftrue||a===Ce.defs.primitive.ifvmode||a.isLet&&a.original===Ce.defs.primitive.ifvmode||a===Ce.defs.primitive.ifvoid||a.isLet&&a.original===Ce.defs.primitive.ifvoid||a===Ce.defs.primitive.ifx||a.isLet&&a.original===Ce.defs.primitive.ifx){if(!(n=c()))return this.invalid=!0,s.loadState(t),[this];l.push(i),l.push.apply(l,n)}else if(a===Ce.defs.primitive.else||a.proxy&&a.original===Ce.defs.primitive.else)o("fi");else{if(a===Ce.defs.primitive.fi||a.proxy&&a.original===Ce.defs.primitive.fi)break;l.push(i)}else l.push(i);else l.push(i)}else for(o("else");;){if(!(i=s.eat()))return this.invalid=!0,s.loadState(t),[this];if("command"==i.type||"character"==i.type&&i.cat==we.ACTIVE)if(a="command"==i.type?r.last().defs.primitive[i.name]||r.last().defs.macros[i.name]:r.last().defs.active[i.char])if(a===Ce.defs.primitive.if||a.isLet&&a.original===Ce.defs.primitive.if||a===Ce.defs.primitive.ifcase||a.isLet&&a.original===Ce.defs.primitive.ifcase||a===Ce.defs.primitive.ifcat||a.isLet&&a.original===Ce.defs.primitive.ifcat||a===Ce.defs.primitive.ifdim||a.isLet&&a.original===Ce.defs.primitive.ifdim||a===Ce.defs.primitive.ifeof||a.isLet&&a.original===Ce.defs.primitive.ifeof||a===Ce.defs.primitive.iffalse||a.isLet&&a.original===Ce.defs.primitive.iffalse||a===Ce.defs.primitive.ifodd||a.isLet&&a.original===Ce.defs.primitive.ifodd||a===Ce.defs.primitive.ifnum||a.isLet&&a.original===Ce.defs.primitive.ifnum||a===Ce.defs.primitive.ifhmode||a.isLet&&a.original===Ce.defs.primitive.ifhmode||a===Ce.defs.primitive.ifinner||a.isLet&&a.original===Ce.defs.primitive.ifinner||a===Ce.defs.primitive.ifmmode||a.isLet&&a.original===Ce.defs.primitive.ifmmode||a===Ce.defs.primitive.iftrue||a.isLet&&a.original===Ce.defs.primitive.iftrue||a===Ce.defs.primitive.ifvmode||a.isLet&&a.original===Ce.defs.primitive.ifvmode||a===Ce.defs.primitive.ifvoid||a.isLet&&a.original===Ce.defs.primitive.ifvoid||a===Ce.defs.primitive.ifx||a.isLet&&a.original===Ce.defs.primitive.ifx){if(!(n=c()))return this.invalid=!0,s.loadState(t),[this];l.push(i),l.push.apply(l,n)}else{if(a&&(a===Ce.defs.primitive.fi||a.proxy&&a.original===Ce.defs.primitive.fi))break;l.push(i)}else l.push(i);else l.push(i)}return l;function o(e){for(;;){var t=s.eat();if(!t)return;if("command"==t.type||"character"==t.type&&t.cat===we.ACTIVE){t="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(t)if(t===Ce.defs.primitive.if||t.isLet&&t.original===Ce.defs.primitive.if||t===Ce.defs.primitive.ifcase||t.isLet&&t.original===Ce.defs.primitive.ifcase||t===Ce.defs.primitive.ifcat||t.isLet&&t.original===Ce.defs.primitive.ifcat||t===Ce.defs.primitive.ifdim||t.isLet&&t.original===Ce.defs.primitive.ifdim||t===Ce.defs.primitive.ifeof||t.isLet&&t.original===Ce.defs.primitive.ifeof||t===Ce.defs.primitive.iffalse||t.isLet&&t.original===Ce.defs.primitive.iffalse||t===Ce.defs.primitive.ifodd||t.isLet&&t.original===Ce.defs.primitive.ifodd||t===Ce.defs.primitive.ifnum||t.isLet&&t.original===Ce.defs.primitive.ifnum||t===Ce.defs.primitive.ifhmode||t.isLet&&t.original===Ce.defs.primitive.ifhmode||t===Ce.defs.primitive.ifinner||t.isLet&&t.original===Ce.defs.primitive.ifinner||t===Ce.defs.primitive.ifmmode||t.isLet&&t.original===Ce.defs.primitive.ifmmode||t===Ce.defs.primitive.iftrue||t.isLet&&t.original===Ce.defs.primitive.iftrue||t===Ce.defs.primitive.ifvmode||t.isLet&&t.original===Ce.defs.primitive.ifvmode||t===Ce.defs.primitive.ifvoid||t.isLet&&t.original===Ce.defs.primitive.ifvoid||t===Ce.defs.primitive.ifx||t.isLet&&t.original===Ce.defs.primitive.ifx)o("fi"),s.eat();else{if("else"==e&&(t===Ce.defs.primitive.else||t.isLet&&t.original===Ce.defs.primitive.else))return;if(t===Ce.defs.primitive.fi||t.isLet&&t.original===Ce.defs.primitive.fi)return void s.revert()}}}}function c(){for(var e=[];;){var t=s.eat();if(!t)return null;if("command"==t.type||"character"==t.type&&t.cat===we.ACTIVE){var i="command"==t.type?r.last().defs.primitive[t.name]||r.last().defs.macros[t.name]:r.last().defs.active[t.char];if(i){if(i===Ce.defs.primitive.if||i.isLet&&i.original===Ce.defs.primitive.if||i===Ce.defs.primitive.ifcase||i.isLet&&i.original===Ce.defs.primitive.ifcase||i===Ce.defs.primitive.ifcat||i.isLet&&i.original===Ce.defs.primitive.ifcat||i===Ce.defs.primitive.ifdim||i.isLet&&i.original===Ce.defs.primitive.ifdim||i===Ce.defs.primitive.ifeof||i.isLet&&i.original===Ce.defs.primitive.ifeof||i===Ce.defs.primitive.iffalse||i.isLet&&i.original===Ce.defs.primitive.iffalse||i===Ce.defs.primitive.ifodd||i.isLet&&i.original===Ce.defs.primitive.ifodd||i===Ce.defs.primitive.ifnum||i.isLet&&i.original===Ce.defs.primitive.ifnum||i===Ce.defs.primitive.ifhmode||i.isLet&&i.original===Ce.defs.primitive.ifhmode||i===Ce.defs.primitive.ifinner||i.isLet&&i.original===Ce.defs.primitive.ifinner||i===Ce.defs.primitive.ifmmode||i.isLet&&i.original===Ce.defs.primitive.ifmmode||i===Ce.defs.primitive.iftrue||i.isLet&&i.original===Ce.defs.primitive.iftrue||i===Ce.defs.primitive.ifvmode||i.isLet&&i.original===Ce.defs.primitive.ifvmode||i===Ce.defs.primitive.ifvoid||i.isLet&&i.original===Ce.defs.primitive.ifvoid||i===Ce.defs.primitive.ifx||i.isLet&&i.original===Ce.defs.primitive.ifx){var a=c();if(a){e.push(t),e.push.apply(e,a);continue}return null}if(e.push(t),i===Ce.defs.primitive.fi||i.isLet&&i.original===Ce.defs.primitive.fi)return e}else e.push(t)}else e.push(t)}}}Ce.defs.primitive.crcr.function=Ce.defs.primitive.cr.function;var i,a,s="`";S.global(String.raw((i=["\n    defmakeatletter{catcode","@=11\relax}\n    defmakeatother{catcode","@=12\relax}\n    makeatletter\n    count10=23\n    count11=9\n    count12=9\n    count13=9\n    countdefinsc@unt=20\n    countdefallocationnumber=21\n    countdefm@ne=22 m@ne=-1\n    countdefcount@=255\n    dimendefdimen@=0\n    dimendefdimen@i=1\n    dimendefdimen@ii=2\n    skipdefskip@=0\n    def\newcount{alloc@0countcountdef}\n    def\newdimen{alloc@1dimendimendef}\n    def\newskip{alloc@2skipskipdef}\n    def\newmuskip{alloc@3muskipmuskipdef}\n    defalloc@#1#2#3#4{\n      advancecount1#1by1\n      allocationnumber=count1#1\n      #3#4=allocationnumber\n    }\n    \newdimenmaxdimen maxdimen=137438953471.99998pt\n    \newskiphideskip hideskip=-1000pt plus 1fil\n    \newskipcentering centering=0pt plus 1000pt minus 1000pt\n    def\newif#1{\n      {lccode","9=","i lccode","8=",void 0,"{\n    mathchardef}=","}\n    mathchardef$=","$\n    mathchardef#=","#\n    mathchardef%=","%\n    mathchardef&=","&\n    mathchardef_=",'_\n    mathchardefaa="700E5\n    mathchardefae="700E6\n    mathchardefaleph="02135\n    mathchardefalpha="703B1\n    mathchardefamalg="22A3F\n    mathchardefangle="02220\n    mathchardefapprox="32248\n    mathchardefarrowvert="023D0\n    mathchardefast="2002A\n    mathchardefasymp="3224D\n    mathchardef\backslash=','\\\n    mathchardef\beta="703B2\n    mathchardef\bigcap="122C2\n    mathchardef\bigcirc="225EF\n    mathchardef\bigcup="122C3\n    mathchardef\bigodot="12A00\n    mathchardef\bigoplus="12A01\n    mathchardef\bigotimes="12A02\n    mathchardef\bigtriangleup="225B3\n    mathchardef\bigtriangledown="225BD\n    mathchardef\bigsqcup="12A06\n    mathchardef\biguplus="12A04\n    mathchardef\bigvee="122C1\n    mathchardef\bigwedge="122C0\n    mathchardef\bot="022A5\n    mathchardef\bracevert="023AA\n    mathchardef\bowtie="322C8\n    mathchardef\bullet="22022\n    mathchardefcap="22229\n    mathchardefcdot="222C5\n    mathchardefcdotp="622C5\n    mathchardefchi="703C7\n    mathchardefcirc="225CB\n    mathchardefclubsuit="02663\n    mathchardefcolon="6003A\n    mathchardefcong="32245\n    mathchardefcoprod="12210\n    mathchardefcup="2222A\n    mathchardefdag="02020\n    mathchardefdagger="22020\n    mathchardefdashv="322A3\n    mathchardefddag="02021\n    mathchardefddagger="22021\n    mathchardefdelta="703B4\n    mathchardefdiamond="222C4\n    mathchardefdiamondsuit="02662\n    mathchardefdiv="200F7\n    mathchardefdoteq="32250\n    mathchardefdownarrow="02193\n    mathchardefell="02113\n    mathchardefemptyset="02205\n    mathchardefepsilon="703F5\n    mathchardefequiv="32261\n    mathchardefeta="703B7\n    mathchardefexists="02203\n    mathchardef\flat="0266D\n    mathchardef\forall="02200\n    mathchardef\frown="32322\n    mathchardefgamma="703B3\n    mathchardefge="32265 letgeq=ge\n    mathchardefgg="3226B\n    mathchardefhbar="70127\n    mathchardefheartsuit="02661\n    mathchardefhookleftarrow="321AA\n    mathchardefhookrightarrow="321A9\n    mathchardefimath="70131\n    mathchardefin="32208\n    mathchardefinfty="0221E\n    mathchardefintop="1222B defint{intop\nolimits}\n    mathchardefiota="703B9\n    mathchardefjmath="70237\n    mathchardefkappa="703BA\n    mathchardefl="00142\n    mathchardeflambda="703BB\n    mathchardeflangle="027E8\n    mathchardeflbrace=','{\n    mathchardeflceil="02308\n    mathchardefldotp="6002E\n    mathchardefle="32264 letleq=le\n    mathchardefleftarrow="32190 letgets=leftarrow\n    mathchardefleftharpoondown="321BD\n    mathchardefleftharpoonup="321BC\n    mathchardefleftrightarrow="32194\n    mathchardeflfloor="0230A\n    mathchardeflgroup="027EE\n    mathchardefll="3226A\n    mathchardeflmoustache="023B0\n    mathchardeflongleftarrow="327F5\n    mathchardeflongleftrightarrow="327F7\n    mathchardeflongmapsto="327FC\n    mathchardeflongrightarrow="327F6\n    mathchardefmapsto="321A6\n    mathchardefmid="32223\n    mathchardefmodels="322A7\n    mathchardefmp="22213\n    mathchardefmu="703BC\n    mathchardef\nabla="02207\n    mathchardef\natural="0266E\n    mathchardef\nearrow="32197\n    mathchardef\neg="000AC letlnot=\neg\n    mathchardef\ne="32260 let\neq=\ne\n    mathchardef\ni="3220B letowns=\ni\n    mathchardef\notin="32209\n    mathchardef\nu="703BD\n    mathchardef\nwarrow="32196\n    mathchardefo="700F8\n    mathchardefodot="22299\n    mathchardefoe="70153\n    mathchardefointop="1222E defoint{ointop\nolimits}\n    mathchardefomega="703C9\n    mathchardefominus="22296\n    mathchardefoplus="22295\n    mathchardefoslash="22298\n    mathchardefotimes="22297\n    mathchardefparallel="32225\n    mathchardefpartial="02202\n    mathchardefperp="322A5\n    mathchardefphi="703D5\n    mathchardefpi="703C0\n    mathchardefpm="200B1\n    mathchardefprec="3227A\n    mathchardefpreceq="3227C\n    mathchardefprime="02032\n    mathchardefprod="1220F\n    mathchardefpropto="3221D\n    mathchardefpsi="703C8\n    mathchardef\rangle="027E9\n    mathchardef\rbrace=',void 0,void 0,void 0," =13\relax}\n    catcode"," =12defspace{ }obeyspaceslet =space\n    catcode"," =10\n    \newcountmscount\n    defmultispan#1{omit mscount#1\relaxloopifnummscount>1sp@n\repeat}\n    defsp@n{spanomitadvancemscount-1}\n    def\two@digits#1{ifnum#1<10 0\fi\the#1}\n    defdospecials{do do\\do{do}do$do&do#do^do^^Kdo_do^^Ado%do~}\n    defmathpalette#1#2{      mathchoice{#1displaystyle{#2}}{#1\textstyle{#2}}{#1scriptstyle{#2}}{#1scriptscriptstyle{#2}}}\n    def\binom#1#2{{{#1}atopwithdelims(){#2}}}\n    def\frac#1#2{{{#1}over{#2}}}\n    defmathrm#1{{\rm#1}}\n    def\textrm#1{{\rm#1}}\n    defmathbf#1{{\bf#1}}\n    def\textbf#1{{\bf#1}}\n    defmathit#1{{it#1}}\n    def\textit#1{{it#1}}\n    defmathsl#1{{sl#1}}\n    def\textsl#1{{sl#1}}\n    def@gobble#1{}\n    def@ifnextchar#1#2#3{\n      let@ifnextchar@charone=#1\n      def@ifnextchar@true{#2}\n      def@ifnextchar@false{#3}\n      \futurelet@ifnextchar@chartwo@ifnextchar@check}\n    def@ifnextchar@check{\n      ifx@ifnextchar@charone@ifnextchar@chartwo@ifnextchar@trueelse@ifnextchar@false\fi}\n    def\newcommand#1{@ifnextchar[{@newcommand#1}{@newcommand#1[0]}}\n    def@newcommand#1[#2]{\n      count0=#2\n      ifnumcount0<0\n        Error{Not Enough Parameters}\n      else\n        ifnumcount0>9\n          Error{TooManyParameters}\n        else\n          @ifnextchar[{ifnumcount0<1\n            Error{ParameterNumberMustBe>0}\n          else\n            @newcommand@optarg#1[#2]\n          \fi}{@newcommand@nooptarg#1[#2]}\n        \fi\n      \fi\n    }\n    def@paramnums#1{\n      ifcase#1\n      or####1\n      or####1####2\n      or####1####2####3\n      or####1####2####3####4\n      or####1####2####3####4####5\n      or####1####2####3####4####5####6\n      or####1####2####3####4####5####6####7\n      or####1####2####3####4####5####6####7####8\n      or####1####2####3####4####5####6####7####8####9\fi}\n    def@paramnums@bracket#1{\n      ifcase#1\n      or[####1]\n      or[####1]####2\n      or[####1]####2####3\n      or[####1]####2####3####4\n      or[####1]####2####3####4####5\n      or[####1]####2####3####4####5####6\n      or[####1]####2####3####4####5####6####7\n      or[####1]####2####3####4####5####6####7####8\n      or[####1]####2####3####4####5####6####7####8####9\fi}\n    def@newcommand@nooptarg#1[#2]#{\n      edef@newcommand@make{def\noexpand#1@paramnums#2}\n      @newcommand@make}\n    def@newcommand@optarg#1[#2][#3]#{\n      def#1{\n        @ifnextchar[{csnamestring#1endcsname}{csnamestring#1endcsname[#3]}}\n      edef@newcommand@make{\n        \noexpandexpandafterdef\n        \noexpandcsname\noexpandstring\noexpand#1endcsname@paramnums@bracket#2}\n      @newcommand@make}\n    \newcommandsqrt[1][]{\root #1of }}\n    makeatother\n  "],a=(a=["\n    \\def\\makeatletter{\\catcode","\\@=11\\relax}\n    \\def\\makeatother{\\catcode","\\@=12\\relax}\n    \\makeatletter\n    \\count10=23\n    \\count11=9\n    \\count12=9\n    \\count13=9\n    \\countdef\\insc@unt=20\n    \\countdef\\allocationnumber=21\n    \\countdef\\m@ne=22 \\m@ne=-1\n    \\countdef\\count@=255\n    \\dimendef\\dimen@=0\n    \\dimendef\\dimen@i=1\n    \\dimendef\\dimen@ii=2\n    \\skipdef\\skip@=0\n    \\def\\newcount{\\alloc@0\\count\\countdef}\n    \\def\\newdimen{\\alloc@1\\dimen\\dimendef}\n    \\def\\newskip{\\alloc@2\\skip\\skipdef}\n    \\def\\newmuskip{\\alloc@3\\muskip\\muskipdef}\n    \\def\\alloc@#1#2#3#4{\n      \\advance\\count1#1by1\n      \\allocationnumber=\\count1#1\n      #3#4=\\allocationnumber\n    }\n    \\newdimen\\maxdimen \\maxdimen=137438953471.99998pt\n    \\newskip\\hideskip \\hideskip=-1000pt plus 1fil\n    \\newskip\\centering \\centering=0pt plus 1000pt minus 1000pt\n    \\def\\newif#1{\n      {\\lccode","9=","i \\lccode","8=",'f \\lowercase{\\gdef\\@remove@if##198##2{##2}}}\n      \\expandafter\\expandafter\\expandafter\n      \\def\\expandafter\\expandafter\\expandafter\n      \\@if@name\\expandafter\\expandafter\\expandafter{\\expandafter\\@remove@if\\string#1}\n      \\expandafter\\def\\expandafter\\@if@name@bool\\expandafter##\\expandafter1\\expandafter{\\@if@name##1}\n      \\expandafter\\def\\csname\\@if@name@bool{true}\\endcsname{\n        \\let#1=\\iftrue\n      }\n      \\expandafter\\def\\csname\\@if@name@bool{false}\\endcsname{\n        \\let#1=\\iffalse\n      }\n      \\let#1=\\iffalse\n      \\let\\@if@name=\\undefined\n      \\let\\@if@name@bool=\\undefined\n      \\let\\@remove@if=\\undefined\n    }\n    \\newcount\\active \\active=13\n    \\newskip\\smallskipamount \\smallskipamount=3pt plus 1pt minus 1pt\n    \\newskip\\medskipamount \\medskipamount=6pt plus 2pt minus 2pt\n    \\newskip\\bigskipamount \\bigskipamount=12pt plus 4pt minus 4pt\n    \\newskip\\normalbaselineskip \\normalbaselineskip=12pt\n    \\newskip\\normallineskip \\normallineskip=1pt\n    \\newdimen\\normallineskiplimit \\normallineskiplimit=0pt\n    \\newdimen\\jot \\jot=3pt\n    \\newcount\\interdisplaylinepenalty \\interdisplaylinepenalty=100\n    \\newcount\\interfootnotelinepenalty \\interfootnotelinepenalty=100\n    \\mathchardef\\\\="0000A\n    \\mathchardef\\ ="0020\n    \\mathchardef\\{=',"\\{\n    \\mathchardef\\}=","\\}\n    \\mathchardef\\$=","\\$\n    \\mathchardef\\#=","\\#\n    \\mathchardef\\%=","\\%\n    \\mathchardef\\&=","\\&\n    \\mathchardef\\_=",'\\_\n    \\mathchardef\\aa="700E5\n    \\mathchardef\\ae="700E6\n    \\mathchardef\\aleph="02135\n    \\mathchardef\\alpha="703B1\n    \\mathchardef\\amalg="22A3F\n    \\mathchardef\\angle="02220\n    \\mathchardef\\approx="32248\n    \\mathchardef\\arrowvert="023D0\n    \\mathchardef\\ast="2002A\n    \\mathchardef\\asymp="3224D\n    \\mathchardef\\backslash=','\\\\\n    \\mathchardef\\beta="703B2\n    \\mathchardef\\bigcap="122C2\n    \\mathchardef\\bigcirc="225EF\n    \\mathchardef\\bigcup="122C3\n    \\mathchardef\\bigodot="12A00\n    \\mathchardef\\bigoplus="12A01\n    \\mathchardef\\bigotimes="12A02\n    \\mathchardef\\bigtriangleup="225B3\n    \\mathchardef\\bigtriangledown="225BD\n    \\mathchardef\\bigsqcup="12A06\n    \\mathchardef\\biguplus="12A04\n    \\mathchardef\\bigvee="122C1\n    \\mathchardef\\bigwedge="122C0\n    \\mathchardef\\bot="022A5\n    \\mathchardef\\bracevert="023AA\n    \\mathchardef\\bowtie="322C8\n    \\mathchardef\\bullet="22022\n    \\mathchardef\\cap="22229\n    \\mathchardef\\cdot="222C5\n    \\mathchardef\\cdotp="622C5\n    \\mathchardef\\chi="703C7\n    \\mathchardef\\circ="225CB\n    \\mathchardef\\clubsuit="02663\n    \\mathchardef\\colon="6003A\n    \\mathchardef\\cong="32245\n    \\mathchardef\\coprod="12210\n    \\mathchardef\\cup="2222A\n    \\mathchardef\\dag="02020\n    \\mathchardef\\dagger="22020\n    \\mathchardef\\dashv="322A3\n    \\mathchardef\\ddag="02021\n    \\mathchardef\\ddagger="22021\n    \\mathchardef\\delta="703B4\n    \\mathchardef\\diamond="222C4\n    \\mathchardef\\diamondsuit="02662\n    \\mathchardef\\div="200F7\n    \\mathchardef\\doteq="32250\n    \\mathchardef\\downarrow="02193\n    \\mathchardef\\ell="02113\n    \\mathchardef\\emptyset="02205\n    \\mathchardef\\epsilon="703F5\n    \\mathchardef\\equiv="32261\n    \\mathchardef\\eta="703B7\n    \\mathchardef\\exists="02203\n    \\mathchardef\\flat="0266D\n    \\mathchardef\\forall="02200\n    \\mathchardef\\frown="32322\n    \\mathchardef\\gamma="703B3\n    \\mathchardef\\ge="32265 \\let\\geq=\\ge\n    \\mathchardef\\gg="3226B\n    \\mathchardef\\hbar="70127\n    \\mathchardef\\heartsuit="02661\n    \\mathchardef\\hookleftarrow="321AA\n    \\mathchardef\\hookrightarrow="321A9\n    \\mathchardef\\imath="70131\n    \\mathchardef\\in="32208\n    \\mathchardef\\infty="0221E\n    \\mathchardef\\intop="1222B \\def\\int{\\intop\\nolimits}\n    \\mathchardef\\iota="703B9\n    \\mathchardef\\jmath="70237\n    \\mathchardef\\kappa="703BA\n    \\mathchardef\\l="00142\n    \\mathchardef\\lambda="703BB\n    \\mathchardef\\langle="027E8\n    \\mathchardef\\lbrace=','\\{\n    \\mathchardef\\lceil="02308\n    \\mathchardef\\ldotp="6002E\n    \\mathchardef\\le="32264 \\let\\leq=\\le\n    \\mathchardef\\leftarrow="32190 \\let\\gets=\\leftarrow\n    \\mathchardef\\leftharpoondown="321BD\n    \\mathchardef\\leftharpoonup="321BC\n    \\mathchardef\\leftrightarrow="32194\n    \\mathchardef\\lfloor="0230A\n    \\mathchardef\\lgroup="027EE\n    \\mathchardef\\ll="3226A\n    \\mathchardef\\lmoustache="023B0\n    \\mathchardef\\longleftarrow="327F5\n    \\mathchardef\\longleftrightarrow="327F7\n    \\mathchardef\\longmapsto="327FC\n    \\mathchardef\\longrightarrow="327F6\n    \\mathchardef\\mapsto="321A6\n    \\mathchardef\\mid="32223\n    \\mathchardef\\models="322A7\n    \\mathchardef\\mp="22213\n    \\mathchardef\\mu="703BC\n    \\mathchardef\\nabla="02207\n    \\mathchardef\\natural="0266E\n    \\mathchardef\\nearrow="32197\n    \\mathchardef\\neg="000AC \\let\\lnot=\\neg\n    \\mathchardef\\ne="32260 \\let\\neq=\\ne\n    \\mathchardef\\ni="3220B \\let\\owns=\\ni\n    \\mathchardef\\notin="32209\n    \\mathchardef\\nu="703BD\n    \\mathchardef\\nwarrow="32196\n    \\mathchardef\\o="700F8\n    \\mathchardef\\odot="22299\n    \\mathchardef\\oe="70153\n    \\mathchardef\\ointop="1222E \\def\\oint{\\ointop\\nolimits}\n    \\mathchardef\\omega="703C9\n    \\mathchardef\\ominus="22296\n    \\mathchardef\\oplus="22295\n    \\mathchardef\\oslash="22298\n    \\mathchardef\\otimes="22297\n    \\mathchardef\\parallel="32225\n    \\mathchardef\\partial="02202\n    \\mathchardef\\perp="322A5\n    \\mathchardef\\phi="703D5\n    \\mathchardef\\pi="703C0\n    \\mathchardef\\pm="200B1\n    \\mathchardef\\prec="3227A\n    \\mathchardef\\preceq="3227C\n    \\mathchardef\\prime="02032\n    \\mathchardef\\prod="1220F\n    \\mathchardef\\propto="3221D\n    \\mathchardef\\psi="703C8\n    \\mathchardef\\rangle="027E9\n    \\mathchardef\\rbrace=','\\}\n    \\mathchardef\\rceil="02309\n    \\mathchardef\\relbar="3002D\n    \\mathchardef\\rfloor="0230B\n    \\mathchardef\\rgroup="027EF\n    \\mathchardef\\rho="703C1\n    \\mathchardef\\rightarrow="32192 \\let\\to=\\rightarrow\n    \\mathchardef\\rightharpoondown="321C1\n    \\mathchardef\\rightharpoonup="321C0\n    \\mathchardef\\rightleftharpoons="321CC\n    \\mathchardef\\rmoustache="023B1\n    \\mathchardef\\searrow="32198\n    \\mathchardef\\setminus="22216\n    \\mathchardef\\sharp="0266F\n    \\mathchardef\\sim="3223C\n    \\mathchardef\\simeq="32243\n    \\mathchardef\\sigma="703C3\n    \\mathchardef\\smile="32323\n    \\mathchardef\\sqcap="22293\n    \\mathchardef\\sqcup="22294\n    \\mathchardef\\sqsubseteq="32291\n    \\mathchardef\\sqsupseteq="32292\n    \\mathchardef\\ss="000DF\n    \\mathchardef\\star="222C6\n    \\mathchardef\\subset="32282\n    \\mathchardef\\subseteq="32286\n    \\mathchardef\\succ="3227B\n    \\mathchardef\\succeq="3227D\n    \\mathchardef\\sum="12211\n    \\mathchardef\\supset="32283\n    \\mathchardef\\supseteq="32287\n    \\mathchardef\\swarrow="32199\n    \\mathchardef\\tau="703C4\n    \\mathchardef\\theta="703B8\n    \\mathchardef\\times="200D7\n    \\mathchardef\\top="022A4\n    \\mathchardef\\triangle="025B3\n    \\mathchardef\\triangleleft="225C1\n    \\mathchardef\\triangleright="225B7\n    \\mathchardef\\ucup="2228E\n    \\mathchardef\\uparrow="02191\n    \\mathchardef\\updownarrow="02195\n    \\mathchardef\\upsilon="703C5\n    \\mathchardef\\varepsilon="703B5\n    \\mathchardef\\varphi="703C6\n    \\mathchardef\\varpi="703D6\n    \\mathchardef\\varrho="703F1\n    \\mathchardef\\varsigma="703C2\n    \\mathchardef\\vartheta="703D1\n    \\mathchardef\\vdash="322A2\n    \\mathchardef\\vee="22228 \\let\\lor=\\vee\n    \\mathchardef\\vert=','\\|\n    \\mathchardef\\wedge="22227 \\let\\land=\\wedge\n    \\mathchardef\\wp="02118\n    \\mathchardef\\wr="22240\n    \\mathchardef\\xi="703BE\n    \\mathchardef\\zeta="703B6\n    \\mathchardef\\AA="700C5\n    \\mathchardef\\AE="700C6\n    \\mathchardef\\Arrowvert="02225\n    \\mathchardef\\Delta="00394\n    \\mathchardef\\Downarrow="21D3\n    \\mathchardef\\Gamma="00393\n    \\mathchardef\\Im="02111\n    \\mathchardef\\L="00141\n    \\mathchardef\\Lambda="0039B\n    \\mathchardef\\Leftarrow="321D0\n    \\mathchardef\\Leftrightarrow="321D4\n    \\mathchardef\\Longleftarrow="327F8\n    \\mathchardef\\Longleftrightarrow="327FA\n    \\mathchardef\\Longrightarrow="327F9\n    \\mathchardef\\O="700D8\n    \\mathchardef\\OE="70152\n    \\mathchardef\\Omega="003A9\n    \\mathchardef\\Orb="225EF\n    \\mathchardef\\P="000B6\n    \\mathchardef\\Phi="003A6\n    \\mathchardef\\Pi="003A0\n    \\mathchardef\\Psi="003A8\n    \\mathchardef\\Re="0211C\n    \\mathchardef\\Relbar="3003D\n    \\mathchardef\\Rightarrow="321D2\n    \\mathchardef\\S="000A7\n    \\mathchardef\\Sigma="003A3\n    \\mathchardef\\spadesuit="02660\n    \\mathchardef\\Theta="00398\n    \\mathchardef\\Uparrow="021D1\n    \\mathchardef\\Updownarrow="021D5\n    \\mathchardef\\Upsilon="003A5\n    \\mathchardef\\Vert="02016 \\let\\|=\\Vert\n    \\mathchardef\\Xi="0039E\n    \\def\\~{\\accent"02DC }\n    \\def\\,{\\mskip\\thinmuskip}\n    \\def\\>{\\mskip\\medmuskip}\n    \\def\\;{\\mskip\\thickmuskip}\n    \\def\\!{\\mskip-\\thinmuskip}\n    \\def\\"{\\accent"A8 }\n    \\def\\={\\accent"AF }\n    \\def\\^{\\accent"5E }\n    \\def\\.{\\accent"02D9 }\n    \\def\\acute{\\accent"B4 }\n    \\def\\arccos{\\mathop{\\rm arccos}\\nolimits}\n    \\def\\arcsin{\\mathop{\\rm arcsin}\\nolimits}\n    \\def\\arctan{\\mathop{\\rm arctan}\\nolimits}\n    \\def\\arg{\\mathop{\\rm arg}\\nolimits}\n    \\def\\bar{\\accent"AF }\n    \\def\\big#1{{\\n@space\\left#1\\vbox to 1em{}\\right.}}\n    \\def\\bigl{\\mathopen\\big}\n    \\def\\bigm{\\mathrel\\big}\n    \\def\\bigr{\\mathclose\\big}\n    \\def\\bigg#1{{\\n@space\\left#1\\vbox to 1.6em{}\\right.}}\n    \\def\\biggl{\\mathopen\\bigg}\n    \\def\\biggm{\\mathrel\\bigg}\n    \\def\\biggr{\\mathclose\\bigg}\n    \\def\\bmod{\\\n      \\nonscript\\mskip-\\medmuskip\\mkern5mu\\mathbin{\\rm mod}\\mkern5mu\\nonscript\\mskip-\\medmuskip}\n    \\def\\brace{\\atopwithdelims\\{\\}}\n    \\def\\brack{\\atopwithdelims[]}\n    \\def\\breve{\\accent"02D8 }\n    \\def\\buildrel#1\\over#2{\\mathrel{\\mathop{\\kern0pt#2}\\limits^{#1}}}\n    \\def\\cases#1{\n      \\left\\{\\,{\\halign{##\\hfil&\\quad##\\hfil\\cr#1\\crcr}}\\right.}\n    \\def\\cdots{\\mathinner{\\cdotp\\cdotp\\cdotp}}\n    \\def\\check{\\accent"02C7 }\n    \\def\\choose{\\atopwithdelims()}\n    \\def\\cong{\\mathrel{\\tilde=}}\n    \\def\\cos{\\mathop{\\rm cos}\\nolimits}\n    \\def\\cosh{\\mathop{\\rm cosh}\\nolimits}\n    \\def\\cot{\\mathop{\\rm cot}\\nolimits}\n    \\def\\coth{\\mathop{\\rm coth}\\nolimits}\n    \\def\\csc{\\mathop{\\rm csc}\\nolimits}\n    \\def\\ddot{\\accent"A8 }\n    \\def\\ddots{\\mathinner{\\char"22F1}}\n    \\def\\deg{\\mathop{\\rm deg}\\nolimits}\n    \\def\\det{\\mathop{\\rm det}}\n    \\def\\dim{\\mathop{\\rm dim}\\nolimits}\n    \\def\\dot{\\accent"02D9 }\n    \\def\\empty{}\n    \\def\\exp{\\mathop{\\rm exp}\\nolimits}\n    \\def\\gcd{\\mathop{\\rm gcd}}\n    \\def\\grave{\\accent"60 }\n    \\def\\hat{\\accent"5E }\n    \\def\\hom{\\mathop{\\rm hom}\\nolimits}\n    \\def\\hphantom#1{\\vbox to0pt{\\phantom#1}}\n    \\def\\iff{\\;\\Longleftrightarrow\\;}\n    \\def\\inf{\\mathop{\\rm inf}}\n    \\def\\iterate{\\body \\let\\next=\\iterate\\else\\let\\next=\\relax\\fi\\next}\n    \\def\\joinrel{\\mathrel{\\mkern-3mu}}\n    \\def\\ker{\\mathop{\\rm ker}\\nolimits}\n    \\def\\lbrack{[}\n    \\def\\ldots{\\mathinner{\\ldotp\\ldotp\\ldotp}}\n    \\def\\lg{\\mathop{\\rm lg}\\nolimits}\n    \\def\\lim{\\mathop{\\rm lim}}\n    \\def\\liminf{\\mathop{\\rm lim\\,inf}}\n    \\def\\limsup{\\mathop{\\rm lim\\,sup}}\n    \\def\\ln{\\mathop{\\rm ln}\\nolimits}\n    \\def\\log{\\mathop{\\rm log}\\nolimits}\n    \\def\\loop#1\\repeat{\\def\\body{#1}\\iterate}\n    \\def\\lq{','}\n    \\def\\mathstrut{\\vphantom(}\n    \\def\\matrix#1{\\,\\halign{\\hfil##\\hfil&&\\quad\\hfil##\\hfil\\cr#1\\crcr}\\,}\n    \\def\\max{\\mathop{\\rm max}}\n    \\def\\min{\\mathop{\\rm min}}\n    \\def\\n@space{\\nulldelimiterspace=0pt\\relax}\n    \\def\\not{\\@ifnextchar={\\mathchar"32260\\@gobble}{\\hbox to 0pt{/}}}}\n    \\def\\null{\\hbox{}}\n    \\def\\pmatrix#1{\\left(\\matrix{#1}\\right)}\n    \\def\\pmod#1{\\mkern18mu({\\rm mod}\\,\\,#1)}\n    \\def\\rbrack{]}\n    \\def\\rq{\\\'}\n    \\def\\sec{\\mathop{\\rm sec}\\nolimits}\n    \\def\\sin{\\mathop{\\rm sin}\\nolimits}\n    \\def\\sinh{\\mathop{\\rm sinh}\\nolimits}\n    \\def\\skew#1#2#3{{\\muskip0 #1mu\\divide\\muskip0by2 \\mkern\\muskip0%\n      #2{\\mkern-\\muskip0{#3}\\mkern\\muskip0}\\mkern-\\muskip0}{}}\n    \\def\\strut{\\vrule height.708333333emdepth.291666666emwidth0pt\\relax}\n    \\def\\sup{\\mathop{\\rm sup}}\n    \\def\\surd{{\\mathchar"1221A}}\n    \\def\\t{\\accent"0311 }\n    \\def\\tan{\\mathop{\\rm tan}\\nolimits}\n    \\def\\tanh{\\mathop{\\rm tanh}\\nolimits}\n    \\def\\thinspace{\\kern.1667em}\n    \\def\\tilde{\\accent"02DC }\n    \\def\\u{\\accent"02D8 }\n    \\def\\v{\\accent"02C7 }\n    \\def\\vdots{\\mathinner{\\char"22EE}}\n    \\def\\vphantom#1{\\hbox to0pt{\\phantom#1}}\n    \\def\\Big#1{{\\n@space\\left#1\\vbox to 1.3em{}\\right.}}\n    \\def\\Bigl{\\mathopen\\Big}\n    \\def\\Bigm{\\mathrel\\Big}\n    \\def\\Bigr{\\mathclose\\Big}\n    \\def\\Bigg#1{{\\n@space\\left#1\\vbox to 1.9em{}\\right.}}\n    \\def\\Biggl{\\mathopen\\Bigg}\n    \\def\\Biggm{\\mathrel\\Bigg}\n    \\def\\Biggr{\\mathclose\\Bigg}\n    \\def\\H{\\accent"02DD }\n    \\def\\Pr{\\mathop{\\rm Pr}}\n    \\def\\TeX{T\\kern-.1667em{\\lower.5exE}\\kern-.125emX}\n    \\let\\bgroup={\n    \\let\\displaymath=\\[\n    \\let\\enddisplaymath=\\]\n    \\let\\egroup=}\n    \\let\\endline=\\cr\n    \\let\\math=\\(\n    \\let\\endmath=\\)\n    \\let\\sb=^\n    \\let\\sp=_\n    \\let\\repeat=\\fi\n    \\def\\negthinspace{\\kern-.1667em}\n    \\def\\enspace{\\kern.5em}\n    \\def\\enskip{\\hskip.5em\\relax}\n    \\def\\quad{\\hskip1em\\relax}\n    \\def\\qquad{\\hskip2em\\relax}\n    \\def\\smallskip{\\vskip\\smallskipamount}\n    \\def\\medskip{\\vskip\\medskipamount}\n    \\def\\bigskip{\\vskip\\bigskipamount}\n    \\def~{\\char"00A0\\relax}\n    \\def\\obeyspaces{\\catcode',"\\ =13\\relax}\n    \\catcode","\\ =12\\def\\space{ }\\obeyspaces\\let =\\space\n    \\catcode","\\ =10\n    \\newcount\\mscount\n    \\def\\multispan#1{\\omit \\mscount#1\\relax\\loop\\ifnum\\mscount>1\\sp@n\\repeat}\n    \\def\\sp@n{\\span\\omit\\advance\\mscount-1}\n    \\def\\two@digits#1{\\ifnum#1<10 0\\fi\\the#1}\n    \\def\\dospecials{\\do\\ \\do\\\\\\do\\{\\do\\}\\do\\$\\do\\&\\do\\#\\do\\^\\do\\^^K\\do\\_\\do\\^^A\\do\\%\\do\\~}\n    \\def\\mathpalette#1#2{\\\n      \\mathchoice{#1\\displaystyle{#2}}{#1\\textstyle{#2}}{#1\\scriptstyle{#2}}{#1\\scriptscriptstyle{#2}}}\n    \\def\\binom#1#2{{{#1}\\atopwithdelims(){#2}}}\n    \\def\\frac#1#2{{{#1}\\over{#2}}}\n    \\def\\mathrm#1{{\\rm#1}}\n    \\def\\textrm#1{{\\rm#1}}\n    \\def\\mathbf#1{{\\bf#1}}\n    \\def\\textbf#1{{\\bf#1}}\n    \\def\\mathit#1{{\\it#1}}\n    \\def\\textit#1{{\\it#1}}\n    \\def\\mathsl#1{{\\sl#1}}\n    \\def\\textsl#1{{\\sl#1}}\n    \\def\\@gobble#1{}\n    \\def\\@ifnextchar#1#2#3{\n      \\let\\@ifnextchar@charone=#1\n      \\def\\@ifnextchar@true{#2}\n      \\def\\@ifnextchar@false{#3}\n      \\futurelet\\@ifnextchar@chartwo\\@ifnextchar@check}\n    \\def\\@ifnextchar@check{\n      \\ifx\\@ifnextchar@charone\\@ifnextchar@chartwo\\@ifnextchar@true\\else\\@ifnextchar@false\\fi}\n    \\def\\newcommand#1{\\@ifnextchar[{\\@newcommand#1}{\\@newcommand#1[0]}}\n    \\def\\@newcommand#1[#2]{\n      \\count0=#2\n      \\ifnum\\count0<0\n        \\Error{Not Enough Parameters}\n      \\else\n        \\ifnum\\count0>9\n          \\Error{TooManyParameters}\n        \\else\n          \\@ifnextchar[{\\ifnum\\count0<1\n            \\Error{ParameterNumberMustBe>0}\n          \\else\n            \\@newcommand@optarg#1[#2]\n          \\fi}{\\@newcommand@nooptarg#1[#2]}\n        \\fi\n      \\fi\n    }\n    \\def\\@paramnums#1{\n      \\ifcase#1\n      \\or####1\n      \\or####1####2\n      \\or####1####2####3\n      \\or####1####2####3####4\n      \\or####1####2####3####4####5\n      \\or####1####2####3####4####5####6\n      \\or####1####2####3####4####5####6####7\n      \\or####1####2####3####4####5####6####7####8\n      \\or####1####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@paramnums@bracket#1{\n      \\ifcase#1\n      \\or[####1]\n      \\or[####1]####2\n      \\or[####1]####2####3\n      \\or[####1]####2####3####4\n      \\or[####1]####2####3####4####5\n      \\or[####1]####2####3####4####5####6\n      \\or[####1]####2####3####4####5####6####7\n      \\or[####1]####2####3####4####5####6####7####8\n      \\or[####1]####2####3####4####5####6####7####8####9\\fi}\n    \\def\\@newcommand@nooptarg#1[#2]#{\n      \\edef\\@newcommand@make{\\def\\noexpand#1\\@paramnums#2}\n      \\@newcommand@make}\n    \\def\\@newcommand@optarg#1[#2][#3]#{\n      \\def#1{\n        \\@ifnextchar[{\\csname\\string#1\\endcsname}{\\csname\\string#1\\endcsname[#3]}}\n      \\edef\\@newcommand@make{\n        \\noexpand\\expandafter\\def\n        \\noexpand\\csname\\noexpand\\string\\noexpand#1\\endcsname\\@paramnums@bracket#2}\n      \\@newcommand@make}\n    \\newcommand\\sqrt[1][]{\\root #1\\of }}\n    \\makeatother\n  "])||i.slice(0),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(a)}}))),s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s));var $e={widthOf:function(e,t,i){return t=k(t),i={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"],this.cache[t]&&this.cache[t][i]&&this.cache[t][i][e]&&!isNaN(this.cache[t][i][e].width)?this.cache[t][i][e].width:(this.context.font="".concat(i||""," 500px ").concat(t),this.cache[t]=this.cache[t]||{},this.cache[t][i]=this.cache[t][i]||{},this.cache[t][i][e]=this.cache[t][i][e]||{},this.cache[t][i][e].width=this.context.measureText(e).width/500)},visibleWidthOf:function(h,d,p){if(d=k(d),p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].vWidth))return this.cache[d][p][h].vWidth;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=0;o<150;o++){for(var c=0;c<150;c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?-1:250<s?e+(o/150-.5)/Math.pow(2,i):m.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="center";var e=m.call(this,.5,.5,0);if(-1==e)return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].vWidth=0;function u(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=149;0<=o;o--){for(var c=0;c<150;c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return 250<s?e+(o/150-.5)/Math.pow(2,i):u.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}var t=u.call(this,.5,.5,0);return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].vWidth=1.5*(t-e)+.01},heightOf:function(h,d,p){return d=k(d),p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].height)?this.cache[d][p][h].height:(this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].height=1.5*(1-m.call(this,.5,.5,0)));function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(1-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=0;o<150;o++){for(var c=0;c<150;c++)n<(s=r[4*o*150+4*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?1:250<s?t+(o/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(o/150-.5)/Math.pow(2,i),i+1)}},depthOf:function(h,d,p){return d=k(d),p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].depth)?Math.max(0,this.cache[d][p][h].depth):(this.context.textBaseline="alphabetic",this.context.textAlign="center",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},Math.max(0,this.cache[d][p][h].depth=1.5*(m.call(this,.5,.5,0)-.5)));function m(e,t,i){if(7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=149;0<=o;o--){for(var c=0;c<150;c++)n<(s=r[4*o*150+4*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?.5:250<s?t+(o/150-.5)/Math.pow(2,i):m.call(this,e+(l/150-.5)/Math.pow(2,i),t+(o/150-.5)/Math.pow(2,i),i+1)}},trueDepthOf:function(e,t,i){return this.depthOf(e,t,i),this.cache[k(t)][{nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[i||"nm"]][e].depth},italCorrOf:function(h,d){return d=k(d),this.cache[d]&&this.cache[d].italic&&this.cache[d].italic[h]&&!isNaN(this.cache[d].italic[h].italCorr)?this.cache[d].italic[h].italCorr:(this.context.textBaseline="middle",this.context.textAlign="left",this.cache[d]=this.cache[d]||{},this.cache[d].italic=this.cache[d].italic||{},this.cache[d].italic[h]=this.cache[d].italic[h]||{},this.cache[d].italic[h].italCorr=Math.max(0,1.5*p.call(this,.5,.5,0)-$e.widthOf(h,d,"it")));function p(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="italic ".concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*-e,75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=149;0<=o;o--){for(var c=0;c<150;c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?0:250<s?e+(o/150-.5)/Math.pow(2,i):p.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}},scriptOffsetOf:function(h,d,p){if(d=k(d),p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].scriptOffset))return this.cache[d][p][h].scriptOffset;function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=149;0<=o;o--){for(var c=0;c<Math.max(150,Math.min(0,c<75+150*a*(.5-t)));c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?0:250<s?e+(o/150-.5)/Math.pow(2,i):m.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}function u(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=149;0<=o;o--){for(var c=75;c<Math.max(150,c<75+150*a*(1-e));c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?1:250<s?e+(o/150-.5)/Math.pow(2,i):u.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}this.context.textBaseline="middle",this.context.textAlign="left";var e=m.call(this,.5,.5,0),t=u.call(this,.5,.5,0);return this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].scriptOffset=1.5*Math.max(e-t,0)},leftOffsetOf:function(h,d,p){return d=k(d),p={nm:"",rm:"",sl:"oblique",it:"italic",bf:"bold"}[p||"nm"],this.cache[d]&&this.cache[d][p]&&this.cache[d][p][h]&&!isNaN(this.cache[d][p][h].leftOffset)?this.cache[d][p][h].leftOffset:(this.context.textBaseline="middle",this.context.textAlign="start",this.cache[d]=this.cache[d]||{},this.cache[d][p]=this.cache[d][p]||{},this.cache[d][p][h]=this.cache[d][p][h]||{},this.cache[d][p][h].leftOffset=-1.5*(m.call(this,.5,.5,0)-.5));function m(e,t,i){if(7==i)return e;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(p||""," ").concat(100*a,"px ").concat(d),this.context.fillText(h,75+150*a*(.5-e),75+150*a*(.5-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=0;o<150;o++){for(var c=0;c<150;c++)n<(s=r[4*o+600*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?-1:250<s?e+(o/150-.5)/Math.pow(2,i):m.call(this,e+(o/150-.5)/Math.pow(2,i),t+(l/150-.5)/Math.pow(2,i),i+1)}},baselineHeightOf:function(h){return h=k(h),this.cache[h]&&!isNaN(this.cache[h].baseline)?this.cache[h].baseline:(this.context.textAlign="center",this.cache[h]=this.cache[h]||{},this.cache[h].baseline=1.5*(p.call(this,.5,.5,0)-d.call(this,.5,.5,0)));function d(e,t,i){if(this.context.textBaseline="bottom",7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(100*a,"px ").concat(h),this.context.fillText("A",75+150*a*(.5-e),75+150*a*(1-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=0;o<150;o++){for(var c=0;c<150;c++)n<(s=r[4*o*150+4*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?1:250<s?t+(o/150-.5)/Math.pow(2,i):d.call(this,e+(l/150-.5)/Math.pow(2,i),t+(o/150-.5)/Math.pow(2,i),i+1)}function p(e,t,i){if(this.context.textBaseline="alphabetic",7==i)return t;this.context.clearRect(0,0,150,150);var a=Math.pow(2,i);this.context.font="".concat(100*a,"px ").concat(h),this.context.fillText("A",75+150*a*(.5-e),75+150*a*(1-t));for(var s,r=this.context.getImageData(0,0,150,150).data,n=!1,l=0,o=0;o<150;o++){for(var c=0;c<150;c++)n<(s=r[4*o*150+4*c+3])&&(n=s,l=c);if(n)break}return!1===n&&0==i?1:250<s?t+(o/150-.5)/Math.pow(2,i):p.call(this,e+(l/150-.5)/Math.pow(2,i),t+(o/150-.5)/Math.pow(2,i),i+1)}},cache:{}},r=new Promise(function(t,e){!function e(){requestAnimationFrame(function(){document.body?t(document.body):e()})}()});r.then(function(e){var t=document.createElement("canvas");t.style.position="fixed",t.style.top="100vh",t.style.left="100vw",t.style.pointerEvents="none",t.style.opacity=0,t.width=150,t.height=150,$e.canvas=t,$e.context=t.getContext("2d"),e.appendChild(t)});var O,I,L=[];var D=new Promise(function(i,e){r.then(function(e){var t=document.createElement("div");t.style.visibility="hidden",t.style.fontSize="300px",t.style.position="fixed",t.style.top="100vh",t.style.left="100vw",t.textContent="This is a string that changes font.",e.appendChild(t),t.style.fontFamily="serif",O=t.offsetWidth,t.style.fontFamily="sans-serif",I=t.offsetWidth,i(t)})});function R(e,t){if((e=e&&k(e))&&!t)delete $e.cache[e];else if(t&&!e){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length)for(var i in $e.cache)for(var a=t.length-1;0<=a;a--)delete $e.cache[i][a]}else if(e&&t){if((t=t.split(",").filter(function(e){return/^\\?(?:normalfont|nm|rm|it|sl|bf)$/.test(e.trim())}).map(function(e){return"\\normalfont"==e.trim()||"normalfont"==e.trim()?"nm":"\\"==e.trim()[0]?e.trim().substring(1):e.trim()})).length&&$e.cache[e])for(var s=t.length-1;0<=s;s--)delete $e.cache[e][s]}else $e.cache={}}return S._debug={data:Ce,fontCache:$e.cache,clearFontCache:R,reset:function(){Ce.defs.macros={},Ce.defs.active={},Ce.registers.count={},Ce.registers.dimen={},Ce.registers.skip={},Ce.registers.muskip={},Ce.registers.named={}}},S}();